(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{Chfi:function(t,e,i){"use strict";i.r(e),i.d(e,"MyStacksModule",(function(){return lt}));var n=i("ofXK"),c=i("tyNb"),s=i("mrSG"),o=i("HdQx"),r=i("quSY"),a=i("cp0P"),b=i("b5vT"),l=i("vkgz"),d=i("IzEk"),u=i("40nA"),v=i("Mzu6"),p=i("EVKI"),m=i("5Trv"),f=i("fXoL"),h=i("3sFK"),g=i("0IaG"),k=i("biaL"),S=i("oCqB"),I=i("nZ6g"),R=i("a8/g"),E=i("xm+p"),Q=i("k1Ex"),x=i("bTqV"),w=i("aSHc"),C=i("bv9b");function A(t,e){if(1&t){const t=f.Sb();f.Pb(0),f.Rb(1,"button",1),f.Zb("click",(function(){return f.rc(t),f.dc().downloadRemoteStack()})),f.Mb(2,"i",2),f.Ec(3," Download Remote Stack"),f.Qb(),f.Ob()}}function y(t,e){1&t&&(f.Pb(0),f.Rb(1,"div",3),f.Mb(2,"mat-progress-bar",4),f.Rb(3,"div",5),f.Ec(4,"downloading stack"),f.Qb(),f.Qb(),f.Ob())}function j(t,e){if(1&t&&(f.Pb(0),f.Rb(1,"div",6),f.Mb(2,"i",7),f.Ec(3),f.Qb(),f.Ob()),2&t){const t=f.dc();f.Ab(3),f.Gc(" Error Downloading Stack ",t.stack.name,"")}}let L=(()=>{class t{constructor(t){this.stackService=t,this.onFinished=new f.o,this.actionState=w.a,this.currentState=w.a.IDLE,this.subs=new r.a}ngOnInit(){}ngOnDestroy(){this.subs.unsubscribe()}downloadRemoteStack(){this.currentState=this.actionState.ACQUIRING,this.subs.add(this.stackService.downloadStack(this.stack.remote.id,this.stack.name,this.stack.remote.version,o.a.Environment.Type.Stack).subscribe(t=>{this.currentState=this.actionState.SUCCESS,this.onFinished.emit(!0)}))}}return t.\u0275fac=function(e){return new(e||t)(f.Lb(S.a))},t.\u0275cmp=f.Fb({type:t,selectors:[["download-remote-stack"]],inputs:{stack:"stack"},outputs:{onFinished:"onFinished"},decls:3,vars:3,consts:[[4,"ngIf"],["mat-button","",3,"click"],[1,"fa","fa-download","text-muted"],[1,"text-center"],["mode","buffer"],[1,"text-small"],[1,"text-warning"],[1,"fa","fa-exclamation-triangle"]],template:function(t,e){1&t&&(f.Cc(0,A,4,0,"ng-container",0),f.Cc(1,y,5,0,"ng-container",0),f.Cc(2,j,4,1,"ng-container",0)),2&t&&(f.jc("ngIf",e.currentState===e.actionState.IDLE),f.Ab(1),f.jc("ngIf",e.currentState===e.actionState.ACQUIRING),f.Ab(1),f.jc("ngIf",e.currentState===e.actionState.FAILED))},directives:[n.t,x.b,C.a],styles:[""]}),t})();var O=i("Qu3c");function $(t,e){if(1&t){const t=f.Sb();f.Rb(0,"div",11),f.Rb(1,"div",12),f.Rb(2,"div",13),f.Rb(3,"div",14),f.Rb(4,"div"),f.Ec(5),f.ec(6,"titlecase"),f.Qb(),f.Rb(7,"div",15),f.Ec(8),f.ec(9,"titlecase"),f.Qb(),f.Qb(),f.Rb(10,"div"),f.Rb(11,"button",16),f.Zb("click",(function(){f.rc(t);const i=e.$implicit;return f.dc(3).acceptInvite(i.eid)})),f.Ec(12,"Accept"),f.Qb(),f.Rb(13,"button",16),f.Zb("click",(function(){f.rc(t);const i=e.$implicit;return f.dc(3).declineInvite(i.eid)})),f.Ec(14,"Decline"),f.Qb(),f.Qb(),f.Qb(),f.Qb(),f.Qb()}if(2&t){const t=e.$implicit;f.Ab(5),f.Fc(f.fc(6,2,t.name)),f.Ab(3),f.Gc("Owner: ",f.fc(9,4,t.owner.displayName)||t.owner.email,"")}}function F(t,e){if(1&t&&(f.Pb(0),f.Rb(1,"div",9),f.Ec(2,"Stack Invites"),f.Qb(),f.Cc(3,$,15,6,"div",10),f.Ob()),2&t){const t=f.dc(2);f.Ab(3),f.jc("ngForOf",t.invites)}}function M(t,e){if(1&t){const t=f.Sb();f.Pb(0),f.Rb(1,"div",17),f.Rb(2,"div",18),f.Zb("click",(function(){return f.rc(t),f.dc(2).gotoLogin()})),f.Mb(3,"i",19),f.Ec(4," Please Log In to use this section. "),f.Mb(5,"i",20),f.Qb(),f.Rb(6,"div",21),f.Zb("click",(function(){return f.rc(t),f.dc(2).goToCreateAccount()})),f.Ec(7," You can also create an account and receive an additional workspace. "),f.Qb(),f.Qb(),f.Ob()}}function P(t,e){1&t&&(f.Rb(0,"div",23),f.Ec(1,"No stacks present"),f.Qb())}function D(t,e){1&t&&(f.Rb(0,"div",34),f.Rb(1,"button",35),f.Mb(2,"i",36),f.Qb(),f.Qb())}function T(t,e){if(1&t){const t=f.Sb();f.Rb(0,"div",3),f.Rb(1,"button",37),f.Zb("click",(function(){f.rc(t);const e=f.dc().$implicit;return f.dc(3).switchEnvironment(e)})),f.Mb(2,"i",38),f.Qb(),f.Qb()}if(2&t){const t=f.dc().$implicit,e=f.dc(3);f.Ab(1),f.jc("disabled",e.isCurrentEnv(t))}}function Z(t,e){if(1&t){const t=f.Sb();f.Rb(0,"div",3),f.Rb(1,"button",40),f.Zb("click",(function(){f.rc(t);const e=f.dc(4).$implicit;return f.dc(3).pushStack(e)})),f.Mb(2,"i",41),f.Ec(3," Push your changes"),f.Qb(),f.Qb()}2&t&&(f.Ab(1),f.jc("title","Push Your Changes"))}function N(t,e){if(1&t){const t=f.Sb();f.Rb(0,"div",3),f.Rb(1,"button",40),f.Zb("click",(function(){f.rc(t);const e=f.dc(4).$implicit;return f.dc(3).pullStack(e)})),f.Mb(2,"i",36),f.Ec(3," Pull new updates"),f.Qb(),f.Qb()}2&t&&(f.Ab(1),f.jc("title","Pull New Updates"))}function G(t,e){1&t&&(f.Rb(0,"div",42),f.Ec(1,"Requires merge!"),f.Qb())}function U(t,e){if(1&t&&(f.Rb(0,"div",3),f.Cc(1,Z,4,1,"div",27),f.Cc(2,N,4,1,"div",27),f.Cc(3,G,2,0,"div",39),f.Qb()),2&t){const t=f.dc(3).$implicit;f.Ab(1),f.jc("ngIf",!t.remote.isClean),f.Ab(1),f.jc("ngIf",t.localVersion!=(null==t.remote?null:t.remote.version)),f.Ab(1),f.jc("ngIf",null==t.remote?null:t.remote.requiresMerge)}}function W(t,e){if(1&t&&(f.Pb(0),f.Cc(1,U,4,3,"div",27),f.Ob()),2&t){const t=f.dc(2).$implicit;f.Ab(1),f.jc("ngIf",t.remote)}}function q(t,e){if(1&t){const t=f.Sb();f.Pb(0),f.Rb(1,"download-remote-stack",43),f.Zb("onFinished",(function(){return f.rc(t),f.dc(5).stackService.refresh()})),f.Qb(),f.Ob()}if(2&t){const t=f.dc(2).$implicit;f.Ab(1),f.jc("stack",t)}}function z(t,e){if(1&t&&(f.Pb(0),f.Cc(1,W,2,1,"ng-container",0),f.Cc(2,q,2,1,"ng-container",0),f.Ob()),2&t){const t=f.dc().$implicit;f.Ab(1),f.jc("ngIf",!t.remoteOnly),f.Ab(1),f.jc("ngIf",t.remoteOnly)}}function J(t,e){1&t&&(f.Rb(0,"div",57),f.Mb(1,"i",58),f.Ec(2," Shared"),f.Qb())}function K(t,e){1&t&&(f.Rb(0,"div",59),f.Mb(1,"i",60),f.Ec(2," Local"),f.Qb())}function Y(t,e){if(1&t){const t=f.Sb();f.Rb(0,"button",53),f.Zb("click",(function(){f.rc(t);const e=f.dc(2).$implicit;return f.dc(3).switchEnvironment(e)})),f.Ec(1,"Switch To This Stack"),f.Qb()}if(2&t){const t=f.dc(2).$implicit,e=f.dc(3);f.jc("disabled",e.isCurrentEnv(t))}}function H(t,e){if(1&t){const t=f.Sb();f.Rb(0,"button",55),f.Zb("click",(function(){f.rc(t);const e=f.dc(2).$implicit;return f.dc(3).revokeStack(e)})),f.Ec(1,"Purge Stack"),f.Qb()}}function V(t,e){if(1&t){const t=f.Sb();f.Rb(0,"div",44),f.Rb(1,"div",11),f.Rb(2,"p",45),f.Ec(3),f.Qb(),f.Cc(4,J,3,0,"div",46),f.Cc(5,K,3,0,"div",47),f.Rb(6,"div",48),f.Mb(7,"i",49),f.Ec(8),f.Qb(),f.Rb(9,"div",48),f.Mb(10,"i",50),f.Ec(11),f.Qb(),f.Qb(),f.Rb(12,"div",51),f.Cc(13,Y,2,1,"button",52),f.Rb(14,"button",53),f.Zb("click",(function(){f.rc(t);const e=f.dc().$implicit;return f.dc(3).installIntoCurrentEnvironment(e)})),f.Ec(15,"Install Into Current "),f.Rb(16,"span",54),f.Ec(17),f.Qb(),f.Qb(),f.Rb(18,"button",55),f.Zb("click",(function(){f.rc(t);const e=f.dc().$implicit;return f.dc(3).installIntoNewWorkspace(e)})),f.Ec(19,"Install Into New Workspace"),f.Qb(),f.Rb(20,"button",55),f.Zb("click",(function(){f.rc(t);const e=f.dc().$implicit;return f.dc(3).shareStack(e)})),f.Ec(21,"Share Stack"),f.Qb(),f.Rb(22,"button",55),f.Zb("click",(function(){f.rc(t);const e=f.dc().$implicit;return f.dc(3).renameStack(e)})),f.Ec(23,"Rename Stack"),f.Qb(),f.Rb(24,"button",55),f.Zb("click",(function(){f.rc(t);const e=f.dc().$implicit;return f.dc(3).deleteStack(e)})),f.Rb(25,"span"),f.Ec(26,"Delete Stack"),f.Qb(),f.Qb(),f.Cc(27,H,2,0,"button",56),f.Qb(),f.Qb()}if(2&t){const t=f.dc().$implicit,e=f.dc(3);f.Ab(3),f.Fc(t.description||"No description"),f.Ab(1),f.jc("ngIf",t.remote),f.Ab(1),f.jc("ngIf",!t.remote&&t.isLocal),f.Ab(3),f.Gc(" ",t.codebasePath,""),f.Ab(3),f.Gc(" ",t.seed,""),f.Ab(2),f.jc("ngIf",!t.remoteOnly),f.Ab(1),f.jc("disabled",e.isCurrentEnv(t)),f.Ab(3),f.Fc(e.currentEnvironment.type),f.Ab(10),f.jc("ngIf",(null==t.remote?null:t.remote.owner)===(null==e.user?null:e.user.uid))}}function B(t,e){if(1&t){const t=f.Sb();f.Rb(0,"div",11),f.Rb(1,"div",12),f.Rb(2,"div",24),f.Rb(3,"div",25),f.Cc(4,D,3,0,"div",26),f.Cc(5,T,3,1,"div",27),f.Qb(),f.Rb(6,"div",3),f.Mb(7,"i",28),f.Qb(),f.Rb(8,"div",29),f.Zb("click",(function(){f.rc(t);const i=e.$implicit;return f.dc(3).toggleItemList(i.id)})),f.Ec(9),f.Qb(),f.Rb(10,"div",6),f.Cc(11,z,3,2,"ng-container",0),f.Qb(),f.Rb(12,"div",30),f.Rb(13,"button",31),f.Zb("click",(function(){f.rc(t);const i=e.$implicit;return f.dc(3).toggleItemList(i.id)})),f.Mb(14,"i",32),f.Qb(),f.Qb(),f.Qb(),f.Cc(15,V,28,9,"div",33),f.Qb(),f.Qb()}if(2&t){const t=e.$implicit,i=f.dc(3);f.Ab(4),f.jc("ngIf",t.remoteOnly),f.Ab(1),f.jc("ngIf",!t.remoteOnly),f.Ab(2),f.Db("text-primary",i.isCurrentEnv(t))("text-muted",!i.isCurrentEnv(t)),f.Ab(1),f.Db("text-primary",i.isCurrentEnv(t)),f.Ab(1),f.Fc(t.name),f.Ab(2),f.jc("ngIf",i.isLoggedIn),f.Ab(3),f.Db("fa-chevron-up",i.itemList[t.id])("fa-chevron-down",!i.itemList[t.id]),f.Ab(1),f.jc("ngIf",i.itemList[t.id])}}function X(t,e){if(1&t&&(f.Pb(0),f.Cc(1,P,2,0,"div",22),f.Cc(2,B,16,15,"div",10),f.Ob()),2&t){const t=f.dc(2);f.Ab(1),f.jc("ngIf",0===t.stacks.length),f.Ab(1),f.jc("ngForOf",t.stacks)}}function _(t,e){if(1&t){const t=f.Sb();f.Pb(0),f.Rb(1,"div",1),f.Rb(2,"div",2),f.Rb(3,"div",3),f.Cc(4,F,4,1,"ng-container",0),f.Rb(5,"div",4),f.Rb(6,"div",5),f.Ec(7,"My Stacks"),f.Qb(),f.Rb(8,"div",6),f.Rb(9,"button",7),f.Zb("click",(function(){return f.rc(t),f.dc().createNewStack()})),f.Mb(10,"i",8),f.Ec(11," New Stack"),f.Qb(),f.Qb(),f.Qb(),f.Cc(12,M,8,0,"ng-container",0),f.Cc(13,X,3,2,"ng-container",0),f.Qb(),f.Qb(),f.Qb(),f.Ob()}if(2&t){const t=f.dc();f.Ab(4),f.jc("ngIf",t.invites.length>0),f.Ab(8),f.jc("ngIf",!t.isLoggedIn),f.Ab(1),f.jc("ngIf",t.isLoggedIn)}}const tt=c.f.forChild([{path:"",component:(()=>{class t{constructor(t,e,i,n,c,s,o,a){this.appEnvironmentService=t,this.dialog=e,this.userService=i,this.stackService=n,this.dialogService=c,this.appConsoleService=s,this.navigationService=o,this.myItemsService=a,this.invites=[],this.isLoggedIn=!1,this.itemList={},this.subs=new r.a}ngOnInit(){this.getEnvironments(),this.getPendingInvites(),this.subs.add(this.userService.user$.subscribe(t=>{this.user=t,this.isLoggedIn=t.isLoggedIn})),this.subs.add(this.appEnvironmentService.currentEnvironment$.subscribe(t=>this.currentEnvironment=t))}toggleItemList(t){this.itemList[t]=!this.itemList[t]}getEnvironments(){this.subs.add(this.stackService.userStacks().subscribe(t=>{this.stacks=t}))}createNewStack(){this.isLoggedIn?this.dialog.open(b.a,{data:{type:o.a.Environment.Type.Stack},minWidth:"600px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(()=>this.stackService.refresh()):this.dialogService.openMustLoginDialog()}ngOnDestroy(){}isCurrentEnv(t){var e;return(null===(e=this.currentEnvironment)||void 0===e?void 0:e.id)===t.id}switchEnvironment(t){this.appEnvironmentService.switchToEnvironment(t.id).pipe(Object(l.a)(()=>this.navigationService.navigateToEnvironmentHome())).subscribe(()=>null)}pushStack(t){this.stackService.publishStack(t.id).subscribe(e=>{var i;this.dialogService.openAlertDialog({title:"Push Successful",text:`${t.name} v${null===(i=e.remote)||void 0===i?void 0:i.version} has been published`})})}pullStack(t){this.stackService.syncStack(t.id,t.remote.version).subscribe(()=>{this.stackService.refresh(),this.dialogService.openAlertDialog({title:"Sync Stack",text:"Stack has been synced"})},t=>{var e;this.dialogService.openAlertDialog({title:"Sync Stack",text:(null===(e=t.error)||void 0===e?void 0:e.message)||"Server error!"})})}deleteStack(t){const e=this.dialogService.openConfirmationDialog({title:`Delete stack ${t.name}?`,text:"Deleting this stack is a permanent action and cannot be undone.",button:{yes:"Delete",no:"Cancel"}});Object(a.a)([e.afterClosed(),this.appEnvironmentService.currentEnvironment$.pipe(Object(d.a)(1))]).subscribe(([e,i])=>{!0===e&&this.stackService.deleteStack(t.id).subscribe(()=>{t.id===i.id&&this.dialog.open(u.a,{data:{},disableClose:!0,position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(t=>console.log("dialog result: ",t)),this.stackService.refresh()})})}revokeStack(t){const e=this.dialog.open(v.a,{data:{title:`Revoke stack ${t.name}?`,text:"Revoking this stack will remove it from the stackjoy community. It will no longer be public and other users will no longer be able to install it. This is a permanent action and cannot be undone.",button:{yes:"Revoke",no:"Cancel"}},position:{top:"100px"},autoFocus:!0});Object(a.a)([e.afterClosed(),this.appEnvironmentService.currentEnvironment$.pipe(Object(d.a)(1))]).subscribe(([e,i])=>{!1!==e&&this.stackService.purge(t.remote.id).subscribe(()=>{this.dialogService.openAlertDialog({title:"Revoke Stack",text:`Stack ${t.name} revoked successfully. `}),this.stackService.refresh()},t=>{this.dialogService.openAlertDialog({title:"Revoke Stack",text:"Something went wrong: "+(t.message||"Unknown error occurred...")})})})}test(){this.stackService.installIntoCurrentEnvironment("UIkhUmgApyOKEKtEridz").subscribe(()=>{this.stackService.refresh()},()=>{})}installIntoCurrentEnvironment(t){this.appConsoleService.openBluConsole({command:"install "+t.name,extraInfo:{stack:t,source:"local"}})}renameStack(t){this.dialog.open(p.a,{data:{environment:t},width:"500px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(t=>{t.success&&this.stackService.refresh()})}shareStack(t){this.user?this.dialog.open(m.a,{data:{environment:t,type:"stack"},width:"50vw",maxWidth:"800px",minWidth:"500px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(()=>{this.stackService.refresh()}):this.dialogService.openMustLoginDialog()}getPendingInvites(){this.subs.add(this.stackService.pendingInvites$.subscribe(t=>{this.invites=t}))}installIntoNewWorkspace(t){this.myItemsService.createNewWorkspace(t)}gotoLogin(){this.navigationService.navigateToLogin()}goToCreateAccount(){this.navigationService.navigateToCreateAccount()}acceptInvite(t){return Object(s.a)(this,void 0,void 0,(function*(){this.stackService.acceptInvite(t).pipe(Object(d.a)(1)).subscribe(()=>{this.stackService.fetchPendingInvites()})}))}declineInvite(t){return Object(s.a)(this,void 0,void 0,(function*(){this.stackService.declineInvite(t).pipe(Object(d.a)(1)).subscribe(()=>{this.stackService.fetchPendingInvites()})}))}}return t.\u0275fac=function(e){return new(e||t)(f.Lb(h.a),f.Lb(g.b),f.Lb(k.a),f.Lb(S.a),f.Lb(I.a),f.Lb(R.a),f.Lb(E.a),f.Lb(Q.a))},t.\u0275cmp=f.Fb({type:t,selectors:[["my-stacks"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"pt-3",2,"max-width","800px"],[1,"pl-3"],[1,""],[1,"pl-2","d-flex","align-items-start"],[1,"text-bold","py-2"],[1,"ml-auto"],["mat-button","",3,"click"],[1,"fa","fa-plus"],[1,"text-bold","p-2"],["class","p-2",4,"ngFor","ngForOf"],[1,"p-2"],[1,"shadow","p-2","border","rounded"],[1,"d-flex","align-items-center","justify-content-between"],[1,"pl-3","cursor-pointer"],[1,"subheader"],["mat-raised-button","",3,"click"],[1,"p-2","text-center","cursor-pointer"],[1,"",3,"click"],[1,"fa","fa-exclamation-circle"],[1,"fa","fa-arrow-alt-circle-right"],[1,"text-small","text-muted","hover-as-link","pt-2",3,"click"],["class","text-center p-2",4,"ngIf"],[1,"text-center","p-2"],[1,"d-flex","align-items-center"],[1,"pr-3"],["class","","style","width:40px; height:40px;",4,"ngIf"],["class","",4,"ngIf"],[1,"fa","fa-layer-group"],[1,"pl-2","cursor-pointer",3,"click"],[1,"ml-1"],["mat-button","","mat-icon-button","",3,"click"],[1,"fa"],["class","border-top p-2 d-flex align-items-start",4,"ngIf"],[1,"",2,"width","40px","height","40px"],["mat-button","","mat-icon-button",""],[1,"fa","fa-download","text-muted"],["mat-button","","mat-icon-button","",3,"disabled","click"],[1,"fa","fa-exchange-alt"],["style","color: red",4,"ngIf"],["mat-button","",3,"title","click"],[1,"fa","fa-upload","text-muted"],[2,"color","red"],[3,"stack","onFinished"],[1,"border-top","p-2","d-flex","align-items-start"],[1,"my-2"],["class","text-muted text-small","matTooltip","This stack is shared with other users",4,"ngIf"],["class","text-muted text-small","matTooltip","This stack is present only on this machine",4,"ngIf"],[1,"text-small"],[1,"fa","fa-folder-open","mr-1"],[1,"fa","fa-seedling","mr-1"],[1,"ml-auto","p-2","border-left"],["mat-button","","class","d-block",3,"disabled","click",4,"ngIf"],["mat-button","",1,"d-block",3,"disabled","click"],[1,"text-capitalize"],["mat-button","",1,"d-block",3,"click"],["mat-button","","class","d-block",3,"click",4,"ngIf"],["matTooltip","This stack is shared with other users",1,"text-muted","text-small"],[1,"fa","fa-users","mr-1"],["matTooltip","This stack is present only on this machine",1,"text-muted","text-small"],[1,"fa","fa-desktop","mr-1"]],template:function(t,e){1&t&&f.Cc(0,_,14,3,"ng-container",0),2&t&&f.jc("ngIf",e.stacks)},directives:[n.t,x.b,n.s,L,O.a],pipes:[n.F],styles:[".codebase-path[_ngcontent-%COMP%]{font-size:9px;line-height:9px}"]}),t})(),children:[]}]);var et=i("STbY"),it=i("NFeN");let nt=(()=>{class t{}return t.\u0275mod=f.Jb({type:t}),t.\u0275inj=f.Ib({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,x.c,C.b]]}),t})();var ct=i("7n/8"),st=i("qFsG"),ot=i("QibW"),rt=i("d3UM"),at=i("3Pt+");let bt=(()=>{class t{}return t.\u0275mod=f.Jb({type:t}),t.\u0275inj=f.Ib({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,g.g,st.b,at.l,x.c,ot.c,at.A,rt.b,C.b]]}),t})(),lt=(()=>{class t{}return t.\u0275mod=f.Jb({type:t}),t.\u0275inj=f.Ib({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,tt,x.c,et.c,it.b,nt,ct.a,O.b,bt]]}),t})()}}]);