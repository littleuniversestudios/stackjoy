(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"8S3I":function(e,t,a){"use strict";a.r(t),a.d(t,"GenerateModule",(function(){return te}));var c=a("ofXK"),i=a("tyNb"),s=a("fXoL"),r=a("3Pt+");let n=(()=>{class e{constructor(){}loadTemplate(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Yb({token:e,factory:e.\u0275fac}),e})();var o=a("ZJV+"),l=a("/hV/"),p=a("Or6o"),m=a("hshW"),h=a("xHqg"),u=a("HopJ"),d=a("bTqV"),f=a("kmnG"),b=a("qFsG"),g=a("NFeN"),v=a("0FS3");let y=(()=>{class e{constructor(){this.values=new s.r,this.model={},this.fields=[]}ngOnInit(){this.templateArgs=this.template.args,this.makeForm()}makeForm(){this.templateArgs.forEach(e=>this.model[e.name]=e.value),this.fields=this.templateArgs.map(e=>this.createFormField(e)),this.form=new r.j({}),this.form.valueChanges.subscribe(e=>this.sendFormData())}createFormField(e){return{key:e.name,type:e.choices?"select":"input",templateOptions:{options:e.choices?e.choices.map(e=>({label:e,value:e})):null,label:e.name,description:e.description,required:!0,appearance:"standard"}}}ngOnDestroy(){}sendFormData(){const e=this.templateArgs.map(e=>({name:e.name,description:e.description,value:this.model[e.name],choices:e.choices}));this.values.emit({valid:this.form.valid,args:e})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Wb({type:e,selectors:[["template-args"]],inputs:{template:"template"},outputs:{values:"values"},decls:2,vars:4,consts:[[3,"formGroup"],[3,"form","fields","model"]],template:function(e,t){1&e&&(s.ic(0,"form",0),s.dc(1,"formly-form",1),s.hc()),2&e&&(s.Ec("formGroup",t.form),s.Ob(1),s.Ec("form",t.form)("fields",t.fields)("model",t.model))},directives:[r.z,r.q,r.k,v.f],styles:[""]}),e})(),O=(()=>{class e{constructor(){this.values=new s.r,this.model={args:[{}]},this.fields=[]}ngOnInit(){this.makeForm()}makeForm(){this.fields=[{key:"args",type:"repeat",templateOptions:{addText:"Add another entry"},fieldArray:{fieldGroupClassName:"row",fieldGroup:this.repeater.args.map(e=>this.createFormField(e))}}],this.form=new r.j({}),this.form.valueChanges.subscribe(e=>this.sendFormData())}createFormField(e){return{key:e.name,type:e.choices?"select":"input",className:"col-6",templateOptions:{options:e.choices?this.formatChoices(e.choices).map(e=>({label:e.description,value:e.value})):null,label:e.name,description:e.description,required:!0,appearance:"standard"}}}formatChoices(e){return e.map(e=>"value"in e&&"description"in e?e:{value:e,description:e})}ngOnDestroy(){}sendFormData(){const e=[];this.form.value.args.forEach(t=>{e.push(this.repeater.args.map(e=>({name:e.name,description:e.description,value:t[e.name],choices:e.choices})))}),this.values.emit({valid:this.form.valid,values:e})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Wb({type:e,selectors:[["template-repeater"]],inputs:{repeater:"repeater"},outputs:{values:"values"},decls:2,vars:4,consts:[[3,"formGroup"],[3,"form","fields","model"]],template:function(e,t){1&e&&(s.ic(0,"form",0),s.dc(1,"formly-form",1),s.hc()),2&e&&(s.Ec("formGroup",t.form),s.Ob(1),s.Ec("form",t.form)("fields",t.fields)("model",t.model))},directives:[r.z,r.q,r.k,v.f],styles:[""]}),e})();function N(e,t){if(1&e){const e=s.jc();s.ic(0,"div",1),s.ic(1,"div",2),s.ic(2,"h6"),s.bd(3),s.hc(),s.ic(4,"div",3),s.bd(5),s.hc(),s.ic(6,"div",4),s.ic(7,"template-repeater",5),s.uc("values",(function(a){s.Rc(e);const c=t.$implicit;return s.yc().setRepeaterValues(c,a)})),s.hc(),s.hc(),s.hc(),s.hc()}if(2&e){const e=t.$implicit;s.Ob(3),s.cd(e.name),s.Ob(2),s.cd(e.description),s.Ob(2),s.Ec("repeater",e)}}let w=(()=>{class e{constructor(){this.repeaters=new s.r,this.validRepeater={}}ngOnInit(){this.templateRepeaters=this.template.allRepeaters,console.log("WHAAAA?",this.templateRepeaters),this.templateRepeaters.forEach(e=>this.validRepeater[e.name]=!1)}areAllRepeatersValid(){let e=!0;return this.templateRepeaters.forEach(t=>e=e&&this.validRepeater[t.name]),e}ngOnDestroy(){}setRepeaterValues(e,t){e.values=t.values,this.validRepeater[e.name]=t.valid,this.repeaters.emit({valid:this.areAllRepeatersValid(),repeaters:this.templateRepeaters})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Wb({type:e,selectors:[["template-repeaters"]],inputs:{template:"template"},outputs:{repeaters:"repeaters"},decls:1,vars:1,consts:[["class","row",4,"ngFor","ngForOf"],[1,"row"],[1,"col"],[1,"text-muted"],[1,"pt-1"],[3,"repeater","values"]],template:function(e,t){1&e&&s.Zc(0,N,8,3,"div",0),2&e&&s.Ec("ngForOf",t.templateRepeaters)},directives:[c.t,O],styles:[""]}),e})();const A=["stepper"],R=["templateNameInput"];function F(e,t){1&e&&(s.ic(0,"mat-icon"),s.bd(1,"check"),s.hc())}function I(e,t){if(1&e&&(s.ic(0,"div"),s.bd(1),s.hc()),2&e){const e=s.yc(3);s.Ob(1),s.cd(e.destination)}}function S(e,t){if(1&e&&(s.ic(0,"div"),s.bd(1,"Select the destination folder"),s.hc(),s.Zc(2,I,2,1,"div",26)),2&e){const e=s.yc(2);s.Ob(2),s.Ec("ngIf",e.destination)}}function E(e,t){if(1&e&&(s.ic(0,"div",1),s.bd(1),s.hc()),2&e){const e=s.yc(3);s.Ob(1),s.cd(e.getNewTemplateName())}}function k(e,t){if(1&e&&(s.ic(0,"div"),s.bd(1,"Name for the generated template"),s.hc(),s.Zc(2,E,2,1,"div",0)),2&e){s.yc();const e=s.Nc(14);s.Ob(2),s.Ec("ngIf",e.completed)}}function T(e,t){1&e&&s.bd(0,"Fill in template arguments")}function x(e,t){if(1&e){const e=s.jc();s.ic(0,"mat-step",8),s.Zc(1,T,1,0,"ng-template",9),s.ic(2,"div",27),s.ic(3,"template-args",28),s.uc("values",(function(t){return s.Rc(e),s.yc(2).setTemplateArgs(t)})),s.hc(),s.hc(),s.ic(4,"div",22),s.ic(5,"button",18),s.bd(6,"Back"),s.hc(),s.ic(7,"button",19),s.bd(8,"Next"),s.hc(),s.hc(),s.hc()}if(2&e){const e=s.yc(2);s.Ec("completed",e.templateArgsValid),s.Ob(3),s.Ec("template",e.template)}}function C(e,t){1&e&&s.bd(0,"Fill in the repeater values")}function V(e,t){if(1&e){const e=s.jc();s.ic(0,"mat-step",8),s.Zc(1,C,1,0,"ng-template",9),s.ic(2,"div",27),s.ic(3,"template-repeaters",29),s.uc("repeaters",(function(t){return s.Rc(e),s.yc(2).setTemplateRepeaters(t)})),s.hc(),s.hc(),s.ic(4,"div",22),s.ic(5,"button",18),s.bd(6,"Back"),s.hc(),s.ic(7,"button",19),s.bd(8,"Next"),s.hc(),s.hc(),s.hc()}if(2&e){const e=s.yc(2);s.Ec("completed",e.templateRepeatersValid),s.Ob(3),s.Ec("template",e.template)}}function Z(e,t){1&e&&s.bd(0,"Generate Template")}const $=function(){return{showGenerate:!1}};function D(e,t){if(1&e){const e=s.jc();s.ic(0,"div",1),s.ic(1,"div",2),s.ic(2,"div",3),s.dc(3,"blu-template",4),s.hc(),s.ic(4,"mat-vertical-stepper",5,6),s.uc("selectionChange",(function(t){return s.Rc(e),s.yc().stepChanged(t)})),s.Zc(6,F,2,0,"ng-template",7),s.ic(7,"mat-step",8),s.Zc(8,S,3,1,"ng-template",9),s.ic(9,"directory-tree",10),s.uc("onFocus",(function(t){return s.Rc(e),s.yc().selectFolder(t)})),s.hc(),s.ic(10,"div",11),s.ic(11,"button",12),s.bd(12,"Next"),s.hc(),s.hc(),s.hc(),s.ic(13,"mat-step",13,14),s.ic(15,"form",15),s.Zc(16,k,3,1,"ng-template",9),s.ic(17,"div",16),s.ic(18,"mat-form-field"),s.dc(19,"input",17),s.hc(),s.hc(),s.ic(20,"div"),s.ic(21,"button",18),s.bd(22,"Back"),s.hc(),s.ic(23,"button",19),s.bd(24,"Next"),s.hc(),s.hc(),s.hc(),s.hc(),s.Zc(25,x,9,2,"mat-step",20),s.Zc(26,V,9,2,"mat-step",20),s.ic(27,"mat-step"),s.Zc(28,Z,1,0,"ng-template",9),s.ic(29,"div",21),s.ic(30,"div"),s.bd(31),s.hc(),s.hc(),s.ic(32,"div",22),s.ic(33,"button",23),s.dc(34,"i",24),s.hc(),s.ic(35,"button",18),s.bd(36,"Back"),s.hc(),s.ic(37,"button",25),s.uc("click",(function(){return s.Rc(e),s.yc().generateTemplate()})),s.bd(38,"Generate"),s.hc(),s.hc(),s.hc(),s.hc(),s.hc(),s.hc()}if(2&e){const e=s.yc();s.Ob(3),s.Ec("template",e.template)("options",s.Hc(12,$)),s.Ob(1),s.Ec("linear",!0)("selectedIndex",2),s.Ob(3),s.Ec("completed",!!e.destination),s.Ob(2),s.Ec("foldersOnly",!0),s.Ob(4),s.Ec("stepControl",e.newTemplateName),s.Ob(2),s.Ec("formGroup",e.newTemplateName),s.Ob(4),s.Ec("placeholder","Template Name"),s.Ob(6),s.Ec("ngIf",e.hasInputArgs),s.Ob(1),s.Ec("ngIf",e.hasRepeaters),s.Ob(5),s.cd(e.bluCommand)}}let j=(()=>{class e{constructor(e,t,a,c,i,s){this.httpService=e,this.route=t,this.formBuilder=a,this.bluService=c,this.generateService=i,this.fileSystemService=s,this.templateArgsValid=!1,this.templateRepeatersValid=!1,this.hasInputArgs=!1,this.hasRepeaters=!1,this.totalSteps=3,this.selectedStep=1}set stepper1(e){e&&(this.stepper=e)}set content(e){this.templateNameInput=e}ngOnInit(){const e=this.route.snapshot.paramMap.get("templateId");this.bluService.getTemplate(e).subscribe(e=>{this.init(e),this.makeForm(),this.setDefaultDestination(),this.setDefaultName()}),this.httpService.get("/codebase/tree").subscribe(e=>this.nodes=e)}ngAfterViewInit(){console.log("WHAAAAAAAAAAAAa?",this.stepper)}setDefaultDestination(){const e=this.route.snapshot.queryParamMap.get("destination");e&&(this.destination=e,this.selectedStep=1)}setDefaultName(){const e=this.route.snapshot.queryParamMap.get("name");e&&(this.newTemplateName.controls.templateName.setValue(e),this.selectedStep=2)}init(e){e.templateConfig.args.length>0&&(this.hasInputArgs=!0,this.totalSteps=4),e.allRepeaters.length>0&&(this.hasRepeaters=!0,this.totalSteps=5),this.template=e}makeForm(){this.newTemplateName=this.formBuilder.group({templateName:["",r.x.required]})}selectFolder(e){this.newTemplateName.controls.templateName.setValue(this.fileSystemService.getFolderName(e.node)),this.destination=`./${this.fileSystemService.getPath(e.node)}`}generateCommand(){const e=`'${this.getNewTemplateName()}'`,t=this.hasInputArgs?this.getInputArgVariables():"",a=this.hasRepeaters?this.getRepeaterArgVariables():"";this.bluCommand=`blu generate '${this.template.collectionName}.${this.template.templateName}' ${e} ${t} ${a}`,console.log("",this.bluCommand)}generateTemplate(){this.httpService.post("/blu/generate",{command:this.bluCommand,destinationDir:this.destination}).subscribe(e=>console.log)}getInputArgVariables(){return this.templateArgsForm.args.map(e=>`--${e.name}='${e.value}'`).join(" ")}getRepeaterArgVariables(){return this.templateRepeatersForm.repeaters.map(e=>`--${e.name}=${this.getRepeaterValues(e)}`).join(" ")}getRepeaterValues(e){return e.values.map(e=>e.map(e=>`${e.value}`).join(",")).join("|")}ngOnDestroy(){}getNewTemplateName(){return this.newTemplateName.controls.templateName.value}setTemplateArgs(e){this.templateArgsForm=e,this.templateArgsValid=e.valid}setTemplateRepeaters(e){this.templateRepeatersForm=e,this.templateRepeatersValid=e.valid}stepChanged(e){e.selectedIndex===this.totalSteps-1&&this.generateCommand()}}return e.\u0275fac=function(t){return new(t||e)(s.cc(o.a),s.cc(i.a),s.cc(r.f),s.cc(l.a),s.cc(n),s.cc(p.a))},e.\u0275cmp=s.Wb({type:e,selectors:[["generate"]],viewQuery:function(e,t){var a;1&e&&(s.gd(A,!0,s.Z),s.gd(R,!0,s.Z)),2&e&&(s.Mc(a=s.vc())&&(t.stepper1=a.first),s.Mc(a=s.vc())&&(t.content=a.first))},features:[s.Nb([n])],decls:3,vars:1,consts:[["class","",4,"ngIf"],[1,""],[1,"p-1"],[1,"pb-3"],[3,"template","options"],[3,"linear","selectedIndex","selectionChange"],["stepper",""],["matStepperIcon","edit"],[3,"completed"],["matStepLabel",""],[3,"foldersOnly","onFocus"],[1,"pt-2"],["mat-raised-button","","mat-button","","matStepperNext",""],[3,"stepControl"],["step2",""],[3,"formGroup"],[1,"pt-4"],["matInput","","formControlName","templateName","required","",3,"placeholder"],["mat-button","","matStepperPrevious",""],["mat-button","","matStepperNext","","mat-raised-button",""],[3,"completed",4,"ngIf"],[1,"p-3","pt-5"],[1,"pt-3"],["mat-button",""],[1,"fa","fa-copy"],["mat-button","","mat-raised-button","",1,"ml-2",3,"click"],[4,"ngIf"],[1,"p-2"],[3,"template","values"],[3,"template","repeaters"]],template:function(e,t){1&e&&(s.ic(0,"h4"),s.bd(1,"Generate Template"),s.hc(),s.Zc(2,D,39,13,"div",0)),2&e&&(s.Ob(2),s.Ec("ngIf",t.template))},directives:[c.u,m.a,h.g,h.c,h.a,h.b,u.a,d.a,h.e,r.z,r.q,r.k,f.c,b.b,r.c,r.p,r.i,r.w,h.f,g.a,y,w],styles:[""]}),e})();var q=a("lJxs"),G=a("xm+p"),M=a("1kSV");let W=(()=>{class e{transform(e,[t],a){let c=[];if(t&&""!==t){const i=(t=t.trim()).split(" ").map(e=>e.toLowerCase());e.forEach((t,s)=>{const r=a||Object.keys(t);let n=!1;r.forEach(e=>{n=n||i.every(a=>`${t[e]}`.toLowerCase().includes(a))}),n&&c.push(e[s])})}else c=e;return c}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.bc({name:"search",type:e,pure:!0}),e})();function B(e,t){if(1&e&&(s.ic(0,"div",10),s.bd(1),s.hc()),2&e){const e=s.yc();s.Ob(1),s.dd("Destination: ",e.destination,"")}}function P(e,t){if(1&e){const e=s.jc();s.ic(0,"div",11),s.uc("click",(function(){return s.Rc(e),s.yc().searchTerm=null})),s.ic(1,"span",12),s.dc(2,"span",13),s.hc(),s.hc()}}function H(e,t){if(1&e){const e=s.jc();s.ic(0,"tr"),s.ic(1,"td"),s.ic(2,"div"),s.dc(3,"ngb-highlight",14),s.hc(),s.ic(4,"div",15),s.dc(5,"ngb-highlight",14),s.hc(),s.hc(),s.ic(6,"td"),s.ic(7,"button",16),s.uc("click",(function(){s.Rc(e);const a=t.$implicit;return s.yc().generate(a)})),s.bd(8,"Select"),s.hc(),s.hc(),s.hc()}if(2&e){const e=t.$implicit,a=s.yc();s.Ob(3),s.Ec("result",e.templateName)("term",a.searchTerm),s.Ob(2),s.Ec("result",e.description)("term",a.searchTerm)}}const J=function(e){return[e]},z=i.e.forChild([{path:"",component:(()=>{class e{constructor(e,t,a){this.bluService=e,this.navigationService=t,this.route=a}ngOnInit(){this.destination=this.route.snapshot.queryParams.destination,this.bluService.getTemplates().pipe(Object(q.a)(e=>e.filter(e=>!e.isSeed))).subscribe(e=>this.templates=e)}ngOnDestroy(){}generate(e){this.navigationService.navigateTo(["blu","generate",`${e.collectionName}.${e.templateName}`],{queryParams:{destination:this.destination}})}}return e.\u0275fac=function(t){return new(t||e)(s.cc(l.a),s.cc(G.a),s.cc(i.a))},e.\u0275cmp=s.Wb({type:e,selectors:[["template-search"]],decls:14,vars:9,consts:[[1,"row"],[1,"col"],[1,"p-3"],["class","text-muted text-small",4,"ngIf"],[1,"input-group","pb-3","pt-3"],["type","text","placeholder","Search","autofocus","",1,"form-control","search-input","text-muted",3,"ngModel","ngModelChange"],["searchElement",""],["class","input-group-append cursor-pointer",3,"click",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"text-muted","text-small"],[1,"input-group-append","cursor-pointer",3,"click"],[1,"input-group-text","bg-white"],[1,"fa","fa-times"],[3,"result","term"],[1,"text-small","text-muted"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(s.ic(0,"div",0),s.ic(1,"div",1),s.ic(2,"div",2),s.ic(3,"h5"),s.bd(4,"Select the template you would like to generate"),s.hc(),s.Zc(5,B,2,1,"div",3),s.ic(6,"div",4),s.ic(7,"input",5,6),s.uc("ngModelChange",(function(e){return t.searchTerm=e})),s.hc(),s.Zc(9,P,3,0,"div",7),s.hc(),s.hc(),s.ic(10,"div",2),s.ic(11,"table",8),s.Zc(12,H,9,4,"tr",9),s.zc(13,"search"),s.hc(),s.hc(),s.hc(),s.hc()),2&e&&(s.Ob(5),s.Ec("ngIf",t.destination),s.Ob(2),s.Ec("ngModel",t.searchTerm),s.Ob(2),s.Ec("ngIf",t.searchTerm),s.Ob(3),s.Ec("ngForOf",s.Bc(13,4,t.templates,s.Ic(7,J,t.searchTerm))))},directives:[c.u,r.c,r.p,r.s,c.t,M.a,d.a],pipes:[W],styles:[""]}),e})()},{path:":templateId",component:j}]);var L=a("rDsv"),X=a("d3UM"),Q=a("wZkO"),K=a("VObt"),U=a("x3bS"),Y=a("9Xeq");let _=(()=>{class e{}return e.\u0275mod=s.ac({type:e}),e.\u0275inj=s.Zb({factory:function(t){return new(t||e)},providers:[],imports:[[c.c,Y.a,r.l,M.b,d.b,f.e]]}),e})();var ee=a("InQI");let te=(()=>{class e{}return e.\u0275mod=s.ac({type:e}),e.\u0275inj=s.Zb({factory:function(t){return new(t||e)},providers:[],imports:[[c.c,z,L.b,r.l,Q.d,h.d,r.v,b.c,d.b,X.b,g.b,K.a,U.a,v.g,_,ee.a]]}),e})()}}]);