(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{x3qw:function(e,t,i){"use strict";i.r(t),i.d(t,"CreateAccountModule",(function(){return x}));var r=i("ofXK"),n=i("tyNb"),o=i("quSY"),s=i("aSHc"),c=i("eIep"),a=i("fXoL"),b=i("yUjA"),d=i("biaL"),u=i("xm+p"),l=i("AytR"),p=i("ZJV+");let g=(()=>{class e{constructor(e){this.httpService=e,this.init()}init(){this.httpService.get("/system/info").subscribe(e=>{var t,i;console.log("################################"),console.log(" PRODUCTION:       ",l.a.production),console.log(" AGENT SERVER:     ",this.httpService.apiURL),console.log(" SJ SERVER:        ",e.SJ_SERVER),console.log(" FIREBASE PROJECT: ",null===(t=e.FIREBASE)||void 0===t?void 0:t.projectId,`(${null===(i=e.FIREBASE)||void 0===i?void 0:i.server}):`,e.FIREBASE.databaseURL),console.log(" STACKJOY_DATA_DIR:",e.STACKJOY_DATA_DIR),console.log(" SYSTEM DATA:      ",e.SYSTEM),console.log("################################")})}acceptInvite(e,t,i){return this.httpService.post("/app/auth/activateUser",{inviteId:e,displayName:t,password:i},{needsAuth:!1})}}return e.\u0275fac=function(t){return new(t||e)(a.Vb(p.a))},e.\u0275prov=a.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=i("3sFK"),m=i("Wp6s"),h=i("3Pt+"),f=i("kmnG"),S=i("qFsG"),E=i("bTqV"),R=i("bv9b");function w(e,t){if(1&e&&(a.Rb(0,"div",12),a.Ec(1),a.Qb()),2&e){const e=a.dc();a.Ab(1),a.Fc(e.signupForm.error)}}function C(e,t){1&e&&(a.Rb(0,"div"),a.Rb(1,"div",1),a.Mb(2,"mat-progress-bar",13),a.Qb(),a.Qb())}function A(e,t){1&e&&(a.Rb(0,"div",14),a.Rb(1,"div",15),a.Ec(2," Thanks for signing up!"),a.Qb(),a.Rb(3,"div",1),a.Mb(4,"i",16),a.Ec(5," You received one additional workspace."),a.Qb(),a.Qb())}function I(e,t){1&e&&(a.Rb(0,"div",2),a.Mb(1,"i",20),a.Ec(2,"Password too weak. Please provide a stronger password."),a.Qb())}function F(e,t){if(1&e){const e=a.Sb();a.Rb(0,"div",2),a.Rb(1,"div",2),a.Mb(2,"i",20),a.Ec(3," Email Already in use."),a.Qb(),a.Rb(4,"div",21),a.Zb("click",(function(){return a.rc(e),a.dc(2).forgotPassword()})),a.Ec(5,"(Click here to reset password)"),a.Qb(),a.Qb()}}function Q(e,t){1&e&&(a.Rb(0,"div",2),a.Mb(1,"i",20),a.Ec(2," Error Occurred."),a.Qb())}function y(e,t){if(1&e&&(a.Rb(0,"div",14),a.Pb(1,17),a.Cc(2,I,3,0,"div",18),a.Cc(3,F,6,0,"div",18),a.Cc(4,Q,3,0,"div",19),a.Ob(),a.Qb()),2&e){const e=a.dc();a.Ab(1),a.jc("ngSwitch",e.errorCode),a.Ab(1),a.jc("ngSwitchCase","auth/weak-password"),a.Ab(1),a.jc("ngSwitchCase","auth/email-already-in-use")}}function k(e,t){if(1&e){const e=a.Sb();a.Pb(0),a.Rb(1,"div",22),a.Zb("click",(function(){return a.rc(e),a.dc().forgotPassword()})),a.Ec(2,"Forgot Password"),a.Qb(),a.Rb(3,"div",23),a.Zb("click",(function(){return a.rc(e),a.dc().login()})),a.Ec(4,"Login"),a.Qb(),a.Ob()}}function P(e,t){if(1&e){const e=a.Sb();a.Pb(0),a.Rb(1,"div",24),a.Zb("click",(function(){return a.rc(e),a.dc().continue()})),a.Ec(2,"Continue "),a.Mb(3,"i",25),a.Qb(),a.Ob()}}const M=n.f.forChild([{path:"",component:(()=>{class e{constructor(e,t,i,r,n,c){this.authService=e,this.userService=t,this.route=i,this.navigationService=r,this.systemService=n,this.appEnvironmentService=c,this.signupForm={email:"",password:"",error:"",disabled:!1,inviteCode:"",displayName:""},this.subs=new o.a,this.currentState=s.a.IDLE,this.actionState=s.a}ngOnInit(){var e;this.signupForm.email=null!==(e=this.route.snapshot.queryParams.email)&&void 0!==e?e:"",this.subs.add(this.userService.user$.subscribe(e=>this.user=e)),this.subs.add(this.appEnvironmentService.currentEnvironment$.subscribe(e=>this.currentEnvironment=e))}ngOnDestroy(){this.subs.unsubscribe()}login(){const e={};this.signupForm.email&&(e.email=this.signupForm.email),this.navigationService.navigateTo(["login"],{queryParams:e})}forgotPassword(){const e={};this.signupForm.email&&(e.email=this.signupForm.email),this.navigationService.navigateTo(["forgot-password"],{queryParams:e})}createAccount(){this.currentState=s.a.PENDING,this.authService.createUser(this.signupForm.email,this.signupForm.password,this.signupForm.displayName).subscribe(e=>this.currentState=s.a.SUCCESS,e=>{var t,i,r;this.currentState=s.a.FAILED,this.error=e,this.errorCode=null!==(r=null===(i=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.data)||void 0===i?void 0:i.code)&&void 0!==r?r:"unknown_error",console.log("Login error Code: ",this.errorCode)})}acceptInvite(){this.systemService.acceptInvite(this.signupForm.inviteCode,this.signupForm.displayName,this.signupForm.password).toPromise().then(e=>{this.authService.login(e.data.email,this.signupForm.password)}).catch(e=>{console.error("Failed: ",e)})}logout(){this.authService.logout().pipe(Object(c.a)(e=>this.appEnvironmentService.switchToSystemWorkspace())).subscribe(e=>this.navigationService.navigateTo(["workspace"]))}continue(){this.navigationService.navigateTo([this.currentEnvironment?"workspace":"my-items"])}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(d.a),a.Lb(n.a),a.Lb(u.a),a.Lb(g),a.Lb(v.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["create-account"]],decls:29,vars:11,consts:[[1,"d-flex","justify-content-center","pt-4"],[1,"p-2"],[1,""],[1,"text-bold"],[1,"form",3,"ngSubmit"],["matInput","","placeholder","Email","type","email","name","email","required","",3,"ngModel","disabled","ngModelChange"],["matInput","","placeholder","Password","type","password","name","password","required","",3,"ngModel","disabled","ngModelChange"],["class","error",4,"ngIf"],["mat-raised-button","","type","submit",3,"disabled"],[4,"ngIf"],["class","pt-4 text-break","style","width: 250px;",4,"ngIf"],[1,"d-flex","p-2","pt-4"],[1,"error"],["mode","indeterminate"],[1,"pt-4","text-break",2,"width","250px"],[1,"text-center"],[1,"fa","fa-check-circle","text-success"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],["class","",4,"ngSwitchDefault"],[1,"fa","fa-exclamation-triangle","text-warning"],[1,"text-small","as-link","pt-1","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],[1,"cursor-pointer","ml-auto","pl-4",3,"click"],[1,"cursor-pointer","ml-auto",3,"click"],[1,"fa","fa-arrow-alt-circle-right"]],template:function(e,t){1&e&&(a.Rb(0,"div",0),a.Rb(1,"mat-card"),a.Rb(2,"div",1),a.Rb(3,"div",2),a.Pb(4),a.Rb(5,"div",3),a.Ec(6,"Create Account:"),a.Qb(),a.Rb(7,"div",1),a.Rb(8,"form",4),a.Zb("ngSubmit",(function(){return t.createAccount()})),a.Rb(9,"div",2),a.Rb(10,"mat-form-field"),a.Rb(11,"mat-label"),a.Ec(12,"Email"),a.Qb(),a.Rb(13,"input",5),a.Zb("ngModelChange",(function(e){return t.signupForm.email=e})),a.Qb(),a.Qb(),a.Qb(),a.Rb(14,"div",2),a.Rb(15,"mat-form-field"),a.Rb(16,"mat-label"),a.Ec(17,"Password"),a.Qb(),a.Rb(18,"input",6),a.Zb("ngModelChange",(function(e){return t.signupForm.password=e})),a.Qb(),a.Qb(),a.Qb(),a.Cc(19,w,2,1,"div",7),a.Rb(20,"button",8),a.Ec(21,"Create Account"),a.Qb(),a.Mb(22,"br"),a.Cc(23,C,3,0,"div",9),a.Qb(),a.Cc(24,A,6,0,"div",10),a.Cc(25,y,5,3,"div",10),a.Qb(),a.Ob(),a.Qb(),a.Rb(26,"div",11),a.Cc(27,k,5,0,"ng-container",9),a.Cc(28,P,4,0,"ng-container",9),a.Qb(),a.Qb(),a.Qb(),a.Qb()),2&e&&(a.Ab(13),a.jc("ngModel",t.signupForm.email)("disabled",t.signupForm.disabled),a.Ab(5),a.jc("ngModel",t.signupForm.password)("disabled",t.signupForm.disabled),a.Ab(1),a.jc("ngIf",""!==t.signupForm.error),a.Ab(1),a.jc("disabled",t.currentState===t.actionState.PENDING),a.Ab(3),a.jc("ngIf",t.currentState===t.actionState.PENDING),a.Ab(1),a.jc("ngIf",t.currentState===t.actionState.SUCCESS),a.Ab(1),a.jc("ngIf",t.currentState===t.actionState.FAILED),a.Ab(2),a.jc("ngIf",!t.user.isLoggedIn),a.Ab(1),a.jc("ngIf",t.user.isLoggedIn))},directives:[m.a,h.H,h.s,h.t,f.c,f.g,S.a,h.c,h.C,h.r,h.u,r.t,E.b,R.a,r.x,r.y,r.z],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;flex:1}"]}),e})(),children:[]}]);let x=(()=>{class e{}return e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({factory:function(t){return new(t||e)},providers:[],imports:[[r.c,M,E.c,h.m,S.b,m.d,R.b]]}),e})()}}]);