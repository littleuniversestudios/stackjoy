(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+Ahk":function(t,e,i){"use strict";i.d(e,"a",(function(){return C}));var n=i("fXoL"),r=i("quSY"),o=i("eIep"),s=i("Mzu6"),c=i("0IaG"),a=i("9VQs"),l=i("1JH3"),u=i("ofXK"),d=i("STbY"),b=i("NFeN");function m(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",20),n.ac("click",(function(){n.sc(t);const e=n.ec().$implicit;return n.ec().createNewFunction(e.item)})),n.Fc(1,"No functions present (click to add)"),n.Rb()}}function f(t,e){1&t&&n.Nb(0,"i",28)}const p=function(t,e){return{item:t,func:e}};function h(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",22),n.Sb(1,"div",23),n.Sb(2,"mat-icon",24),n.Fc(3,"more_vert"),n.Rb(),n.Rb(),n.Sb(4,"div",25),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=n.ec(2).$implicit;return n.ec().editFunction(r.item,i)})),n.Fc(5),n.Dc(6,f,1,0,"i",26),n.Rb(),n.Sb(7,"div",27),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=n.ec(2).$implicit;return n.ec().editFunction(r.item,i)})),n.Fc(8),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=n.ec(2).$implicit,r=n.ec(),o=n.pc(8);n.Bb(2),n.kc("inline",!0)("matMenuTriggerFor",o)("matMenuTriggerData",n.nc(8,p,i.item,t)),n.Bb(2),n.Eb("text-danger",r.functionErrors[t.id]),n.Bb(1),n.Hc(" ",t.name," "),n.Bb(1),n.kc("ngIf",r.functionErrors[t.id]),n.Bb(2),n.Gc(t.description)}}function g(t,e){if(1&t&&(n.Sb(0,"div",10),n.Dc(1,h,9,11,"div",21),n.Rb()),2&t){const t=n.ec().$implicit;n.Bb(1),n.kc("ngForOf",t.functions)}}const v=function(t){return{"padding-left":t}};function S(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",9),n.Sb(1,"div",10),n.Sb(2,"div",11),n.Sb(3,"div",12),n.Sb(4,"div",13),n.ac("click",(function(){n.sc(t);const i=e.$implicit;return n.ec().createNewFunction(i.item)})),n.Nb(5,"i",14),n.Sb(6,"span",15),n.Fc(7),n.Rb(),n.Nb(8,"i",16),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"div",17),n.Dc(10,m,2,0,"div",18),n.Dc(11,g,2,1,"div",19),n.Rb(),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=e.index;n.Bb(1),n.zc(n.mc(6,v,10*i+"px")),n.Bb(6),n.Ic("",t.item.type,": ",t.item.name,""),n.Bb(3),n.kc("ngIf",0===t.functions.length),n.Bb(1),n.kc("ngIf",t.functions.length>0)}}function x(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",29),n.Sb(1,"span",30),n.Fc(2,"Function: "),n.Rb(),n.Sb(3,"span",31),n.Fc(4),n.Rb(),n.Rb(),n.Sb(5,"button",32),n.ac("click",(function(){n.sc(t);const i=e.item,r=e.func;return n.ec().duplicateFunction(i,r)})),n.Nb(6,"i",33),n.Fc(7," Duplicate"),n.Rb(),n.Sb(8,"button",32),n.ac("click",(function(){n.sc(t);const i=e.item,r=e.func;return n.ec().deleteFunction(i,r)})),n.Nb(9,"i",34),n.Fc(10," Delete"),n.Rb()}if(2&t){const t=e.func;n.Bb(4),n.Gc(t.name)}}let C=(()=>{class t{constructor(t,e,i){this.dialog=t,this.functionService=e,this.itemConfigService=i,this.errors=[],this.onConfigUpdated=new n.o,this.hierarchy=[],this.functionErrors={},this.subs=new r.a}ngOnInit(){this.setErrors(),this.determineHierarchy()}ngOnChanges(t){this.setErrors(),this.determineHierarchy()}determineHierarchy(){this.hierarchy=[];let t=this.item;if(t)for(this.setHierarchy(t);t.parent;)this.setHierarchy(t.parent),t=t.parent}setHierarchy(t){this.hierarchy.unshift({item:t,functions:t.functions})}ngOnDestroy(){this.subs.unsubscribe()}getPadding(t){return 20*t+"px"}formChanged(t){this.form=t}setErrors(){const t={};this.errors.forEach(e=>{var i,n,r,o,s;"functionError"===(null===(n=null===(i=e.error.data)||void 0===i?void 0:i.syntaxError)||void 0===n?void 0:n.type)&&(t[null===(r=e.error.data.syntaxError.funcObj)||void 0===r?void 0:r.id]||(t[null===(o=e.error.data.syntaxError.funcObj)||void 0===o?void 0:o.id]=[]),t[null===(s=e.error.data.syntaxError.funcObj)||void 0===s?void 0:s.id].push(e))}),this.functionErrors=t}createNewFunction(t){this.subs.add(this.itemConfigService.createAndEditFunction(t.id).pipe(Object(o.a)(t=>t.afterClosed())).subscribe(t=>this.configUpdated()))}editFunction(t,e){var i;const n=this.itemConfigService.editFunction(e.id,null!==(i=this.functionErrors[e.id])&&void 0!==i?i:[]);this.subs.add(n.afterClosed().subscribe(t=>this.configUpdated()))}configUpdated(){this.onConfigUpdated.emit(!0)}deleteFunction(t,e){this.dialog.open(s.a,{data:{title:`Delete function ${e.name}?`,text:"Deleting this function is a permanent action and cannot be undone.",button:{yes:"Delete",no:"Cancel"}},position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(i=>{!0===i&&this.subs.add(this.functionService.deleteFunction(e.id).subscribe(i=>{if(!0===i.success){const i=t.functions.findIndex(t=>t.id===e.id);i>=0&&t.functions.splice(i,1)}this.configUpdated()}))})}duplicateFunction(t,e){this.subs.add(this.functionService.duplicateFunction(e.id).subscribe(t=>this.configUpdated()))}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(c.b),n.Mb(a.a),n.Mb(l.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-functions"]],inputs:{item:"item",errors:"errors"},outputs:{onConfigUpdated:"onConfigUpdated"},features:[n.zb],decls:10,vars:1,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"fa","fa-magic"],[1,"p-2"],[1,"position-relative"],["class","cursor-pointer position-relative",4,"ngFor","ngForOf"],["yPosition","below"],["functionMenu","matMenu"],["matMenuContent",""],[1,"cursor-pointer","position-relative"],[1,""],[1,"py-2"],[1,"d-flex","align-items-center"],[1,"cursor-pointer",3,"click"],[1,"fa","fa-chevron-right","text-tiny"],[1,"text-bold","mx-1"],[1,"fa","fa-plus-square","text-tiny","font-weight-normal"],[1,"pl-1","py-2","dashed-border",2,"margin","2px 0 0 2px"],["class","text-muted text-tiny cursor-pointer config-item pl-2",3,"click",4,"ngIf"],["class","",4,"ngIf"],[1,"text-muted","text-tiny","cursor-pointer","config-item","pl-2",3,"click"],["class","d-flex align-items-center config-item",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","config-item"],[1,"item-menu"],[1,"item-menu-icon",3,"inline","matMenuTriggerFor","matMenuTriggerData"],[1,"cursor-pointer","item-name",3,"click"],["class","fa fa-exclamation-circle text-danger text-tiny",4,"ngIf"],[1,"text-muted","text-tiny",3,"click"],[1,"fa","fa-exclamation-circle","text-danger","text-tiny"],[1,"p-2","text-center","border-bottom"],[1,"text-capitalize"],[1,"text-bold"],["mat-menu-item","",3,"click"],[1,"far","fa-copy"],[1,"far","fa-trash-alt"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Functions"),n.Rb(),n.Rb(),n.Sb(4,"div",3),n.Sb(5,"div",4),n.Dc(6,S,12,8,"div",5),n.Rb(),n.Rb(),n.Sb(7,"mat-menu",6,7),n.Dc(9,x,11,1,"ng-template",8),n.Rb()),2&t&&(n.Bb(6),n.kc("ngForOf",e.hierarchy))},directives:[u.s,d.e,d.a,u.t,b.a,d.d,d.b],styles:[".dashed-border[_ngcontent-%COMP%]{border-left:1px dashed #b8b8b8}.config-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.config-item[_ngcontent-%COMP%]:hover   .item-menu-icon[_ngcontent-%COMP%]{display:block!important}.item-menu[_ngcontent-%COMP%]{width:20px;text-align:center}.item-menu[_ngcontent-%COMP%]   .item-menu-icon[_ngcontent-%COMP%]{display:none}.item-name[_ngcontent-%COMP%]{width:250px}.item-description[_ngcontent-%COMP%], .item-name[_ngcontent-%COMP%]{text-overflow:ellipsis}"]}),t})()},"1JH3":function(t,e,i){"use strict";i.d(e,"a",(function(){return F}));var n=i("0IaG"),r=i("quSY"),o=i("aSHc"),s=i("fXoL"),c=i("3Pt+"),a=i("9VQs"),l=i("ofXK"),u=i("bTqV"),d=i("Kj3r"),b=i("kmnG"),m=i("qFsG"),f=i("1jDz");function p(t,e){1&t&&(s.Sb(0,"mat-error"),s.Fc(1,"Input is required"),s.Rb())}function h(t,e){1&t&&(s.Sb(0,"mat-error"),s.Fc(1,"Only alpha-numeric and _ characters allowed"),s.Rb())}function g(t,e){if(1&t&&(s.Sb(0,"div",14),s.Nb(1,"i",15),s.Fc(2),s.Rb()),2&t){const t=e.$implicit;s.Bb(2),s.Hc(" ",null!=t.error.data&&null!=t.error.data.syntaxError&&t.error.data.syntaxError.error?null==t.error.data||null==t.error.data.syntaxError?null:t.error.data.syntaxError.error:null==t.error.data?null:t.error.data.message," ")}}function v(t,e){if(1&t&&(s.Sb(0,"div",12),s.Dc(1,g,3,1,"div",13),s.Rb()),2&t){const t=s.ec();s.Bb(1),s.kc("ngForOf",t.errors)}}let S=(()=>{class t{constructor(t){this.fb=t,this.form=new s.o,this.editorOptions={language:"javascript"},this.subs=new r.a}ngOnInit(){var t,e;this.functionText=""+(null!==(e=null===(t=this.functionForm)||void 0===t?void 0:t.contents)&&void 0!==e?e:""),this.initForm(),this.subs.add(this.formGroup.valueChanges.pipe(Object(d.a)(500)).subscribe(t=>{this.form.emit(this.formGroup)}))}initForm(){this.formGroup=this.fb.group({name:[this.functionForm.name,[c.E.required,c.E.pattern(/^[a-zA-Z0-9_]+$/)]],description:[this.functionForm.description,[]],contents:[this.functionForm.contents,[c.E.required]]})}get f(){return this.formGroup.controls}ngOnDestroy(){this.subs.unsubscribe()}saveFunction(t){this.f.contents.setValue(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(c.f))},t.\u0275cmp=s.Gb({type:t,selectors:[["functions-form"]],inputs:{functionForm:"functionForm",errors:"errors"},outputs:{form:"form"},decls:16,vars:7,consts:[[1,"mat-form",3,"formGroup"],[1,""],[1,"w-100"],["placeholder","Function name","type","text","matInput","","formControlName","name","required",""],[4,"ngIf"],[1,"pt-1"],["placeholder","Function Description","type","text","matInput","","formControlName","description"],[1,"row"],[1,"col"],[1,"pb-1"],["class","py-2",4,"ngIf"],[3,"text","editorOptions","height","onContentChange"],[1,"py-2"],["class","text-danger small",4,"ngFor","ngForOf"],[1,"text-danger","small"],[1,"fa","fa-exclamation-triangle","text-danger","text-small"]],template:function(t,e){1&t&&(s.Sb(0,"form",0),s.Sb(1,"div",1),s.Sb(2,"mat-form-field",2),s.Nb(3,"input",3),s.Dc(4,p,2,0,"mat-error",4),s.Dc(5,h,2,0,"mat-error",4),s.Rb(),s.Rb(),s.Sb(6,"div",5),s.Sb(7,"mat-form-field",2),s.Nb(8,"textarea",6),s.Rb(),s.Rb(),s.Rb(),s.Sb(9,"div",7),s.Sb(10,"div",8),s.Sb(11,"div",9),s.Sb(12,"div"),s.Fc(13,"Javascript Function:"),s.Rb(),s.Dc(14,v,2,1,"div",10),s.Rb(),s.Sb(15,"file-editor",11),s.ac("onContentChange",(function(t){return e.saveFunction(t)})),s.Rb(),s.Rb(),s.Rb()),2&t&&(s.kc("formGroup",e.formGroup),s.Bb(4),s.kc("ngIf",null==e.f.name||null==e.f.name.errors?null:e.f.name.errors.required),s.Bb(1),s.kc("ngIf",null==e.f.name||null==e.f.name.errors?null:e.f.name.errors.pattern),s.Bb(9),s.kc("ngIf",e.errors.length>0),s.Bb(1),s.kc("text",e.functionText)("editorOptions",e.editorOptions)("height","400px"))},directives:[c.G,c.r,c.j,b.c,m.a,c.c,c.q,c.i,c.B,l.t,f.a,b.b,l.s],styles:[""]}),t})();function x(t,e){1&t&&(s.Sb(0,"div",2),s.Sb(1,"div",10),s.Nb(2,"i",11),s.Fc(3," Saved"),s.Rb(),s.Rb())}function C(t,e){1&t&&(s.Sb(0,"div",2),s.Sb(1,"div",10),s.Fc(2,"...saving"),s.Rb(),s.Rb())}function R(t,e){1&t&&(s.Sb(0,"div",2),s.Sb(1,"div",12),s.Nb(2,"i",13),s.Sb(3,"span",2),s.Fc(4," has errors"),s.Rb(),s.Rb(),s.Rb())}function y(t,e){if(1&t){const t=s.Tb();s.Sb(0,"div",2),s.Sb(1,"functions-form",14),s.ac("form",(function(e){return s.sc(t),s.ec().formChanged(e)})),s.Rb(),s.Rb()}if(2&t){const t=s.ec();s.Bb(1),s.kc("functionForm",t.functionForm)("errors",t.errors)}}let k=(()=>{class t{constructor(t,e,i,n){this.fb=t,this.data=e,this.functionService=i,this.dialogRef=n,this.currentState=o.a.IDLE,this.actionState=o.a,this.subs=new r.a}ngOnInit(){var t;this.errors=null!==(t=this.data.errors)&&void 0!==t?t:[],this.subs.add(this.functionService.getFunction(this.data.id).subscribe(t=>{this.functionForm={name:t.name,description:t.description,contents:t.contents}}))}ngOnDestroy(){}formChanged(t){this.form=t,this.saveForm()}saveForm(){this.updateFunction()}updateFunction(){if(this.form)if(this.form.valid){this.currentState=o.a.PENDING;const{name:t,description:e,contents:i}=this.form.value;t&&this.functionService.updateFunction(this.data.id,t,i,e).subscribe(t=>{this.currentState=o.a.SUCCESS})}else this.form.dirty&&(this.currentState=o.a.ERROR)}close(t){this.dialogRef.close({updated:t})}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(c.f),s.Mb(n.a),s.Mb(a.a),s.Mb(n.h))},t.\u0275cmp=s.Gb({type:t,selectors:[["edit-function-dialog"]],decls:15,vars:6,consts:[["mat-dialog-title",""],[1,"d-flex","align-items-center"],[1,""],[1,"ml-auto","pr-2","text-small"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],["mat-dialog-content",""],["class","",4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","",3,"click"],[1,"ml-auto","text-success"],[1,"fa","fa-check-circle"],[1,"ml-auto","text-warning"],[1,"fa","fa-exclamation-triangle","text-warning"],[3,"functionForm","errors","form"]],template:function(t,e){1&t&&(s.Sb(0,"div",0),s.Sb(1,"div",1),s.Sb(2,"div",2),s.Sb(3,"h3"),s.Fc(4,"Edit Function"),s.Rb(),s.Rb(),s.Sb(5,"div",3),s.Qb(6,4),s.Dc(7,x,4,0,"div",5),s.Dc(8,C,3,0,"div",5),s.Dc(9,R,5,0,"div",5),s.Pb(),s.Rb(),s.Rb(),s.Rb(),s.Sb(10,"div",6),s.Dc(11,y,2,2,"div",7),s.Rb(),s.Sb(12,"div",8),s.Sb(13,"button",9),s.ac("click",(function(){return e.close(!0)})),s.Fc(14,"Close"),s.Rb(),s.Rb()),2&t&&(s.Bb(6),s.kc("ngSwitch",e.currentState),s.Bb(1),s.kc("ngSwitchCase",e.actionState.SUCCESS),s.Bb(1),s.kc("ngSwitchCase",e.actionState.PENDING),s.Bb(1),s.kc("ngSwitchCase",e.actionState.ERROR),s.Bb(2),s.kc("ngIf",e.functionForm),s.Bb(1),s.kc("align","end"))},directives:[n.i,l.x,l.y,n.f,l.t,n.c,u.b,S],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px}"]}),t})();var I=i("lJxs");let F=(()=>{class t{constructor(t,e){this.dialog=t,this.functionService=e}editFunction(t,e){return this.dialog.open(k,{data:{id:t,errors:e},minWidth:"800px",position:{top:"100px"},autoFocus:!0})}createNewFunction(t,e,i,n){return this.functionService.createFunction(t,e,null!=i?i:this.getDefaultFunctionContents(),n)}createAndEditFunction(t,e,i,n){return this.functionService.createFunction(t,e,null!=i?i:this.getDefaultFunctionContents(),n).pipe(Object(I.a)(t=>this.editFunction(t.function.id)))}getDefaultFunctionContents(){return"(param) => {\n  return param;\n}"}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(n.b),s.Wb(a.a))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"2VJ6":function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i("ofXK"),r=i("bTqV"),o=i("fmAS"),s=i("STbY"),c=i("NFeN"),a=i("fXoL");let l=(()=>{class t{}return t.\u0275mod=a.Kb({type:t}),t.\u0275inj=a.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,r.c,o.a,s.c,c.b]]}),t})()},"3D92":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i("fXoL"),r=i("ZJV+");let o=(()=>{class t{constructor(t){this.httpService=t}updateReadme(t,e){return this.httpService.put(`/blueprints/item/${t}/readme`,{readme:e})}updateVariables(t,e){return this.httpService.put(`/blueprints/item/${t}/variables`,{variables:e})}updateConfig(t,e){return this.httpService.put(`/blueprints/item/${t}/config`,{config:e})}updateLinks(t,e){return this.httpService.put(`/blueprints/item/${t}/links`,{links:e})}}return t.\u0275fac=function(e){return new(e||t)(n.Wb(r.a))},t.\u0275prov=n.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"6I3L":function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i("fXoL"),r=i("XNiG"),o=i("quSY"),s=i("Kj3r"),c=i("/uUt"),a=i("3D92"),l=i("1jDz");let u=(()=>{class t{constructor(t){this.itemService=t,this.onConfigUpdated=new n.o,this.property="description",this.descriptionText=null,this.editorOptions={language:"txt",lineNumbers:"off",glyphMargin:!1,lineDecorationsWidth:"5px",renderLineHighlight:"none",folding:!1},this.textToSave$=new r.a,this.subs=new o.a}ngOnInit(){this.editProperty(this.item),this.subs.add(this.textToSave$.pipe(Object(s.a)(250),Object(c.a)()).subscribe(t=>{this.selectedItem.config.description=t,this.saveForm()}))}ngOnDestroy(){this.subs.unsubscribe()}editProperty(t){setTimeout(()=>{this.descriptionText=null==t?void 0:t.config.description,this.selectedItem=t},20)}saveForm(){this.subs.add(this.itemService.updateConfig(this.selectedItem.id,this.selectedItem.config).subscribe(t=>this.onConfigUpdated.emit(!0)))}saveDescription(t){this.textToSave$.next(t)}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(a.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-description"]],inputs:{item:"item"},outputs:{onConfigUpdated:"onConfigUpdated"},decls:7,vars:3,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"fa","fa-info-circle"],[1,"p-2"],[1,"p-2","border","border-radius"],[3,"text","editorOptions","height","onContentChange"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Description"),n.Rb(),n.Rb(),n.Sb(4,"div",3),n.Sb(5,"div",4),n.Sb(6,"file-editor",5),n.ac("onContentChange",(function(t){return e.saveDescription(t)})),n.Rb(),n.Rb(),n.Rb()),2&t&&(n.Bb(6),n.kc("text",e.descriptionText)("editorOptions",e.editorOptions)("height","60px"))},directives:[l.a],styles:[""]}),t})()},"9VQs":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("fXoL"),r=i("ZJV+"),o=i("0IaG");let s=(()=>{class t{constructor(t,e){this.httpService=t,this.dialog=e}getFunction(t){return this.httpService.get("/blueprints/function/"+t)}getFunctions(){return this.httpService.get("/blueprints/function")}deleteFunction(t){return this.httpService.delete("/blueprints/function/"+t)}duplicateFunction(t){return this.httpService.post("/blueprints/function/duplicate/"+t)}createFunction(t,e,i,n){return this.httpService.post("/blueprints/function",{parentId:t,name:e,contents:i,description:n})}updateFunction(t,e,i,n){return this.httpService.put("/blueprints/function/"+t,{name:e,contents:i,description:n})}}return t.\u0275fac=function(e){return new(e||t)(n.Wb(r.a),n.Wb(o.b))},t.\u0275prov=n.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},AvgW:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i("ofXK"),r=i("xyCH"),o=i("lR5k"),s=i("fXoL");let c=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,r.a,o.b.forChild()]]}),t})()},Bp5M:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i("ofXK"),r=i("NFeN"),o=i("STbY"),s=i("fXoL");let c=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,r.b,o.c]]}),t})()},DdQb:function(t,e,i){"use strict";i.d(e,"a",(function(){return k}));var n=i("0IaG"),r=i("quSY"),o=i("aSHc"),s=i("fXoL"),c=i("ZJV+"),a=i("3D92"),l=i("ofXK"),u=i("3Pt+"),d=i("M3NP"),b=i("kmnG"),m=i("qFsG"),f=i("1jDz");function p(t,e){1&t&&(s.Sb(0,"mat-error"),s.Fc(1,"Input is required"),s.Rb())}function h(t,e){1&t&&(s.Sb(0,"mat-error"),s.Fc(1,"Only alpha-numeric and _ characters allowed. Must begin with a letter."),s.Rb())}function g(t,e){if(1&t&&(s.Sb(0,"div",11),s.Nb(1,"i",12),s.Fc(2),s.Rb()),2&t){const t=e.$implicit;s.Bb(2),s.Hc(" ",null!=t.error.data&&null!=t.error.data.syntaxError&&t.error.data.syntaxError.error?null==t.error.data||null==t.error.data.syntaxError?null:t.error.data.syntaxError.error:null==t.error.data?null:t.error.data.message," ")}}function v(t,e){if(1&t&&(s.Sb(0,"div",9),s.Dc(1,g,3,1,"div",10),s.Rb()),2&t){const t=s.ec();s.Bb(1),s.kc("ngForOf",t.errors)}}let S=(()=>{class t{constructor(t,e){this.fb=t,this.bluEditorService=e,this.variable={key:"",value:""},this.onChange=new s.o,this.errors=[],this.subs=new r.a,this.editorOptions={theme:"bluTheme",language:"bluLanguage",lineNumbers:"off",glyphMargin:!1,lineDecorationsWidth:"5px",renderLineHighlight:"none",folding:!1}}ngOnInit(){var t;this.initForm(),this.text=null!==(t=this.variable.value)&&void 0!==t?t:"",this.subs.add(this.formGroup.valueChanges.subscribe(t=>{this.onChange.emit(this.formGroup)}))}initForm(){this.formGroup=this.fb.group({key:[this.variable.key,[u.E.required,u.E.pattern(/^[$A-Z_][0-9A-Z_$]*$/i)]],value:[this.variable.value,[]]}),this.variable.key&&this.formGroup.markAllAsTouched(),this.onChange.emit(this.formGroup)}get f(){return this.formGroup.controls}onEditorInit(t){this.editorModel=t,this.setContext(),this.editorModel.onDidChangeContent(t=>this.saveValue(this.editorModel.getValue()))}setContext(){this.editorModel&&this.bluEditorService.registerCompletionProvider(monaco,this.renderContext)}saveValue(t){this.f.value.setValue(t),this.f.value.markAsTouched(),this.f.value.markAsDirty()}ngOnDestroy(){this.subs.unsubscribe(),this.bluEditorService.disposeCompletionProvider()}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(u.f),s.Mb(d.a))},t.\u0275cmp=s.Gb({type:t,selectors:[["variable-form"]],inputs:{variable:"variable",renderContext:"renderContext",errors:"errors"},outputs:{onChange:"onChange"},decls:12,vars:7,consts:[[1,"mat-form",3,"formGroup"],[1,""],["placeholder","Name","type","text","spellcheck","false","matInput","","formControlName","key"],[4,"ngIf"],[1,"",2,"height","200px"],[1,"py-1"],["class","py-2",4,"ngIf"],[1,"border","rounded","p-1"],[3,"text","editorOptions","height","onEditorInit"],[1,"py-2"],["class","text-danger small",4,"ngFor","ngForOf"],[1,"text-danger","small"],[1,"fa","fa-exclamation-triangle","text-danger","text-small"]],template:function(t,e){1&t&&(s.Sb(0,"form",0),s.Sb(1,"div",1),s.Sb(2,"mat-form-field"),s.Nb(3,"input",2),s.Dc(4,p,2,0,"mat-error",3),s.Dc(5,h,2,0,"mat-error",3),s.Rb(),s.Rb(),s.Sb(6,"div",4),s.Sb(7,"div",5),s.Fc(8,"Variable Value:"),s.Rb(),s.Dc(9,v,2,1,"div",6),s.Sb(10,"div",7),s.Sb(11,"file-editor",8),s.ac("onEditorInit",(function(t){return e.onEditorInit(t)})),s.Rb(),s.Rb(),s.Rb(),s.Rb()),2&t&&(s.kc("formGroup",e.formGroup),s.Bb(4),s.kc("ngIf",null==e.f.key||null==e.f.key.errors?null:e.f.key.errors.required),s.Bb(1),s.kc("ngIf",null==e.f.key||null==e.f.key.errors?null:e.f.key.errors.pattern),s.Bb(4),s.kc("ngIf",e.errors.length>0),s.Bb(2),s.kc("text",e.text)("editorOptions",e.editorOptions)("height","100px"))},directives:[u.G,u.r,u.j,b.c,m.a,u.c,u.q,u.i,l.t,f.a,b.b,l.s],styles:[".mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();var x=i("bTqV");function C(t,e){1&t&&(s.Sb(0,"div",2),s.Sb(1,"div",11),s.Nb(2,"i",12),s.Rb(),s.Rb())}function R(t,e){1&t&&(s.Sb(0,"div",2),s.Sb(1,"div",11),s.Fc(2,"...saving"),s.Rb(),s.Rb())}function y(t,e){1&t&&(s.Sb(0,"div",2),s.Sb(1,"div",13),s.Nb(2,"i",14),s.Nb(3,"span",2),s.Rb(),s.Rb())}let k=(()=>{class t{constructor(t,e,i,n){this.data=t,this.httpService=e,this.itemService=i,this.dialogRef=n,this.actionState=o.a,this.subs=new r.a}ngOnInit(){var t;this.errors=null!==(t=this.data.errors)&&void 0!==t?t:[],this.item=this.data.item,this.currentState=o.a.IDLE,this.renderContext=this.data.renderContext}ngOnDestroy(){this.subs.unsubscribe(),this.currentState=o.a.IDLE}formChanged(t){this.form=t,this.currentState=t.dirty?t.valid?o.a.SUCCESS:o.a.ERROR:o.a.IDLE}saveVariables(){if(this.form&&this.form.valid){const{key:t,value:e}=this.form.value;t&&(this.data.variable.key&&delete this.item.variables[this.data.variable.key],this.item.variables[t]=e,this.subs.add(this.itemService.updateVariables(this.item.id,this.item.variables).subscribe(t=>{this.close(!0)})))}}close(t){this.dialogRef.close({updated:t})}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(n.a),s.Mb(c.a),s.Mb(a.a),s.Mb(n.h))},t.\u0275cmp=s.Gb({type:t,selectors:[["edit-variables-dialog"]],decls:17,vars:9,consts:[["mat-dialog-title",""],[1,"d-flex","align-items-center"],[1,""],[1,"ml-auto","pr-2","text-small"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],["mat-dialog-content",""],[3,"variable","renderContext","errors","onChange"],["mat-dialog-actions","",3,"align"],["mat-button","",3,"click"],["mat-button","",3,"disabled","click"],[1,"ml-auto","text-success"],[1,"fa","fa-check-circle"],[1,"ml-auto","text-warning"],[1,"fa","fa-exclamation-triangle","text-warning"]],template:function(t,e){1&t&&(s.Sb(0,"h1",0),s.Sb(1,"div",1),s.Sb(2,"div",2),s.Sb(3,"h3"),s.Fc(4,"Edit Variable"),s.Rb(),s.Rb(),s.Sb(5,"div",3),s.Qb(6,4),s.Dc(7,C,3,0,"div",5),s.Dc(8,R,3,0,"div",5),s.Dc(9,y,4,0,"div",5),s.Pb(),s.Rb(),s.Rb(),s.Rb(),s.Sb(10,"div",6),s.Sb(11,"variable-form",7),s.ac("onChange",(function(t){return e.formChanged(t)})),s.Rb(),s.Rb(),s.Sb(12,"div",8),s.Sb(13,"button",9),s.ac("click",(function(){return e.close(!0)})),s.Fc(14,"Cancel"),s.Rb(),s.Sb(15,"button",10),s.ac("click",(function(){return e.saveVariables()})),s.Fc(16,"Save"),s.Rb(),s.Rb()),2&t&&(s.Bb(6),s.kc("ngSwitch",e.currentState),s.Bb(1),s.kc("ngSwitchCase",e.actionState.SUCCESS),s.Bb(1),s.kc("ngSwitchCase",e.actionState.PENDING),s.Bb(1),s.kc("ngSwitchCase",e.actionState.ERROR),s.Bb(2),s.kc("variable",e.data.variable)("renderContext",e.renderContext)("errors",e.errors),s.Bb(1),s.kc("align","end"),s.Bb(3),s.kc("disabled",null==e.form?null:e.form.invalid))},directives:[n.i,l.x,l.y,n.f,S,n.c,x.b],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px}"]}),t})()},Eow3:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i("ofXK"),r=i("fXoL");let o=(()=>{class t{}return t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c]]}),t})()},KjPU:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("ofXK"),r=i("xyCH"),o=i("fXoL");let s=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,r.a]]}),t})()},M3NP:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("fXoL");let r=(()=>{class t{constructor(){this.variableNameSuggestions=["destination","f","links"].sort()}disposeCompletionProvider(){this.completionProvider&&this.completionProvider.dispose()}registerCompletionProvider(t,e,i="bluLanguage"){this.disposeCompletionProvider(),this.completionProvider=t.languages.registerCompletionItemProvider(i,{provideCompletionItems:(i,n,r,o)=>{let s;const c=i.getValueInRange({startLineNumber:n.lineNumber,startColumn:1,endLineNumber:n.lineNumber,endColumn:1/0}),a=(i.getValueInRange({startLineNumber:n.lineNumber,startColumn:1,endLineNumber:n.lineNumber,endColumn:n.column}),/\((.*?)\)/g),l=this.isInside(/\[blu (.*?)]/g,c,n),u=this.isInside(/\^\^(.*?)\^\^/g,c,n);return null!==l?s=null!==this.isInside(a,c,n)?this.contextSuggestions(t,e):this.bluBlockSuggestions(t):null!==u&&(s=this.isAfter(":",u,n)?this.contextFunctions(t,e,!0):this.contextSuggestions(t,e)),s=null!=s?s:this.getDefaultSuggestions(t),{suggestions:s}}})}isAfter(t,e,i){return e.indexOf(t)>=0}isInside(t,e,i){let n,r=!1,o=null;for(;(n=t.exec(e))&&!r;)n.index<i.column&&i.column<=t.lastIndex&&(o=n[1],r=!0);return o}contextSuggestions(t,e,i=!1){return[...this.contextInputs(t,e),...this.contextFunctions(t,e,i)]}contextInputs(t,e){return Object.keys(e.inputs).map(e=>({label:e,kind:t.languages.CompletionItemKind.Variable,insertText:e,sortText:"a"+e}))}contextFunctions(t,e,i=!1){let n=[];return n=e.functions.map(i?e=>({label:""+e.name,kind:t.languages.CompletionItemKind.Function,insertText:""+e.name,sortText:"b"+e.name}):e=>({label:e.name+"()",kind:t.languages.CompletionItemKind.Function,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:e.name+"(${1})",sortText:"b"+e.name})),n}bluBlockSuggestions(t){return[{label:"if",documentation:"Add an if statement",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"if(${1})",sortText:"b",command:{id:"editor.action.triggerSuggest"}},{label:"elseIf",documentation:"Add an elseIf statement",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"elseIf(${1})",sortText:"c",command:{id:"editor.action.triggerSuggest"}},{label:"forEach",documentation:"Add a forEach statement",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"forEach(${2} in ${1})",sortText:"a",command:{id:"editor.action.triggerSuggest"}},{label:"forEachIndex",documentation:"Add a forEach statement with a verbose index identifier",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"forEach(${2} in ${1});i=index",sortText:"h",command:{id:"editor.action.triggerSuggest"}},{label:"else",documentation:"Add an else statement",kind:t.languages.CompletionItemKind.Text,insertText:"else",sortText:"d"},{label:"switch",documentation:"Add a switch statement",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"switch(${1})",sortText:"e",command:{id:"editor.action.triggerSuggest"}},{label:"switchCase",documentation:"Add a switchCase statement",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"switchCase ${1}",sortText:"f",command:{id:"editor.action.triggerSuggest"}},{label:"switchDefault",documentation:"Add an switchDefault statement",kind:t.languages.CompletionItemKind.Text,insertText:"switchDefault",sortText:"g"}]}getDefaultSuggestions(t){return[{label:"blu",documentation:"Add a [blu] [/blu] block",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"[blu ${1}]$0[/blu]",sortText:"b",command:{id:"editor.action.triggerSuggest"}},{label:"expression",documentation:"Add a ^^  ^^ expression",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"^^${1}^^",sortText:"a",command:{id:"editor.action.triggerSuggest"}},{label:"transformation",documentation:"Add a transformation ^^value:function^^ expression",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"^^${1}:${2}^^",sortText:"c",command:{id:"editor.action.triggerSuggest"}},{label:"comment",documentation:"Add a ^^!  !^^ comment",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"^^! ${1} !^^",sortText:"d"},{label:"expression (escaped)",documentation:"Add a ^^!  !^^ comment",kind:t.languages.CompletionItemKind.Snippet,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:"^^~ ${1} ~^^",sortText:"e"}]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},Mzu6:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("0IaG"),r=i("fXoL"),o=i("bTqV");let s=(()=>{class t{constructor(t,e){this.data=t,this.dialogRef=e}ngOnInit(){}ngOnDestroy(){}cancel(){this.dialogRef.close(!1)}confirm(){this.dialogRef.close(!0)}}return t.\u0275fac=function(e){return new(e||t)(r.Mb(n.a),r.Mb(n.h))},t.\u0275cmp=r.Gb({type:t,selectors:[["confirmation-dialog"]],decls:10,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"p-2","text-center"],["mat-dialog-actions","",3,"align"],["mat-button","",3,"click"]],template:function(t,e){1&t&&(r.Sb(0,"h1",0),r.Fc(1),r.Rb(),r.Sb(2,"div",1),r.Sb(3,"div",2),r.Fc(4),r.Rb(),r.Rb(),r.Sb(5,"div",3),r.Sb(6,"button",4),r.ac("click",(function(){return e.cancel()})),r.Fc(7),r.Rb(),r.Sb(8,"button",4),r.ac("click",(function(){return e.confirm()})),r.Fc(9),r.Rb(),r.Rb()),2&t&&(r.Bb(1),r.Gc(e.data.title),r.Bb(3),r.Gc(e.data.text),r.Bb(1),r.kc("align","end"),r.Bb(2),r.Gc(null!=e.data.button&&e.data.button.no?null==e.data.button?null:e.data.button.no:"No"),r.Bb(2),r.Gc(null!=e.data.button&&e.data.button.yes?null==e.data.button?null:e.data.button.yes:"Yes"))},directives:[n.i,n.f,n.c,o.b],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px}"]}),t})()},fCHT:function(t,e,i){"use strict";i.d(e,"a",(function(){return st}));var n=i("fXoL"),r=i("GV7L"),o=i("quSY"),s=i("0IaG"),c=i("3Pt+"),a=i("M3NP"),l=i("Kxoc"),u=i("ofXK"),d=i("kmnG"),b=i("d3UM"),m=i("FKr1");function f(t,e){if(1&t&&(n.Sb(0,"mat-option",6),n.Fc(1),n.Sb(2,"span",7),n.Fc(3),n.Rb(),n.Rb()),2&t){const t=e.$implicit;n.kc("value",t),n.Bb(1),n.Hc("",t.name," "),n.Bb(2),n.Hc("[",t.parent.name,"]")}}function p(t,e){if(1&t&&(n.Sb(0,"form",1),n.Sb(1,"div",2),n.Sb(2,"mat-form-field",3),n.Sb(3,"mat-label"),n.Fc(4,"Select Template"),n.Rb(),n.Sb(5,"mat-select",4),n.Dc(6,f,4,3,"mat-option",5),n.Rb(),n.Rb(),n.Rb(),n.Rb()),2&t){const t=n.ec();n.kc("formGroup",t.formGroup),n.Bb(6),n.kc("ngForOf",t.items)}}let h=(()=>{class t{constructor(t,e){this.fb=t,this.bluService=e,this.onChange=new n.o,this.items=[]}ngOnInit(){var t;this.chainedTemplate=null!==(t=this.chainedTemplate)&&void 0!==t?t:{templateId:"",inputs:{}},this.bluService.getItems().subscribe(t=>{this.items=t.sort((t,e)=>t.name>e.name?1:-1),this.initForm(),this.onChange.emit(this.formGroup),this.formGroup.valueChanges.subscribe(t=>{this.onChange.emit(this.formGroup)})})}initForm(){const t=this.items.find(t=>t.id===this.chainedTemplate.templateId);this.formGroup=this.fb.group({template:[t,[c.E.required]]})}get f(){var t;return null===(t=this.formGroup)||void 0===t?void 0:t.controls}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(c.f),n.Mb(l.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["command-form"]],inputs:{chainedTemplate:"chainedTemplate"},outputs:{onChange:"onChange"},decls:1,vars:1,consts:[["class","mat-form",3,"formGroup",4,"ngIf"],[1,"mat-form",3,"formGroup"],[1,""],["appearance","fill"],["formControlName","template"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-tiny","text-muted"]],template:function(t,e){1&t&&n.Dc(0,p,7,2,"form",0),2&t&&n.kc("ngIf",e.formGroup)},directives:[u.t,c.G,c.r,c.j,d.c,d.g,b.a,c.q,c.i,u.s,m.i],styles:[".mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();var g=i("STbY"),v=i("NFeN"),S=i("qFsG"),x=i("/1cH"),C=i("1jDz");function R(t,e){if(1&t&&(n.Sb(0,"mat-option",11),n.Fc(1),n.Rb()),2&t){const t=e.$implicit;n.kc("value",t),n.Bb(1),n.Hc(" ",t," ")}}function y(t,e){1&t&&(n.Sb(0,"mat-error"),n.Fc(1,"Input is required"),n.Rb())}function k(t,e){1&t&&(n.Sb(0,"mat-error"),n.Fc(1,"Only alpha-numeric and _ characters allowed. Must begin with a letter."),n.Rb())}function I(t,e){1&t&&(n.Sb(0,"mat-error"),n.Fc(1,"Input with this name already exits and would be overwritten"),n.Rb())}function F(t,e){if(1&t&&(n.Qb(0),n.Nb(1,"i",15),n.Fc(2),n.Pb()),2&t){const t=n.ec().$implicit;n.Bb(2),n.Hc(" ",null!=t.error.data&&null!=t.error.data.syntaxError&&t.error.data.syntaxError.error?null==t.error.data||null==t.error.data.syntaxError?null:t.error.data.syntaxError.error:null==t.error.data?null:t.error.data.message," ")}}function O(t,e){if(1&t&&(n.Sb(0,"div",14),n.Dc(1,F,3,1,"ng-container",6),n.Rb()),2&t){const t=e.$implicit;n.Bb(1),n.kc("ngIf",!!t.error.origin.property)}}function T(t,e){if(1&t&&(n.Sb(0,"div",12),n.Dc(1,O,2,1,"div",13),n.Rb()),2&t){const t=n.ec();n.Bb(1),n.kc("ngForOf",t.errors)}}let E=(()=>{class t{constructor(t,e){this.fb=t,this.bluEditorService=e,this.input={key:"",value:""},this.onChange=new n.o,this.errors=[],this.subs=new o.a,this.editorOptions={theme:"bluTheme",language:"bluLanguage",lineNumbers:"off",glyphMargin:!1,lineDecorationsWidth:"5px",renderLineHighlight:"none",folding:!1},this.inputNameSuggestions=[]}ngOnInit(){var t;this.inputNameSuggestions=this.bluEditorService.variableNameSuggestions,this.editCreateText=this.input.key?"Edit":"Add",this.text=null!==(t=this.input.value)&&void 0!==t?t:"",this.initForm(),this.formGroup.valueChanges.subscribe(t=>{this.onChange.emit(this.formGroup)})}initForm(){this.formGroup=this.fb.group({key:[this.input.key,[c.E.required,c.E.pattern(/^[$A-Z_][0-9A-Z_$]*$/i),this.inputNameExistsValidator(this.allInputs,this.input)]],value:[this.input.value,[c.E.required]]}),this.input.key&&this.formGroup.markAllAsTouched(),this.onChange.emit(this.formGroup)}get f(){return this.formGroup.controls}onEditorInit(t){this.editorModel=t,this.setContext(),this.editorModel.onDidChangeContent(t=>this.saveValue(this.editorModel.getValue()))}setContext(){this.editorModel&&this.bluEditorService.registerCompletionProvider(monaco,this.renderContext)}saveValue(t){this.f.value.setValue(t),this.f.value.markAsTouched(),this.f.value.markAsDirty()}ngOnDestroy(){this.subs.unsubscribe(),this.bluEditorService.disposeCompletionProvider()}inputNameExistsValidator(t,e){return i=>{const n=Object.keys(null!=t?t:{});return e.key!==""+(null==i?void 0:i.value)&&n.includes(""+(null==i?void 0:i.value))?{nameExists:{valid:!1}}:null}}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(c.f),n.Mb(a.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["add-input-form"]],inputs:{input:"input",allInputs:"allInputs",renderContext:"renderContext",errors:"errors"},outputs:{onChange:"onChange"},decls:17,vars:11,consts:[[1,"border-bottom"],[1,"mat-form",3,"formGroup"],[1,""],["placeholder","Input Name","type","text","spellcheck","false","matInput","","formControlName","key",3,"matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"py-1"],["class","py-2",4,"ngIf"],[1,"border","rounded","p-1"],[3,"text","editorOptions","height","onEditorInit"],[3,"value"],[1,"py-2"],["class","text-danger small",4,"ngFor","ngForOf"],[1,"text-danger","small"],[1,"fa","fa-exclamation-triangle","text-danger","text-small"]],template:function(t,e){if(1&t&&(n.Sb(0,"h2",0),n.Fc(1),n.Rb(),n.Sb(2,"form",1),n.Sb(3,"div",2),n.Sb(4,"mat-form-field"),n.Nb(5,"input",3),n.Sb(6,"mat-autocomplete",null,4),n.Dc(8,R,2,2,"mat-option",5),n.Rb(),n.Dc(9,y,2,0,"mat-error",6),n.Dc(10,k,2,0,"mat-error",6),n.Dc(11,I,2,0,"mat-error",6),n.Rb(),n.Rb(),n.Sb(12,"div",7),n.Fc(13,"Input Value:"),n.Rb(),n.Dc(14,T,2,1,"div",8),n.Sb(15,"div",9),n.Sb(16,"file-editor",10),n.ac("onEditorInit",(function(t){return e.onEditorInit(t)})),n.Rb(),n.Rb(),n.Rb()),2&t){const t=n.pc(7);n.Bb(1),n.Hc("",e.editCreateText," Input"),n.Bb(1),n.kc("formGroup",e.formGroup),n.Bb(3),n.kc("matAutocomplete",t),n.Bb(3),n.kc("ngForOf",e.inputNameSuggestions),n.Bb(1),n.kc("ngIf",null==e.f.key||null==e.f.key.errors?null:e.f.key.errors.required),n.Bb(1),n.kc("ngIf",null==e.f.key||null==e.f.key.errors?null:e.f.key.errors.pattern),n.Bb(1),n.kc("ngIf",null==e.f.key||null==e.f.key.errors?null:e.f.key.errors.nameExists),n.Bb(3),n.kc("ngIf",e.errors.length>0),n.Bb(2),n.kc("text",e.text)("editorOptions",e.editorOptions)("height","100px")}},directives:[c.G,c.r,c.j,d.c,S.a,c.c,x.c,c.q,c.i,x.a,u.s,u.t,C.a,m.i,d.b],styles:[".mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();var D=i("bTqV");function M(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",17),n.ac("click",(function(){return n.sc(t),n.ec(2).createInput()})),n.Fc(1," No inputs present. Click "),n.Nb(2,"i",18),n.Fc(3," Add input to add one. "),n.Rb()}}function w(t,e){1&t&&n.Nb(0,"i",27)}const B=function(t){return{input:t}};function N(t,e){if(1&t){const t=n.Tb();n.Sb(0,"tr"),n.Sb(1,"td",22),n.Sb(2,"mat-icon",23),n.Fc(3,"more_vert"),n.Rb(),n.Rb(),n.Sb(4,"td",24),n.ac("click",(function(){n.sc(t);const i=e.$implicit;return n.ec(3).editInput(i)})),n.Fc(5),n.Dc(6,w,1,0,"i",25),n.Rb(),n.Sb(7,"td",26),n.ac("click",(function(){n.sc(t);const i=e.$implicit;return n.ec(3).editInput(i)})),n.Fc(8),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=n.ec(3),r=n.pc(12);n.Bb(2),n.kc("inline",!0)("matMenuTriggerFor",r)("matMenuTriggerData",n.mc(6,B,t)),n.Bb(3),n.Hc("",t.key," "),n.Bb(1),n.kc("ngIf",i.variableErrors[t.key]),n.Bb(2),n.Gc(t.value)}}function P(t,e){if(1&t&&(n.Sb(0,"div",19),n.Sb(1,"table",20),n.Dc(2,N,9,8,"tr",21),n.Rb(),n.Rb()),2&t){const t=n.ec(2);n.Bb(2),n.kc("ngForOf",t.inputsList)}}function G(t,e){if(1&t){const t=n.Tb();n.Qb(0),n.Sb(1,"div",10),n.Sb(2,"div",11),n.Sb(3,"div",12),n.Fc(4,"Inputs"),n.Rb(),n.Sb(5,"div",13),n.ac("click",(function(){return n.sc(t),n.ec().createInput()})),n.Nb(6,"i",14),n.Fc(7," Add input"),n.Rb(),n.Rb(),n.Dc(8,M,4,0,"div",15),n.Dc(9,P,3,1,"div",16),n.Rb(),n.Pb()}if(2&t){const t=n.ec();n.Bb(8),n.kc("ngIf",0===t.inputsList.length),n.Bb(1),n.kc("ngIf",t.inputsList.length>0)}}function $(t,e){if(1&t){const t=n.Tb();n.Qb(0),n.Sb(1,"add-input-form",28),n.ac("onChange",(function(e){return n.sc(t),n.ec().setInput(e)})),n.Rb(),n.Pb()}if(2&t){const t=n.ec();n.Bb(1),n.kc("input",t.selectedInput)("renderContext",t.data.renderContext)("allInputs",t.chainedTemplate.inputs)("errors",t.errors)}}function _(t,e){1&t&&n.Nb(0,"i",39)}function L(t,e){if(1&t&&(n.Qb(0),n.Sb(1,"span",37),n.Fc(2),n.Rb(),n.Dc(3,_,1,0,"i",38),n.Pb()),2&t){const t=e.$implicit,i=e.index,r=n.ec(2).$implicit;n.Bb(1),n.Eb("text-danger",t.name===r.error.data.templateName),n.Bb(1),n.Gc(t.name),n.Bb(1),n.kc("ngIf",i<r.error.data.chainOrder.length-1)}}function V(t,e){if(1&t&&(n.Qb(0),n.Sb(1,"div",36),n.Dc(2,L,4,4,"ng-container",21),n.Rb(),n.Pb()),2&t){const t=n.ec().$implicit;n.Bb(2),n.kc("ngForOf",t.error.data.chainOrder)}}function H(t,e){if(1&t&&(n.Sb(0,"div",31),n.Sb(1,"div",32),n.Nb(2,"i",33),n.Fc(3),n.Rb(),n.Qb(4,34),n.Dc(5,V,3,1,"ng-container",35),n.Pb(),n.Rb()),2&t){const t=e.$implicit;n.Bb(3),n.Hc(" ",t.error.message,""),n.Bb(1),n.kc("ngSwitch",t.error.type),n.Bb(1),n.kc("ngSwitchCase","circularChain")}}function A(t,e){if(1&t&&(n.Sb(0,"div",29),n.Dc(1,H,6,3,"div",30),n.Rb()),2&t){const t=n.ec();n.Bb(1),n.kc("ngForOf",t.errors)}}function K(t,e){if(1&t){const t=n.Tb();n.Qb(0),n.Sb(1,"button",40),n.Fc(2,"Cancel"),n.Rb(),n.Sb(3,"button",41),n.ac("click",(function(){return n.sc(t),n.ec().save()})),n.Fc(4,"Save"),n.Rb(),n.Pb()}if(2&t){const t=n.ec();n.Bb(3),n.kc("disabled",null==t.form?null:t.form.invalid)}}function U(t,e){if(1&t){const t=n.Tb();n.Qb(0),n.Sb(1,"button",42),n.ac("click",(function(){return n.sc(t),n.ec().cancelEditInput()})),n.Fc(2,"Cancel"),n.Rb(),n.Sb(3,"button",41),n.ac("click",(function(){return n.sc(t),n.ec().saveInput()})),n.Fc(4,"Save Input"),n.Rb(),n.Pb()}if(2&t){const t=n.ec();n.Bb(3),n.kc("disabled",null==t.inputsForm?null:t.inputsForm.invalid)}}function j(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",43),n.Sb(1,"span",44),n.Fc(2,"Input: "),n.Rb(),n.Sb(3,"span",45),n.Fc(4),n.Rb(),n.Rb(),n.Sb(5,"button",46),n.ac("click",(function(){n.sc(t);const i=e.input;return n.ec().duplicateInput(i)})),n.Nb(6,"i",47),n.Fc(7," Duplicate"),n.Rb(),n.Sb(8,"button",46),n.ac("click",(function(){n.sc(t);const i=e.input;return n.ec().deleteInput(i)})),n.Nb(9,"i",48),n.Fc(10," Delete"),n.Rb()}if(2&t){const t=e.input;n.Bb(4),n.Gc(t.key)}}let q=(()=>{class t{constructor(t,e,i,n,r){this.fb=t,this.bluEditorService=e,this.cdr=i,this.data=n,this.dialogRef=r,this.inputsList=[],this.variableErrors={},this.subs=new o.a}ngOnInit(){var t,e;this.chainedTemplate=null!==(t=this.data.chainedTemplate)&&void 0!==t?t:{templateId:"",inputs:{}},this.errors=null!==(e=this.data.errors)&&void 0!==e?e:[],this.setErrors(),this.createInputsList()}ngOnDestroy(){this.subs.unsubscribe()}createInputsList(){this.inputsList=Object.keys(this.chainedTemplate.inputs).map(t=>({key:t,value:this.chainedTemplate.inputs[t]}))}close(){this.dialogRef.close(this.form.value)}setCommand(t){this.form=t,this.form.valid&&(this.chainedTemplate.templateId=this.form.controls.template.value.id)}save(){this.dialogRef.close({chainedTemplate:this.chainedTemplate,type:this.data.type,index:this.data.index})}createInput(){this.selectedInput={key:"",value:""},this.currentSection="editInput"}cancelEditInput(){this.currentSection=null}saveInput(){this.chainedTemplate.inputs[this.inputsForm.controls.key.value]=this.inputsForm.controls.value.value,this.createInputsList(),this.currentSection=null}setInput(t){this.inputsForm=t}duplicateInput(t){let e=t.key+"_copy";this.chainedTemplate.inputs[e]&&(e=`${t.key}_${Math.floor(1e3*Math.random())+1}`),this.chainedTemplate.inputs[e]=t.value,this.createInputsList()}deleteInput(t){delete this.chainedTemplate.inputs[t.key],this.createInputsList()}editInput(t){this.selectedInput=t,this.currentSection="editInput"}setErrors(){const t={};this.errors.forEach(e=>{var i,n;if((null===(i=e.error.origin)||void 0===i?void 0:i.location)===r.a.Execute.ErrorLocation.config&&(null===(n=e.error.origin)||void 0===n?void 0:n.section)===r.a.Execute.ErrorSection.chainedTemplates){const i=""+e.error.origin.property;t[i]||(t[i]=[]),t[i].push(e)}}),this.variableErrors=t}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(c.f),n.Mb(a.a),n.Mb(n.h),n.Mb(s.a),n.Mb(s.h))},t.\u0275cmp=n.Gb({type:t,selectors:[["edit-commands-dialog"]],decls:14,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"chainedTemplate","onChange"],[1,"mt-1",2,"height","350px"],[4,"ngIf"],["class","p-2",4,"ngIf"],["mat-dialog-actions","",3,"align"],["yPosition","below"],["inputMenu","matMenu"],["matMenuContent",""],[1,""],[1,"d-flex"],[1,"pl-2"],[1,"ml-auto","cursor-pointer","pr-2",3,"click"],[1,"fa","fa-plus-square","text-muted"],["class","text-center text-muted cursor-pointer p-4",3,"click",4,"ngIf"],["class","pt-2",4,"ngIf"],[1,"text-center","text-muted","cursor-pointer","p-4",3,"click"],[1,"fa","fa-plus-square"],[1,"pt-2"],[1,"w-100","inputs-table"],[4,"ngFor","ngForOf"],[1,"input-menu","cursor-pointer"],[1,"input-menu-icon",3,"inline","matMenuTriggerFor","matMenuTriggerData"],[1,"name-field","cursor-pointer",3,"click"],["class","fa fa-exclamation-circle text-danger text-tiny",4,"ngIf"],[1,"cursor-pointer",3,"click"],[1,"fa","fa-exclamation-circle","text-danger","text-tiny"],[3,"input","renderContext","allInputs","errors","onChange"],[1,"p-2"],["class","pt-1",4,"ngFor","ngForOf"],[1,"pt-1"],[1,"text-danger","text-small"],[1,"fa","fa-exclamation-triangle"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"pl-4"],[1,"mr-1"],["class","fa fa-arrow-right mr-1 text-tiny",4,"ngIf"],[1,"fa","fa-arrow-right","mr-1","text-tiny"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],[1,"p-2","text-center","border-bottom"],[1,"text-capitalize"],[1,"text-bold"],["mat-menu-item","",3,"click"],[1,"far","fa-copy"],[1,"far","fa-trash-alt"]],template:function(t,e){1&t&&(n.Sb(0,"h1",0),n.Fc(1,"Chained Template"),n.Rb(),n.Sb(2,"div",1),n.Sb(3,"command-form",2),n.ac("onChange",(function(t){return e.setCommand(t)})),n.Rb(),n.Sb(4,"div",3),n.Dc(5,G,10,2,"ng-container",4),n.Dc(6,$,2,4,"ng-container",4),n.Rb(),n.Dc(7,A,2,1,"div",5),n.Rb(),n.Sb(8,"div",6),n.Dc(9,K,5,1,"ng-container",4),n.Dc(10,U,5,1,"ng-container",4),n.Rb(),n.Sb(11,"mat-menu",7,8),n.Dc(13,j,11,1,"ng-template",9),n.Rb()),2&t&&(n.Bb(3),n.kc("chainedTemplate",e.chainedTemplate),n.Bb(2),n.kc("ngIf","editInput"!==e.currentSection),n.Bb(1),n.kc("ngIf","editInput"===e.currentSection),n.Bb(1),n.kc("ngIf",e.errors.length>0),n.Bb(1),n.kc("align","end"),n.Bb(1),n.kc("ngIf","editInput"!==e.currentSection),n.Bb(1),n.kc("ngIf","editInput"===e.currentSection))},directives:[s.i,s.f,h,u.t,s.c,g.e,g.a,u.s,v.a,g.d,E,u.x,u.y,D.b,s.d,g.b],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px}.input-menu[_ngcontent-%COMP%]{width:30px;padding:0!important;text-align:center}.input-menu-icon[_ngcontent-%COMP%]{display:none}.inputs-table[_ngcontent-%COMP%]   .name-field[_ngcontent-%COMP%]{min-width:200px}.inputs-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:2px 4px}.inputs-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.inputs-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   .input-menu-icon[_ngcontent-%COMP%]{display:block!important}"]}),t})();var X=i("3guR");function Q(t,e){1&t&&(n.Qb(0),n.Sb(1,"div",12),n.Fc(2,"No templates present in this chain. Click on 'Add Template' to add a new template."),n.Rb(),n.Pb())}function z(t,e){if(1&t&&(n.Sb(0,"span"),n.Fc(1),n.Rb()),2&t){const t=n.ec().index;n.Bb(1),n.Gc(t+1)}}function J(t,e){1&t&&(n.Sb(0,"span"),n.Nb(1,"i",28),n.Rb())}function Y(t,e){1&t&&n.Nb(0,"i",38)}function W(t,e){if(1&t&&(n.Qb(0),n.Sb(1,"span",36),n.Fc(2),n.Rb(),n.Dc(3,Y,1,0,"i",37),n.Pb()),2&t){const t=e.$implicit,i=e.index,r=n.ec(2).$implicit;n.Bb(1),n.Eb("text-danger",t.name===r.error.data.templateName),n.Bb(1),n.Gc(t.name),n.Bb(1),n.kc("ngIf",i<r.error.data.chainOrder.length-1)}}function Z(t,e){if(1&t&&(n.Qb(0),n.Sb(1,"div",34),n.Dc(2,W,4,4,"ng-container",35),n.Rb(),n.Pb()),2&t){const t=n.ec().$implicit;n.Bb(2),n.kc("ngForOf",t.error.data.chainOrder)}}function tt(t,e){if(1&t&&(n.Sb(0,"div",30),n.Sb(1,"div",31),n.Nb(2,"i",28),n.Fc(3),n.Rb(),n.Qb(4,32),n.Dc(5,Z,3,1,"ng-container",33),n.Pb(),n.Rb()),2&t){const t=e.$implicit;n.Bb(3),n.Hc(" ",t.error.message,""),n.Bb(1),n.kc("ngSwitch",t.error.type),n.Bb(1),n.kc("ngSwitchCase","circularChain")}}function et(t,e){if(1&t&&(n.Sb(0,"div",19),n.Dc(1,tt,6,3,"div",29),n.Rb()),2&t){const t=n.ec().$implicit;n.Bb(1),n.kc("ngForOf",t.errors)}}const it=function(t,e){return{item:t,index:e}};function nt(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",14),n.Sb(1,"div",15),n.Sb(2,"div",16),n.Sb(3,"div",17),n.Dc(4,z,2,1,"span",8),n.Dc(5,J,2,0,"span",8),n.Rb(),n.Rb(),n.Sb(6,"div",18),n.Sb(7,"div",19),n.Sb(8,"div",20),n.Sb(9,"div",21),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=e.index;return n.ec(2).editCommand(i,r)})),n.Fc(10),n.Sb(11,"span",22),n.Fc(12),n.Rb(),n.Rb(),n.Sb(13,"div",23),n.Sb(14,"span",24),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=e.index;return n.ec(2).editCommand(i,r)})),n.Fc(15,"Edit"),n.Rb(),n.Sb(16,"mat-icon",25),n.Fc(17,"more_vert"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(18,"div",21),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=e.index;return n.ec(2).editCommand(i,r)})),n.Sb(19,"div",26),n.Fc(20,"Inputs:"),n.Rb(),n.Sb(21,"pre"),n.Fc(22),n.fc(23,"json"),n.Rb(),n.Rb(),n.Dc(24,et,2,1,"div",27),n.Rb(),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=e.index;n.ec(2);const r=n.pc(13);n.Bb(3),n.Eb("chain-command-error",t.errors.length>0),n.Bb(1),n.kc("ngIf",0===t.errors.length),n.Bb(1),n.kc("ngIf",t.errors.length>0),n.Bb(5),n.Hc("",null==t.item?null:t.item.name," "),n.Bb(2),n.Hc("[",null==t.item?null:t.item.parent.name,"]"),n.Bb(4),n.kc("matMenuTriggerFor",r)("matMenuTriggerData",n.nc(13,it,t,i))("inline",!0),n.Bb(6),n.Gc(n.gc(23,11,t.inputs)),n.Bb(2),n.kc("ngIf",t.errors.length>0)}}function rt(t,e){if(1&t&&(n.Qb(0),n.Dc(1,nt,25,16,"div",13),n.Pb()),2&t){const t=n.ec();n.Bb(1),n.kc("ngForOf",t.chainedTemplates)}}function ot(t,e){if(1&t){const t=n.Tb();n.Sb(0,"button",39),n.ac("click",(function(){n.sc(t);const i=e.index;return n.ec().addCommandBefore(i)})),n.Sb(1,"span"),n.Fc(2,"Add New Item Before"),n.Rb(),n.Rb(),n.Sb(3,"button",39),n.ac("click",(function(){n.sc(t);const i=e.index;return n.ec().addCommandAfter(i)})),n.Sb(4,"span"),n.Fc(5,"Add New Item After"),n.Rb(),n.Rb(),n.Sb(6,"button",39),n.ac("click",(function(){n.sc(t);const i=e.item;return n.ec().deleteCommand(i)})),n.Sb(7,"span"),n.Fc(8,"Delete Item"),n.Rb(),n.Rb()}}let st=(()=>{class t{constructor(t,e,i){this.templateService=t,this.bluService=e,this.dialog=i,this.errors=[],this.onConfigUpdated=new n.o,this.sectionErrors=[],this.chainedTemplates=[],this.subs=new o.a}ngOnInit(){this.bluService.getItems().subscribe(t=>{this.items=t,this.initCommands()})}initCommands(){var t;this.sectionErrors=this.getErrors(),this.chainedTemplates=(null!==(t=this.item.chainedTemplates)&&void 0!==t?t:[]).map(t=>{var e;const i=null===(e=this.items)||void 0===e?void 0:e.find(e=>e.id===t.templateId);return{templateId:t.templateId,inputs:t.inputs,item:i,errors:this.sectionErrors.filter(e=>e.error.data.templateId===t.templateId)}})}ngOnChanges(t){this.sectionErrors=this.getErrors(),this.initCommands()}ngOnDestroy(){this.subs.unsubscribe()}getErrors(){return this.errors.filter(t=>t.executeContext.item.id===this.item.id&&t.error.origin.location===r.a.Execute.ErrorLocation.config&&t.error.origin.section===r.a.Execute.ErrorSection.chainedTemplates)}configUpdated(){this.onConfigUpdated.emit(!0)}editCommand(t,e){this.openCommandDialog(t,"edit",e)}createCommand(){this.openCommandDialog(null,"create",-1)}deleteCommand(t){const e=this.item.chainedTemplates.findIndex(e=>e.templateId===t.templateId);e>=0&&(this.item.chainedTemplates.splice(e,1),this.saveConfig())}saveConfig(){this.subs.add(this.templateService.updateCommands(this.item.chainedTemplates,this.item.id).subscribe(t=>{this.initCommands(),this.configUpdated()}))}addCommandBefore(t){this.openCommandDialog(null,"create",t)}addCommandAfter(t){this.openCommandDialog(null,"create",t+1)}openCommandDialog(t,e,i){var n;const r=this.dialog.open(q,{data:{chainedTemplate:t?{templateId:t.templateId,inputs:t.inputs}:null,type:e,index:i,renderContext:this.renderContext,errors:null!==(n=null==t?void 0:t.errors)&&void 0!==n?n:[]},width:"600px",position:{top:"100px"},autoFocus:!0});this.subs.add(r.afterClosed().subscribe(t=>{"create"===t.type?(-1===i?this.item.chainedTemplates.push(t.chainedTemplate):this.item.chainedTemplates.splice(t.index,0,t.chainedTemplate),this.saveConfig()):"edit"===t.type&&(this.item.chainedTemplates.splice(t.index,1,t.chainedTemplate),this.saveConfig())}))}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(X.a),n.Mb(l.a),n.Mb(s.b))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-commands"]],inputs:{item:"item",renderContext:"renderContext",errors:"errors"},outputs:{onConfigUpdated:"onConfigUpdated"},features:[n.zb],decls:15,vars:3,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"fa","fa-list"],[1,"px-2"],[1,"position-relative","pt-2"],[1,"d-flex","align-items-start","pb-2"],[1,"ml-auto"],["mat-button","",3,"click"],[4,"ngIf"],[3,"overlapTrigger"],["commandMenu","matMenu"],["matMenuContent",""],[1,"p-2","text-center"],["class","border p-2 mb-2 chain-command rounded",4,"ngFor","ngForOf"],[1,"border","p-2","mb-2","chain-command","rounded"],[1,"d-flex","align-items-start"],[1,"pr-3","pl-1"],[1,"chain-index"],[1,"flex-grow-1"],[1,""],[1,"d-flex","align-items-end"],[1,"cursor-pointer",3,"click"],[1,"text-tiny","text-muted"],[1,"ml-auto","cursor-pointer"],[1,"mr-2",3,"click"],[1,"item-menu",3,"matMenuTriggerFor","matMenuTriggerData","inline"],[1,"text-muted","small"],["class","",4,"ngIf"],[1,"fa","fa-exclamation-triangle"],["class","pt-1",4,"ngFor","ngForOf"],[1,"pt-1"],[1,"text-danger","text-small"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"pl-4"],[4,"ngFor","ngForOf"],[1,"mr-1"],["class","fa fa-arrow-right mr-1 text-tiny",4,"ngIf"],[1,"fa","fa-arrow-right","mr-1","text-tiny"],["mat-menu-item","",3,"click"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Chained Templates"),n.Rb(),n.Rb(),n.Sb(4,"div",3),n.Sb(5,"div",4),n.Sb(6,"div",5),n.Sb(7,"div",6),n.Sb(8,"button",7),n.ac("click",(function(){return e.createCommand()})),n.Fc(9,"+ Add Template"),n.Rb(),n.Rb(),n.Rb(),n.Dc(10,Q,3,0,"ng-container",8),n.Dc(11,rt,2,1,"ng-container",8),n.Rb(),n.Rb(),n.Sb(12,"mat-menu",9,10),n.Dc(14,ot,9,0,"ng-template",11),n.Rb()),2&t&&(n.Bb(10),n.kc("ngIf",0===e.chainedTemplates.length),n.Bb(1),n.kc("ngIf",e.chainedTemplates.length>0),n.Bb(1),n.kc("overlapTrigger",!0))},directives:[D.b,u.t,g.e,g.a,u.s,v.a,g.d,u.x,u.y,g.b],pipes:[u.k],styles:[".chain-index[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff;font-weight:700;font-size:18px;border-radius:20px;padding:10px 15px}.chain-command[_ngcontent-%COMP%]{background-color:#f1f1f1}.chain-command-error[_ngcontent-%COMP%]{background-color:#dc3545!important}"]}),t})()},gpd5:function(t,e,i){"use strict";i.d(e,"a",(function(){return x}));var n=i("fXoL"),r=i("GV7L"),o=i("0IaG"),s=i("quSY"),c=i("M3NP"),a=i("3D92"),l=i("ofXK"),u=i("1jDz"),d=i("bTqV");function b(t,e){if(1&t&&(n.Sb(0,"div",10),n.Nb(1,"i",11),n.Fc(2),n.Rb()),2&t){const t=e.$implicit;n.Bb(2),n.Hc(" ",null!=t.error.data&&null!=t.error.data.syntaxError&&t.error.data.syntaxError.error?null==t.error.data||null==t.error.data.syntaxError?null:t.error.data.syntaxError.error:null==t.error.data?null:t.error.data.message," ")}}function m(t,e){if(1&t&&(n.Sb(0,"div",8),n.Dc(1,b,3,1,"div",9),n.Rb()),2&t){const t=n.ec();n.Bb(1),n.kc("ngForOf",t.errors)}}let f=(()=>{class t{constructor(t,e,i,n,r){this.data=t,this.bluEditorService=e,this.cdr=i,this.itemService=n,this.dialogRef=r,this.subs=new s.a,this.editorOptions={theme:"bluTheme",language:"bluLanguage",lineNumbers:"off",glyphMargin:!1,lineDecorationsWidth:"5px",renderLineHighlight:"none",folding:!1}}ngOnInit(){var t;this.errors=null!==(t=this.data.errors)&&void 0!==t?t:[],this.item=this.data.item,this.text=this.item.config.filenames,this.renderContext=this.data.renderContext,this.renderContext.inputs.basename="",this.renderContext.inputs.extname="",this.renderContext.inputs.filename=""}ngOnDestroy(){this.subs.unsubscribe(),this.bluEditorService.disposeCompletionProvider()}close(t){this.dialogRef.close({updated:t})}onEditorInit(t){this.editorModel=t,this.setContext()}setContext(){this.editorModel&&this.bluEditorService.registerCompletionProvider(monaco,this.renderContext)}save(){var t;this.editorModel.getValue(),this.item.config.filenames=(null!==(t=this.editorModel.getValue())&&void 0!==t?t:"").trim(),this.itemService.updateConfig(this.item.id,this.item.config).subscribe(t=>this.close(!0))}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(o.a),n.Mb(c.a),n.Mb(n.h),n.Mb(a.a),n.Mb(o.h))},t.\u0275cmp=n.Gb({type:t,selectors:[["edit-filenames-dialog"]],decls:15,vars:7,consts:[["mat-dialog-title",""],[1,"text-capitalize"],["mat-dialog-content","",2,"height","300px"],["class","py-2",4,"ngIf"],[1,"border","border-radius","p-2"],[3,"text","editorOptions","height","onEditorInit"],["mat-dialog-actions","",3,"align"],["mat-button","",3,"click"],[1,"py-2"],["class","text-danger small",4,"ngFor","ngForOf"],[1,"text-danger","small"],[1,"fa","fa-exclamation-triangle","text-danger","text-small"]],template:function(t,e){1&t&&(n.Sb(0,"h1",0),n.Sb(1,"span",1),n.Fc(2,"Edit Filenames for "),n.Rb(),n.Sb(3,"span",1),n.Fc(4),n.Rb(),n.Fc(5),n.Rb(),n.Sb(6,"div",2),n.Dc(7,m,2,1,"div",3),n.Sb(8,"div",4),n.Sb(9,"file-editor",5),n.ac("onEditorInit",(function(t){return e.onEditorInit(t)})),n.Rb(),n.Rb(),n.Rb(),n.Sb(10,"div",6),n.Sb(11,"button",7),n.ac("click",(function(){return e.close(!1)})),n.Fc(12,"Close"),n.Rb(),n.Sb(13,"button",7),n.ac("click",(function(){return e.save()})),n.Fc(14,"Save"),n.Rb(),n.Rb()),2&t&&(n.Bb(4),n.Gc(e.item.type),n.Bb(1),n.Hc(": ",e.item.name,""),n.Bb(2),n.kc("ngIf",e.errors.length>0),n.Bb(2),n.kc("text",e.text)("editorOptions",e.editorOptions)("height","40px"),n.Bb(1),n.kc("align","end"))},directives:[o.i,o.f,l.t,u.a,o.c,d.b,l.s],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px}"]}),t})();function p(t,e){1&t&&n.Nb(0,"i",19)}function h(t,e){if(1&t&&(n.Sb(0,"div",17),n.Fc(1),n.Dc(2,p,1,0,"i",18),n.Rb()),2&t){const t=n.ec().$implicit,e=n.ec();n.Eb("text-danger",e.filenameErrors[t.item.id]),n.Bb(1),n.Hc("",t.property," "),n.Bb(1),n.kc("ngIf",e.filenameErrors[t.item.id])}}function g(t,e){1&t&&(n.Sb(0,"div",17),n.Fc(1,"not set "),n.Sb(2,"span",20),n.Fc(3,"(click to edit)"),n.Rb(),n.Rb())}const v=function(t){return{"padding-left":t}};function S(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",6),n.Sb(1,"div",7),n.ac("click",(function(){n.sc(t);const i=e.$implicit;return n.ec().editProperty(i.item)})),n.Sb(2,"div",8),n.Sb(3,"div",9),n.Sb(4,"div",10),n.Nb(5,"i",11),n.Sb(6,"span",12),n.Fc(7),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(8,"div",13),n.Sb(9,"div",14),n.Dc(10,h,3,4,"div",15),n.Dc(11,g,4,0,"div",16),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=e.index;n.Bb(1),n.zc(n.mc(6,v,10*i+"px")),n.Bb(6),n.Ic("",t.item.type,": ",t.item.name,""),n.Bb(3),n.kc("ngIf",t.property),n.Bb(1),n.kc("ngIf",!t.property)}}let x=(()=>{class t{constructor(t){this.dialog=t,this.errors=[],this.onConfigUpdated=new n.o,this.property="filenames",this.hierarchy=[],this.filenameErrors={},this.subs=new s.a}ngOnInit(){this.selectedItem=this.item,this.setErrors(),this.determineHierarchy()}ngOnChanges(t){this.setErrors(),this.determineHierarchy()}determineHierarchy(){this.hierarchy=[];let t=this.item;if(t)for(this.setHierarchy(t);t.parent;)this.setHierarchy(t.parent),t=t.parent}setHierarchy(t){this.hierarchy.unshift({item:t,property:t.config[this.property]})}ngOnDestroy(){this.subs.unsubscribe()}editProperty(t){const e=this.dialog.open(f,{data:{item:t,renderContext:this.renderContext,errors:this.filenameErrors[""+t.id]},minWidth:"650px",position:{top:"100px"},autoFocus:!0});this.subs.add(e.afterClosed().subscribe(t=>{t.updated&&this.onConfigUpdated.emit(!0)}))}setErrors(){const t={};this.errors.forEach(e=>{var i,n;if((null===(i=e.error.origin)||void 0===i?void 0:i.location)===r.a.Execute.ErrorLocation.config&&(null===(n=e.error.origin)||void 0===n?void 0:n.section)===r.a.Execute.ErrorSection.filenames){const i=""+e.executeContext.item.id;t[i]||(t[i]=[]),t[i].push(e)}}),this.filenameErrors=t}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(o.b))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-filenames"]],inputs:{item:"item",errors:"errors",renderContext:"renderContext"},outputs:{onConfigUpdated:"onConfigUpdated"},features:[n.zb],decls:7,vars:1,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"far","fa-file"],[1,"p-2"],[1,"position-relative"],["class","cursor-pointer position-relative",4,"ngFor","ngForOf"],[1,"cursor-pointer","position-relative"],[1,"",3,"click"],[1,"py-2"],[1,"d-flex","align-items-center"],[1,"cursor-pointer"],[1,"fa","fa-chevron-right","text-tiny"],[1,"text-bold","mx-1"],[1,"pl-1","py-2","dashed-border",2,"margin","2px 0 0 2px"],[1,"p-1"],["class","",3,"text-danger",4,"ngIf"],["class","",4,"ngIf"],[1,""],["class","fa fa-exclamation-circle text-danger text-tiny",4,"ngIf"],[1,"fa","fa-exclamation-circle","text-danger","text-tiny"],[1,"text-tiny","text-muted"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Filenames"),n.Rb(),n.Rb(),n.Sb(4,"div",3),n.Sb(5,"div",4),n.Dc(6,S,12,8,"div",5),n.Rb(),n.Rb()),2&t&&(n.Bb(6),n.kc("ngForOf",e.hierarchy))},directives:[l.s,l.t],styles:[".dashed-border[_ngcontent-%COMP%]{border-left:1px dashed #b8b8b8}.config-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.config-item[_ngcontent-%COMP%]:hover   .item-menu-icon[_ngcontent-%COMP%]{display:block!important}"]}),t})()},iFtu:function(t,e,i){"use strict";i.d(e,"a",(function(){return S}));var n=i("fXoL"),r=i("GV7L"),o=i("XNiG"),s=i("quSY"),c=i("Kj3r"),a=i("/uUt"),l=i("3D92"),u=i("M3NP"),d=i("ofXK"),b=i("1jDz");function m(t,e){if(1&t&&(n.Sb(0,"div",9),n.Nb(1,"i",10),n.Fc(2),n.Rb()),2&t){const t=e.$implicit;n.Bb(2),n.Hc(" ",t.error.data.message,"")}}function f(t,e){if(1&t&&(n.Sb(0,"div",7),n.Dc(1,m,3,1,"div",8),n.Rb()),2&t){const t=n.ec();n.Bb(1),n.kc("ngForOf",t.sectionErrors)}}function p(t,e){if(1&t&&(n.Qb(0),n.Sb(1,"div",19),n.Fc(2,"Rendered onSuccess"),n.Rb(),n.Sb(3,"div",20),n.Sb(4,"pre"),n.Fc(5),n.Rb(),n.Rb(),n.Pb()),2&t){const t=n.ec(4);n.Bb(5),n.Gc(t.renderedOnSuccess)}}function h(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",14),n.Sb(1,"div",15),n.Sb(2,"file-editor",16),n.ac("onEditorInit",(function(e){return n.sc(t),n.ec(3).onEditorInit(e)})),n.Rb(),n.Rb(),n.Sb(3,"div",17),n.Sb(4,"div",18),n.Fc(5," Note: use "),n.Sb(6,"b"),n.Fc(7,"``"),n.Rb(),n.Fc(8," (back ticks) to allow text to be copied in the console "),n.Rb(),n.Sb(9,"div",18),n.Fc(10," Example: "),n.Sb(11,"b"),n.Fc(12,"`this text can be coped easily in the console`"),n.Rb(),n.Rb(),n.Rb(),n.Dc(13,p,6,1,"ng-container",11),n.Rb()}if(2&t){const t=n.ec(3);n.Bb(2),n.kc("text",t.onSuccessText)("editorOptions",t.editorOptions)("height","250px"),n.Bb(11),n.kc("ngIf",t.renderedOnSuccess)}}function g(t,e){if(1&t&&(n.Qb(0),n.Sb(1,"div",12),n.Dc(2,h,14,4,"div",13),n.Rb(),n.Pb()),2&t){const t=n.ec(2);n.Bb(2),n.kc("ngIf",t.selectedItem)}}function v(t,e){if(1&t&&(n.Qb(0),n.Dc(1,g,3,1,"ng-container",11),n.Pb()),2&t){const t=e.$implicit;n.Bb(1),n.kc("ngIf",void 0!==t.property)}}let S=(()=>{class t{constructor(t,e){this.itemService=t,this.bluEditorService=e,this.errors=[],this.onConfigUpdated=new n.o,this.property="onSuccess",this.hierarchy=[],this.sectionErrors=[],this.onSuccessText=null,this.editorOptions={theme:"bluTheme",language:"bluLanguage",lineNumbers:"off",glyphMargin:!1,lineDecorationsWidth:"5px",renderLineHighlight:"none",folding:!1},this.textToSave$=new o.a,this.subs=new s.a}ngOnInit(){this.determineHierarchy(),this.sectionErrors=this.getErrors(),this.editProperty(this.item),this.subs.add(this.textToSave$.pipe(Object(c.a)(250),Object(a.a)()).subscribe(t=>{this.selectedItem.config.onSuccess=t,this.saveForm()}))}ngOnChanges(t){this.sectionErrors=this.getErrors()}determineHierarchy(){this.hierarchy=[];let t=this.item;for(this.setHierarchy(t);t.parent;)this.setHierarchy(t.parent),t=t.parent}setHierarchy(t){this.hierarchy.unshift({item:t,property:t.config[this.property]})}ngOnDestroy(){this.subs.unsubscribe()}editProperty(t){setTimeout(()=>{this.onSuccessText=t.config.onSuccess,this.selectedItem=t},20)}saveForm(){this.subs.add(this.itemService.updateConfig(this.selectedItem.id,this.selectedItem.config).subscribe(t=>this.onConfigUpdated.emit(!0)))}getErrors(){const t=[];return this.hierarchy.forEach(e=>{const i=this.errors.filter(t=>t.executeContext.item.id===e.item.id&&t.error.origin.location===r.a.Execute.ErrorLocation.config&&t.error.origin.section===r.a.Execute.ErrorSection.onSuccess);t.push(...i)}),t}onEditorInit(t){this.editorModel=t,this.setContext(),this.editorModel.onDidChangeContent(t=>{this.textToSave$.next(this.editorModel.getValue())})}setContext(){this.editorModel&&this.bluEditorService.registerCompletionProvider(monaco,this.renderContext)}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(l.a),n.Mb(u.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-on-success"]],inputs:{item:"item",renderContext:"renderContext",renderedOnSuccess:"renderedOnSuccess",errors:"errors"},outputs:{onConfigUpdated:"onConfigUpdated"},features:[n.zb],decls:8,vars:2,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"fa","fa-check"],[1,"p-2"],["class","pb-2",4,"ngIf"],[1,"position-relative"],[4,"ngFor","ngForOf"],[1,"pb-2"],["class","text-danger text-small",4,"ngFor","ngForOf"],[1,"text-danger","text-small"],[1,"fa","fa-exclamation-triangle"],[4,"ngIf"],[1,"pb-2","cursor-pointer","position-relative"],["class","pl-2 pt-1",4,"ngIf"],[1,"pl-2","pt-1"],[1,"border","border-radius","p-1"],[3,"text","editorOptions","height","onEditorInit"],[1,"py-1","text-small","text-muted"],[1,"pl-1"],[1,"pt-3","pb-1","border-bottom"],[1,"pt-2"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," On Success"),n.Rb(),n.Rb(),n.Sb(4,"div",3),n.Dc(5,f,2,1,"div",4),n.Sb(6,"div",5),n.Dc(7,v,2,1,"ng-container",6),n.Rb(),n.Rb()),2&t&&(n.Bb(5),n.kc("ngIf",e.sectionErrors.length>0),n.Bb(2),n.kc("ngForOf",e.hierarchy))},directives:[d.t,d.s,b.a],styles:[""]}),t})()},kjm3:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("fXoL");let r=(()=>{class t{constructor(){}ngOnInit(){}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Gb({type:t,selectors:[["config-links"]],decls:5,vars:0,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"fa","fa-link"],[1,"p-2"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Links"),n.Rb(),n.Rb(),n.Nb(4,"div",3))},styles:[""]}),t})()},lsM1:function(t,e,i){"use strict";i.d(e,"a",(function(){return C}));var n=i("fXoL"),r=i("GV7L"),o=i("DdQb"),s=i("quSY"),c=i("Mzu6"),a=i("0IaG"),l=i("3D92"),u=i("ofXK"),d=i("STbY"),b=i("NFeN");function m(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",20),n.ac("click",(function(){n.sc(t);const e=n.ec().$implicit;return n.ec().createNewVariable(e.item)})),n.Fc(1,"No variables present (click to add)"),n.Rb()}}function f(t,e){1&t&&n.Nb(0,"i",28)}const p=function(t,e){return{item:t,variable:e}};function h(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",22),n.Sb(1,"div",23),n.Sb(2,"mat-icon",24),n.Fc(3,"more_vert"),n.Rb(),n.Rb(),n.Sb(4,"div",25),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=n.ec(2).$implicit;return n.ec().editVariable(r.item,i)})),n.Fc(5),n.Dc(6,f,1,0,"i",26),n.Rb(),n.Sb(7,"div",27),n.ac("click",(function(){n.sc(t);const i=e.$implicit,r=n.ec(2).$implicit;return n.ec().editVariable(r.item,i)})),n.Fc(8),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=n.ec(2).$implicit,r=n.ec(),o=n.pc(8);n.Bb(2),n.kc("inline",!0)("matMenuTriggerFor",o)("matMenuTriggerData",n.nc(8,p,i.item,t)),n.Bb(2),n.Eb("text-danger",r.variableErrors[i.item.id+"."+t.key]),n.Bb(1),n.Hc(" ",t.key," "),n.Bb(1),n.kc("ngIf",r.variableErrors[i.item.id+"."+t.key]),n.Bb(2),n.Gc(t.value)}}function g(t,e){if(1&t&&(n.Sb(0,"div",10),n.Dc(1,h,9,11,"div",21),n.Rb()),2&t){const t=n.ec().$implicit;n.Bb(1),n.kc("ngForOf",t.list)}}const v=function(t){return{"padding-left":t}};function S(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",9),n.Sb(1,"div",10),n.Sb(2,"div",11),n.Sb(3,"div",12),n.Sb(4,"div",13),n.ac("click",(function(){n.sc(t);const i=e.$implicit;return n.ec().createNewVariable(i.item)})),n.Nb(5,"i",14),n.Sb(6,"span",15),n.Fc(7),n.Rb(),n.Nb(8,"i",16),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"div",17),n.Dc(10,m,2,0,"div",18),n.Dc(11,g,2,1,"div",19),n.Rb(),n.Rb(),n.Rb()}if(2&t){const t=e.$implicit,i=e.index;n.Bb(1),n.zc(n.mc(6,v,10*i+"px")),n.Bb(6),n.Ic("",t.item.type,": ",t.item.name,""),n.Bb(3),n.kc("ngIf",0===t.list.length),n.Bb(1),n.kc("ngIf",t.list.length>0)}}function x(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",29),n.Sb(1,"span",30),n.Fc(2,"Variable: "),n.Rb(),n.Sb(3,"span",31),n.Fc(4),n.Rb(),n.Rb(),n.Sb(5,"button",32),n.ac("click",(function(){n.sc(t);const i=e.item,r=e.variable;return n.ec().duplicateVariable(i,r)})),n.Nb(6,"i",33),n.Fc(7," Duplicate"),n.Rb(),n.Sb(8,"button",32),n.ac("click",(function(){n.sc(t);const i=e.item,r=e.variable;return n.ec().deleteVariable(i,r)})),n.Nb(9,"i",34),n.Fc(10," Delete"),n.Rb()}if(2&t){const t=e.variable;n.Bb(4),n.Gc(t.key)}}let C=(()=>{class t{constructor(t,e){this.dialog=t,this.itemService=e,this.errors=[],this.onConfigUpdated=new n.o,this.variableErrors={},this.hierarchy=[],this.subs=new s.a}ngOnInit(){this.setErrors(),this.determineHierarchy()}ngOnChanges(t){this.setErrors(),this.determineHierarchy()}determineHierarchy(){this.hierarchy=[];let t=this.item;if(t)for(this.setHierarchy(t);t.parent;)this.setHierarchy(t.parent),t=t.parent}setHierarchy(t){this.hierarchy.unshift({item:t,variables:t.variables,list:this.getListOfVariables(t.variables)})}getListOfVariables(t){return Object.keys(null!=t?t:{}).map(e=>({key:e,value:t[e]})).sort((t,e)=>t.key>e.key?1:-1)}ngOnDestroy(){this.subs.unsubscribe()}setErrors(){const t={};this.errors.forEach(e=>{var i,n;if((null===(i=e.error.origin)||void 0===i?void 0:i.location)===r.a.Execute.ErrorLocation.config&&(null===(n=e.error.origin)||void 0===n?void 0:n.section)===r.a.Execute.ErrorSection.variables){const i=`${e.executeContext.item.id}.${e.error.origin.property}`;t[i]||(t[i]=[]),t[i].push(e)}}),this.variableErrors=t}configUpdated(){this.onConfigUpdated.emit(!0)}createNewVariable(t){this.editVariable(t,{key:"",value:""})}editVariable(t,e){const i=this.dialog.open(o.a,{data:{item:t,renderContext:this.renderContext,variable:e,errors:this.variableErrors[`${t.id}.${e.key}`]},minWidth:"650px",position:{top:"100px"},autoFocus:!0});this.subs.add(i.afterClosed().subscribe(t=>{this.determineHierarchy(),this.configUpdated()}))}duplicateVariable(t,e){let i=e.key+"_copy";this.item.variables[i]&&(i+="_"+(Math.floor(1e3*Math.random())+1)),this.item.variables[i]=e.value,this.itemService.updateVariables(this.item.id,this.item.variables).subscribe(t=>{this.determineHierarchy(),this.configUpdated()})}deleteVariable(t,e){this.dialog.open(c.a,{data:{title:`Delete variable ${e.key}?`,text:"Deleting this variable is a permanent action and cannot be undone.",button:{yes:"Delete",no:"Cancel"}},position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(t=>{!0===t&&(delete this.item.variables[e.key],this.itemService.updateVariables(this.item.id,this.item.variables).subscribe(t=>{this.determineHierarchy(),this.configUpdated()}))})}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(a.b),n.Mb(l.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-variables"]],inputs:{item:"item",renderContext:"renderContext",errors:"errors"},outputs:{onConfigUpdated:"onConfigUpdated"},features:[n.zb],decls:10,vars:1,consts:[[1,"border-bottom"],[1,"p-1","pl-2"],[1,"fa","fa-equals"],[1,"p-2"],[1,"position-relative"],["class","cursor-pointer position-relative",4,"ngFor","ngForOf"],["yPosition","below"],["functionMenu","matMenu"],["matMenuContent",""],[1,"cursor-pointer","position-relative"],[1,""],[1,"py-2"],[1,"d-flex","align-items-center"],[1,"cursor-pointer",3,"click"],[1,"fa","fa-chevron-right","text-tiny"],[1,"text-bold","mx-1"],[1,"fa","fa-plus-square","text-tiny","font-weight-normal"],[1,"pl-1","py-2","dashed-border",2,"margin","2px 0 0 2px"],["class","text-muted text-tiny cursor-pointer config-item pl-2",3,"click",4,"ngIf"],["class","",4,"ngIf"],[1,"text-muted","text-tiny","cursor-pointer","config-item","pl-2",3,"click"],["class","d-flex align-items-center config-item",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","config-item"],[1,"item-menu"],[1,"item-menu-icon",3,"inline","matMenuTriggerFor","matMenuTriggerData"],[1,"cursor-pointer","item-name",3,"click"],["class","fa fa-exclamation-circle text-danger text-tiny",4,"ngIf"],[1,"text-muted",3,"click"],[1,"fa","fa-exclamation-circle","text-danger","text-tiny"],[1,"p-2","text-center","border-bottom"],[1,"text-capitalize"],[1,"text-bold"],["mat-menu-item","",3,"click"],[1,"far","fa-copy"],[1,"far","fa-trash-alt"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Variables"),n.Rb(),n.Rb(),n.Sb(4,"div",3),n.Sb(5,"div",4),n.Dc(6,S,12,8,"div",5),n.Rb(),n.Rb(),n.Sb(7,"mat-menu",6,7),n.Dc(9,x,11,1,"ng-template",8),n.Rb()),2&t&&(n.Bb(6),n.kc("ngForOf",e.hierarchy))},directives:[u.s,d.e,d.a,u.t,b.a,d.d,d.b],styles:[".dashed-border[_ngcontent-%COMP%]{border-left:1px dashed #b8b8b8}.config-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.config-item[_ngcontent-%COMP%]:hover   .item-menu-icon[_ngcontent-%COMP%]{display:block!important}.item-menu[_ngcontent-%COMP%]{width:20px;text-align:center}.item-menu[_ngcontent-%COMP%]   .item-menu-icon[_ngcontent-%COMP%]{display:none}.item-name[_ngcontent-%COMP%]{width:250px}.item-description[_ngcontent-%COMP%], .item-name[_ngcontent-%COMP%]{text-overflow:ellipsis}"]}),t})()},nC7K:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("ofXK"),r=i("bTqV"),o=i("NFeN"),s=i("STbY"),c=i("fXoL");let a=(()=>{class t{}return t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,r.c,o.b,s.c]]}),t})()},pr2P:function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var n=i("fXoL"),r=i("XNiG"),o=i("quSY"),s=i("Kj3r"),c=i("/uUt"),a=i("3D92"),l=i("ofXK"),u=i("lR5k"),d=i("1jDz");function b(t,e){if(1&t){const t=n.Tb();n.Sb(0,"span",9),n.ac("click",(function(){return n.sc(t),n.ec().showSection("edit")})),n.Fc(1,"[ edit ]"),n.Rb()}if(2&t){const t=n.ec();n.Eb("text-primary","edit"===t.section)}}function m(t,e){if(1&t){const t=n.Tb();n.Sb(0,"span",10),n.ac("click",(function(){return n.sc(t),n.ec().showSection("preview")})),n.Fc(1,"[ preview ]"),n.Rb()}if(2&t){const t=n.ec();n.Eb("text-primary","preview"===t.section)}}function f(t,e){if(1&t){const t=n.Tb();n.Qb(0),n.Sb(1,"div",13),n.ac("click",(function(){return n.sc(t),n.ec(2).showSection("edit")})),n.Sb(2,"span",14),n.Fc(3,"No Readme Available. Click to edit."),n.Rb(),n.Rb(),n.Pb()}}function p(t,e){if(1&t&&(n.Qb(0),n.Nb(1,"markdown",15),n.Pb()),2&t){const t=n.ec(2);n.Bb(1),n.kc("data",t.text)}}function h(t,e){if(1&t&&(n.Sb(0,"div",11),n.Dc(1,f,4,0,"ng-container",12),n.Dc(2,p,2,1,"ng-container",12),n.Rb()),2&t){const t=n.ec();n.Bb(1),n.kc("ngIf",!t.text),n.Bb(1),n.kc("ngIf",!!t.text)}}function g(t,e){if(1&t){const t=n.Tb();n.Sb(0,"div",16),n.Sb(1,"file-editor",17),n.ac("onContentChange",(function(e){return n.sc(t),n.ec().updateReadme(e)})),n.Rb(),n.Rb()}if(2&t){const t=n.ec();n.Bb(1),n.kc("text",t.text)("editorOptions",t.editorOptions)("height","100%")}}let v=(()=>{class t{constructor(t){this.itemService=t,this.textToSave$=new r.a,this.onConfigUpdated=new n.o,this.editorOptions={language:"markdown",matchBrackets:"never",lineNumbers:"off",glyphMargin:!1,lineDecorationsWidth:"5px",renderLineHighlight:"none",folding:!1},this.section="preview",this.subs=new o.a}ngOnInit(){this.showSection("preview"),this.text=this.item.readme,this.subs.add(this.textToSave$.pipe(Object(s.a)(250),Object(c.a)()).subscribe(t=>{this.item.readme=t,this.saveForm()}))}showSection(t){this.text=this.item.readme,"preview"===t&&(this.markdownHTML=this.item.readme),this.section=t}ngOnDestroy(){this.subs.unsubscribe()}saveForm(){this.subs.add(this.itemService.updateReadme(this.item.id,this.item.readme).subscribe(t=>this.onConfigUpdated.emit(!0)))}updateReadme(t){this.textToSave$.next(t)}}return t.\u0275fac=function(e){return new(e||t)(n.Mb(a.a))},t.\u0275cmp=n.Gb({type:t,selectors:[["config-info"]],inputs:{item:"item"},outputs:{onConfigUpdated:"onConfigUpdated"},decls:10,vars:4,consts:[[1,"border-bottom","d-flex"],[1,"pl-2"],[1,"fab","fa-readme"],[1,"cursor-pointer","pl-2"],["class","",3,"text-primary","click",4,"ngIf"],[3,"text-primary","click",4,"ngIf"],[1,"p-2"],["class","",4,"ngIf"],["class","p-2 border","style","height:500px",4,"ngIf"],[1,"",3,"click"],[3,"click"],[1,""],[4,"ngIf"],[1,"text-center",3,"click"],[1,"border-bottom","cursor-pointer"],[3,"data"],[1,"p-2","border",2,"height","500px"],[3,"text","editorOptions","height","onContentChange"]],template:function(t,e){1&t&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"i",2),n.Fc(3," Readme"),n.Rb(),n.Sb(4,"div",3),n.Dc(5,b,2,2,"span",4),n.Dc(6,m,2,2,"span",5),n.Rb(),n.Rb(),n.Sb(7,"div",6),n.Dc(8,h,3,2,"div",7),n.Dc(9,g,2,3,"div",8),n.Rb()),2&t&&(n.Bb(5),n.kc("ngIf","preview"===e.section),n.Bb(1),n.kc("ngIf","edit"===e.section),n.Bb(2),n.kc("ngIf","preview"===e.section),n.Bb(1),n.kc("ngIf","edit"===e.section))},directives:[l.t,u.a,d.a],styles:[""]}),t})()},vabg:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i("ofXK"),r=i("fXoL");let o=(()=>{class t{}return t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c]]}),t})()},yjV7:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("ofXK"),r=i("xyCH"),o=i("fXoL");let s=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,r.a]]}),t})()}}]);