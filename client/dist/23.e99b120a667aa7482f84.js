(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{uiGw:function(i,t,e){"use strict";e.r(t),e.d(t,"LoginModule",(function(){return P}));var n=e("ofXK"),o=e("tyNb"),r=e("quSY"),c=e("aSHc"),a=e("eIep"),s=e("fXoL"),b=e("biaL"),d=e("yUjA"),l=e("xm+p"),u=e("5yAa"),g=e("3sFK"),m=e("Wp6s"),v=e("bTqV"),p=e("3Pt+"),h=e("kmnG"),f=e("qFsG"),S=e("bv9b");function w(i,t){if(1&i){const i=s.Sb();s.Rb(0,"mat-card"),s.Rb(1,"div",2),s.Ec(2,"You are logged in as: "),s.Rb(3,"b"),s.Ec(4),s.Qb(),s.Qb(),s.Rb(5,"div",3),s.Rb(6,"button",4),s.Zb("click",(function(){return s.rc(i),s.dc().logout()})),s.Ec(7,"Log Out"),s.Qb(),s.Qb(),s.Qb()}if(2&i){const i=s.dc();s.Ab(4),s.Fc(i.user.email)}}function Q(i,t){if(1&i&&(s.Rb(0,"div",16),s.Ec(1),s.Qb()),2&i){const i=s.dc(2);s.Ab(1),s.Fc(i.loginForm.error)}}function R(i,t){1&i&&(s.Rb(0,"button",17),s.Ec(1,"Sign In"),s.Qb())}function E(i,t){1&i&&(s.Rb(0,"div"),s.Rb(1,"div",2),s.Mb(2,"mat-progress-bar",18),s.Qb(),s.Qb())}function C(i,t){if(1&i&&(s.Rb(0,"div",5),s.Mb(1,"i",23),s.Ec(2," User "),s.Rb(3,"span",6),s.Ec(4),s.Qb(),s.Ec(5," not found"),s.Qb()),2&i){const i=s.dc(3);s.Ab(4),s.Fc(i.loginForm.email)}}function I(i,t){1&i&&(s.Rb(0,"div",5),s.Mb(1,"i",23),s.Ec(2," Too many login requests. Please wait before trying again."),s.Qb())}function F(i,t){if(1&i){const i=s.Sb();s.Rb(0,"div",5),s.Rb(1,"div",5),s.Mb(2,"i",23),s.Ec(3," Incorrect password."),s.Qb(),s.Rb(4,"div",24),s.Zb("click",(function(){return s.rc(i),s.dc(3).forgotPassword()})),s.Ec(5,"(Click here to reset password)"),s.Qb(),s.Qb()}}function y(i,t){if(1&i&&(s.Rb(0,"div",5),s.Rb(1,"div",5),s.Mb(2,"i",23),s.Rb(3,"span",25),s.Ec(4),s.Qb(),s.Ec(5," is not a valid email"),s.Qb(),s.Qb()),2&i){const i=s.dc(3);s.Ab(4),s.Fc(i.loginForm.email)}}function A(i,t){1&i&&(s.Rb(0,"div",5),s.Mb(1,"i",23),s.Ec(2," Error Occurred."),s.Qb())}function k(i,t){if(1&i&&(s.Rb(0,"div",19),s.Pb(1,20),s.Cc(2,C,6,1,"div",21),s.Cc(3,I,3,0,"div",21),s.Cc(4,F,6,0,"div",21),s.Cc(5,y,6,1,"div",21),s.Cc(6,A,3,0,"div",22),s.Ob(),s.Qb()),2&i){const i=s.dc(2);s.Ab(1),s.jc("ngSwitch",i.errorCode),s.Ab(1),s.jc("ngSwitchCase","auth/user-not-found"),s.Ab(1),s.jc("ngSwitchCase","auth/too-many-requests"),s.Ab(1),s.jc("ngSwitchCase","auth/wrong-password"),s.Ab(1),s.jc("ngSwitchCase","Invalid value")}}function j(i,t){if(1&i){const i=s.Sb();s.Rb(0,"mat-card"),s.Rb(1,"div",2),s.Rb(2,"div",5),s.Rb(3,"div",6),s.Ec(4,"Sign In:"),s.Qb(),s.Rb(5,"div",2),s.Rb(6,"form",7),s.Zb("ngSubmit",(function(){return s.rc(i),s.dc().login()})),s.Rb(7,"div",5),s.Rb(8,"mat-form-field"),s.Rb(9,"mat-label"),s.Ec(10,"Email"),s.Qb(),s.Rb(11,"input",8),s.Zb("ngModelChange",(function(t){return s.rc(i),s.dc().loginForm.email=t})),s.Qb(),s.Qb(),s.Qb(),s.Rb(12,"div",5),s.Rb(13,"mat-form-field"),s.Rb(14,"mat-label"),s.Ec(15,"Password"),s.Qb(),s.Rb(16,"input",9),s.Zb("ngModelChange",(function(t){return s.rc(i),s.dc().loginForm.password=t})),s.Qb(),s.Qb(),s.Qb(),s.Cc(17,Q,2,1,"div",10),s.Cc(18,R,2,0,"button",11),s.Cc(19,E,3,0,"div",1),s.Qb(),s.Cc(20,k,7,5,"div",12),s.Qb(),s.Qb(),s.Rb(21,"div",13),s.Rb(22,"div",14),s.Zb("click",(function(){return s.rc(i),s.dc().forgotPassword()})),s.Ec(23,"Forgot Password"),s.Qb(),s.Rb(24,"div",15),s.Zb("click",(function(){return s.rc(i),s.dc().createAccount()})),s.Ec(25,"Create Account"),s.Qb(),s.Qb(),s.Qb(),s.Qb()}if(2&i){const i=s.dc();s.Ab(11),s.jc("ngModel",i.loginForm.email)("disabled",i.loginForm.disabled),s.Ab(5),s.jc("ngModel",i.loginForm.password)("disabled",i.loginForm.disabled),s.Ab(1),s.jc("ngIf",""!==i.loginForm.error),s.Ab(1),s.jc("ngIf",i.currentState!==i.actionState.PENDING),s.Ab(1),s.jc("ngIf",i.currentState===i.actionState.PENDING),s.Ab(1),s.jc("ngIf",i.currentState===i.actionState.FAILED)}}const x=o.f.forChild([{path:"",component:(()=>{class i{constructor(i,t,e,n,o,a){this.userService=i,this.authService=t,this.route=e,this.navigationService=n,this.appInitService=o,this.appEnvironmentService=a,this.loginForm={email:"",password:"",error:"",disabled:!1},this.subs=new r.a,this.currentState=c.a.IDLE,this.actionState=c.a}ngOnInit(){var i;this.loginForm.email=null!==(i=this.route.snapshot.queryParams.email)&&void 0!==i?i:"",this.subs.add(this.userService.user$.subscribe(i=>this.user=i)),this.subs.add(this.appEnvironmentService.currentEnvironment$.subscribe(i=>this.appEnvironment=i))}ngOnDestroy(){this.subs.unsubscribe()}createAccount(){const i={};this.loginForm.email&&(i.email=this.loginForm.email),this.navigationService.navigateTo(["create-account"],{queryParams:i})}forgotPassword(){const i={};this.loginForm.email&&(i.email=this.loginForm.email),this.navigationService.navigateTo(["forgot-password"],{queryParams:i})}login(){this.currentState=c.a.PENDING,this.authService.login(this.loginForm.email,this.loginForm.password).toPromise().then(()=>{this.currentState=c.a.SUCCESS,this.appEnvironment?this.navigationService.navigateTo(["my-items"]):this.appInitService.openNoEnvironmentDialog()}).catch(i=>{var t,e,n,o,r,a;this.currentState=c.a.FAILED,this.error=i.error,this.errorCode=null!==(a=null!==(n=null===(e=null===(t=null==i?void 0:i.error)||void 0===t?void 0:t.data)||void 0===e?void 0:e.code)&&void 0!==n?n:null===(r=null===(o=null==i?void 0:i.error)||void 0===o?void 0:o.message[0])||void 0===r?void 0:r.msg)&&void 0!==a?a:"unknown_error",console.log("Login error Code: ",this.errorCode)})}logout(){this.authService.logout().pipe(Object(a.a)(i=>this.appEnvironmentService.switchToSystemWorkspace())).subscribe(i=>this.navigationService.navigateTo(["workspace"]))}}return i.\u0275fac=function(t){return new(t||i)(s.Lb(b.a),s.Lb(d.a),s.Lb(o.a),s.Lb(l.a),s.Lb(u.a),s.Lb(g.a))},i.\u0275cmp=s.Fb({type:i,selectors:[["login"]],decls:3,vars:2,consts:[[1,"d-flex","justify-content-center","pt-4"],[4,"ngIf"],[1,"p-2"],[1,"p-2","text-center"],["mat-raised-button","",3,"click"],[1,""],[1,"text-bold"],[1,"form",3,"ngSubmit"],["matInput","","placeholder","Email","type","email","name","email","required","",3,"ngModel","disabled","ngModelChange"],["matInput","","placeholder","Password","type","password","name","password","required","",3,"ngModel","disabled","ngModelChange"],["class","error",4,"ngIf"],["mat-raised-button","","type","submit",4,"ngIf"],["class","pt-4 text-break","style","width: 250px;",4,"ngIf"],[1,"d-flex","p-2","pt-4"],[1,"cursor-pointer",3,"click"],[1,"cursor-pointer","ml-auto","pl-4",3,"click"],[1,"error"],["mat-raised-button","","type","submit"],["mode","indeterminate"],[1,"pt-4","text-break",2,"width","250px"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],["class","",4,"ngSwitchDefault"],[1,"fa","fa-exclamation-triangle","text-warning"],[1,"text-small","as-link","pt-1","cursor-pointer",3,"click"],[1,"text-bold","ml-1"]],template:function(i,t){1&i&&(s.Rb(0,"div",0),s.Cc(1,w,8,1,"mat-card",1),s.Cc(2,j,26,8,"mat-card",1),s.Qb()),2&i&&(s.Ab(1),s.jc("ngIf",t.user.isLoggedIn),s.Ab(1),s.jc("ngIf",!t.user.isLoggedIn))},directives:[n.t,m.a,v.b,p.H,p.s,p.t,h.c,h.g,f.a,p.c,p.C,p.r,p.u,S.a,n.x,n.y,n.z],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;flex:1}"]}),i})(),children:[]}]);let P=(()=>{class i{}return i.\u0275mod=s.Jb({type:i}),i.\u0275inj=s.Ib({factory:function(t){return new(t||i)},providers:[],imports:[[n.c,x,v.c,p.m,f.b,m.d,S.b]]}),i})()}}]);