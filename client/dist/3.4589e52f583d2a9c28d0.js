(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"40nA":function(e,i,t){"use strict";t.d(i,"a",(function(){return l}));var n=t("fXoL"),s=t("N4Rb"),r=t("3sFK"),o=t("xm+p"),c=t("0IaG"),a=t("ofXK"),u=t("bTqV");function m(e,i){if(1&e){const e=n.Sb();n.Rb(0,"tr"),n.Rb(1,"td",2),n.Rb(2,"div",2),n.Ec(3),n.Qb(),n.Rb(4,"div",9),n.Ec(5),n.Qb(),n.Qb(),n.Rb(6,"td"),n.Rb(7,"button",10),n.Zb("click",(function(){n.rc(e);const i=n.dc().$implicit;return n.dc(2).selectWorkspace(i)})),n.Ec(8,"Select"),n.Qb(),n.Qb(),n.Qb()}if(2&e){const e=n.dc().$implicit;n.Ab(3),n.Gc(" ",e.name,""),n.Ab(2),n.Fc(e.codebasePath)}}function d(e,i){if(1&e&&(n.Pb(0),n.Cc(1,m,9,2,"tr",8),n.Ob()),2&e){const e=i.$implicit;n.Ab(1),n.jc("ngIf",!e.remoteOnly)}}function b(e,i){if(1&e&&(n.Rb(0,"table",4),n.Rb(1,"tr",5),n.Rb(2,"th",6),n.Ec(3,"My Workspaces"),n.Qb(),n.Qb(),n.Cc(4,d,2,1,"ng-container",7),n.Qb()),2&e){const e=n.dc();n.Ab(4),n.jc("ngForOf",e.workspaces)}}let l=(()=>{class e{constructor(e,i,t,n){this.workspaceService=e,this.appEnvironmentService=i,this.navigationService=t,this.dialogRef=n}ngOnInit(){this.getWorkspaces()}selectWorkspace(e){this.appEnvironmentService.switchToEnvironment(e.id).subscribe(()=>{this.navigationService.navigateTo(["workspace"]),this.dialogRef.close()})}getWorkspaces(){this.workspaceService.userWorkspaces().subscribe(e=>{this.workspaces=e.sort((e,i)=>{var t,n;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())>(null===(n=i.name)||void 0===n?void 0:n.toLowerCase())?1:-1})})}ngOnDestroy(){}close(){this.dialogRef.close(this.form.value)}}return e.\u0275fac=function(i){return new(i||e)(n.Lb(s.a),n.Lb(r.a),n.Lb(o.a),n.Lb(c.h))},e.\u0275cmp=n.Fb({type:e,selectors:[["select-environment-dialog"]],decls:5,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,""],["class","table",4,"ngIf"],[1,"table"],[1,"border-top-0"],[1,"text-capitalize","border-top-0"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"codebase-path","text-muted"],["mat-raised-button","",3,"click"]],template:function(e,i){1&e&&(n.Rb(0,"h1",0),n.Ec(1,"Select Workspace"),n.Qb(),n.Rb(2,"div",1),n.Rb(3,"div",2),n.Cc(4,b,5,1,"table",3),n.Qb(),n.Qb()),2&e&&(n.Ab(4),n.jc("ngIf",(null==i.workspaces?null:i.workspaces.length)>0))},directives:[c.i,c.f,a.t,a.s,u.b],styles:[".mat-form-field[_ngcontent-%COMP%], .mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px}"]}),e})()},"7n/8":function(e,i,t){"use strict";t.d(i,"a",(function(){return d}));var n=t("ofXK"),s=t("bTqV"),r=t("0IaG"),o=t("qFsG"),c=t("QibW"),a=t("d3UM"),u=t("3Pt+"),m=t("fXoL");let d=(()=>{class e{}return e.\u0275mod=m.Jb({type:e}),e.\u0275inj=m.Ib({factory:function(i){return new(i||e)},providers:[],imports:[[n.c,r.g,o.b,u.m,s.c,c.c,u.B,a.b]]}),e})()},A4A1:function(e,i,t){"use strict";var n;Object.defineProperty(i,"__esModule",{value:!0}),i.HttpError=void 0,(n=i.HttpError||(i.HttpError={})).UNKNOWN="unknown",n.UNAUTHORIZED="unauthorized",n.PARAMS_MISSING="parameters-missing",n.INVALID_ENVIRONMENT="invalid-environment",n.INVALID_PARAMETERS="invalid-parameters",n.BAD_REQUEST="bad-request",n.INVALID_PATH="invalid-path",n.USER_NOT_FOUND="user-not-found",n.VIOLATES_MINIMUM_REQUIREMENTS="violates-minimum-requirements",n.FORBIDDEN="forbidden",n.ENVIRONMENT_NAME_IN_USE="stack/creation/name-in-use",n.ORG_CREATION_NAME_IN_USE="org/creation/name-in-use",n.ORG_CREATION_PREFIX_IN_USE="org/creation/prefix-in-use",n.ORG_DELETION_STILL_IN_USE="org/deletion/still-in-use"},O2It:function(e,i,t){"use strict";t.d(i,"a",(function(){return O}));var n=t("fXoL"),s=t("EICP"),r=t("quSY"),o=t("ofXK"),c=t("d3UM"),a=t("FKr1"),u=t("bv9b"),m=t("bTqV");function d(e,i){if(1&e&&(n.Rb(0,"mat-option",8),n.Ec(1),n.ec(2,"titlecase"),n.Qb()),2&e){const e=i.$implicit;n.jc("value",e.value),n.Ab(1),n.Gc(" ",n.fc(2,2,e.key)," ")}}function b(e,i){if(1&e){const e=n.Sb();n.Rb(0,"div"),n.Rb(1,"mat-select",6),n.Zb("valueChange",(function(i){n.rc(e);const t=n.dc(2).$implicit;return n.dc().dirtyEnvPermissions[t.uid].permission=i})),n.Cc(2,d,3,4,"mat-option",7),n.ec(3,"keyvalue"),n.Qb(),n.Qb()}if(2&e){const e=n.dc(2).$implicit,i=n.dc();n.Ab(1),n.jc("value",i.dirtyEnvPermissions[e.uid].permission),n.Ab(1),n.jc("ngForOf",n.gc(3,2,i.permissionMap,i.originalOrder))}}function l(e,i){if(1&e&&(n.Pb(0),n.Ec(1),n.ec(2,"titlecase"),n.Ob()),2&e){const e=n.dc(2).$implicit,i=n.dc();n.Ab(1),n.Gc(" ",n.fc(2,1,i.convertPermissionToString(i.dirtyEnvPermissions[e.uid].permission))," ")}}function p(e,i){1&e&&(n.Pb(0),n.Mb(1,"mat-progress-bar",9),n.Ob())}function v(e,i){if(1&e){const e=n.Sb();n.Rb(0,"button",12),n.Zb("click",(function(){n.rc(e);const i=n.dc(3).$implicit;return n.dc().save(i)})),n.Ec(1,"Save "),n.Qb()}if(2&e){const e=n.dc(3).$implicit,i=n.dc();n.jc("disabled",i.dirtyEnvPermissions[e.uid].permission===e.permission)}}function f(e,i){if(1&e){const e=n.Sb();n.Rb(0,"button",13),n.Zb("click",(function(){n.rc(e);const i=n.dc(3).$implicit;return n.dc().revoke(i)})),n.Ec(1),n.Qb()}if(2&e){const e=n.dc(3).$implicit,i=n.dc();n.Ab(1),n.Gc(" ",e.uid===i.userUID?"Leave":"Revoke"," ")}}function g(e,i){if(1&e&&(n.Pb(0),n.Cc(1,v,2,1,"button",10),n.Cc(2,f,2,1,"button",11),n.Ob()),2&e){const e=n.dc(2).$implicit,i=n.dc();n.Ab(1),n.jc("ngIf",i.userIsAdmin),n.Ab(1),n.jc("ngIf",i.userIsAdmin||e.uid===i.userUID)}}const h=function(e){return{user:e}};function E(e,i){if(1&e&&(n.Pb(0),n.Rb(1,"td",3),n.Nb(2,4),n.Qb(),n.Rb(3,"td",3),n.Cc(4,b,4,5,"div",2),n.Cc(5,l,3,3,"ng-container",2),n.Qb(),n.Rb(6,"td",5),n.Cc(7,p,2,0,"ng-container",2),n.Cc(8,g,3,2,"ng-container",2),n.Qb(),n.Ob()),2&e){const e=n.dc().$implicit,i=n.dc();n.Ab(2),n.jc("ngTemplateOutlet",i.userColumnTemplate)("ngTemplateOutletContext",n.lc(6,h,e)),n.Ab(2),n.jc("ngIf",i.userIsAdmin),n.Ab(1),n.jc("ngIf",!i.userIsAdmin),n.Ab(2),n.jc("ngIf",i.dirtyEnvPermissions[e.uid].saving),n.Ab(1),n.jc("ngIf",!i.dirtyEnvPermissions[e.uid].saving)}}function I(e,i){if(1&e&&(n.Rb(0,"tr"),n.Cc(1,E,9,8,"ng-container",2),n.Qb()),2&e){const e=i.$implicit,t=n.dc();n.Ab(1),n.jc("ngIf",t.dirtyEnvPermissions[e.uid])}}let O=(()=>{class e{constructor(){this.subs=new r.a,this.revokeUser=new n.o,this.updateUser=new n.o,this.dirtyEnvPermissions={},this.originalOrder=(e,i)=>0}ngOnChanges(e){for(const i of this.users)this.dirtyEnvPermissions[i.uid]={permission:i.permission,saving:!1}}ngOnInit(){this.subs.add(this.savingCompleted.subscribe(e=>{this.dirtyEnvPermissions[e]&&(this.dirtyEnvPermissions[e].saving=!1)}))}ngOnDestroy(){this.subs.unsubscribe()}convertPermissionToString(e){switch(e){case s.EnvironmentPermissions.read:return"Read";case s.EnvironmentPermissions.write:return"Write";case s.EnvironmentPermissions.admin:return"Admin";case s.EnvironmentPermissions.owner:return"Owner"}}revoke(e){this.dirtyEnvPermissions[e.uid].saving=!0,this.revokeUser.emit(e)}save(e){this.dirtyEnvPermissions[e.uid].saving=!0,this.updateUser.emit(Object.assign(Object.assign({},e),{permission:this.dirtyEnvPermissions[e.uid].permission}))}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=n.Fb({type:e,selectors:[["permission-table"]],inputs:{userIsAdmin:"userIsAdmin",userUID:"userUID",users:"users",permissionMap:"permissionMap",userColumnTemplate:"userColumnTemplate",savingCompleted:"savingCompleted"},outputs:{revokeUser:"revokeUser",updateUser:"updateUser"},features:[n.yb],decls:9,vars:1,consts:[[1,"table","my-3",2,"min-width","500px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"align-middle"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"align-middle","text-center"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mode","indeterminate",2,"width","75px"],["mat-button","","mat-stroked-button","","color","primary","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-button","","mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","mat-stroked-button","","color","primary",1,"mr-2",3,"disabled","click"],["mat-button","","mat-raised-button","","color","warn",3,"click"]],template:function(e,i){1&e&&(n.Rb(0,"table",0),n.Rb(1,"thead"),n.Rb(2,"tr"),n.Rb(3,"td"),n.Ec(4,"User"),n.Qb(),n.Rb(5,"td"),n.Ec(6,"Permission"),n.Qb(),n.Mb(7,"td"),n.Qb(),n.Qb(),n.Cc(8,I,2,1,"tr",1),n.Qb()),2&e&&(n.Ab(8),n.jc("ngForOf",i.users))},directives:[o.s,o.t,o.A,c.a,a.l,u.a,m.b],pipes:[o.l,o.F],styles:[""]}),e})()},OAzE:function(e,i,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,i,t,n){void 0===n&&(n=t);var s=Object.getOwnPropertyDescriptor(i,t);s&&!("get"in s?!i.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(e,n,s)}:function(e,i,t,n){void 0===n&&(n=t),e[n]=i[t]}),s=this&&this.__exportStar||function(e,i){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(i,t)||n(i,e,t)};Object.defineProperty(i,"__esModule",{value:!0}),s(t("EICP"),i),s(t("OEZC"),i),s(t("Qk56"),i),s(t("h/V3"),i)},OEZC:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Settings=i.Tags=void 0,i.Tags={languages:{JAVASCRIPT:"javascript",TYPESCRIPT:"typescript",JAVA:"java",PYTHON:"python",C:"C"},frameworks:{EXPRESSJS:"expressjs",ANGULARJS:"angularjs",NODEJS:"nodejs",REACTJS:"reactjs"}},i.Settings={GIT:{MAIN_BRANCH:"stackjoy"}}},Qk56:function(e,i,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,i,t,n){void 0===n&&(n=t);var s=Object.getOwnPropertyDescriptor(i,t);s&&!("get"in s?!i.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(e,n,s)}:function(e,i,t,n){void 0===n&&(n=t),e[n]=i[t]}),s=this&&this.__exportStar||function(e,i){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(i,t)||n(i,e,t)};Object.defineProperty(i,"__esModule",{value:!0}),s(t("A4A1"),i)},"h/V3":function(e,i,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,i,t,n){void 0===n&&(n=t);var s=Object.getOwnPropertyDescriptor(i,t);s&&!("get"in s?!i.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(e,n,s)}:function(e,i,t,n){void 0===n&&(n=t),e[n]=i[t]}),s=this&&this.__exportStar||function(e,i){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(i,t)||n(i,e,t)};Object.defineProperty(i,"__esModule",{value:!0}),s(t("zXtJ"),i)},k1Ex:function(e,i,t){"use strict";t.d(i,"a",(function(){return d}));var n=t("HdQx"),s=t("b5vT"),r=t("IzEk"),o=t("fXoL"),c=t("0IaG"),a=t("a8/g"),u=t("xm+p"),m=t("3sFK");let d=(()=>{class e{constructor(e,i,t,n){this.dialog=e,this.appConsoleService=i,this.navigationService=t,this.appEnvironmentService=n}createNewWorkspace(e){const i=this.dialog.open(s.a,{data:{type:n.a.Environment.Type.Workspace,stack:e},disableClose:!0,minWidth:"600px",position:{top:"100px"},autoFocus:!0});return i.afterClosed().subscribe(i=>{i.continue&&this.appEnvironmentService.switchToEnvironment(i.newEnvironment.id).subscribe(i=>{setTimeout(()=>{this.appConsoleService.openBluConsole({command:"install "+e.displayName,extraInfo:{stack:e}}).afterClosed().pipe(Object(r.a)(1)).subscribe(e=>this.navigationService.navigateTo(["workspace"]))},250)})}),i}}return e.\u0275fac=function(i){return new(i||e)(o.Vb(c.b),o.Vb(a.a),o.Vb(u.a),o.Vb(m.a))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},mrSG:function(e,i,t){"use strict";function n(e,i,t,n){return new(t||(t=Promise))((function(s,r){function o(e){try{a(n.next(e))}catch(i){r(i)}}function c(e){try{a(n.throw(e))}catch(i){r(i)}}function a(e){var i;e.done?s(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(o,c)}a((n=n.apply(e,i||[])).next())}))}t.d(i,"a",(function(){return n}))},"s/2f":function(e,i,t){"use strict";t.d(i,"a",(function(){return _}));var n=t("mrSG"),s=t("fXoL"),r=t("3Pt+"),o=t("quSY"),c=t("IzEk"),a=t("nYR2"),u=t("EICP"),m=t("0IaG"),d=t("n2Wo"),b=t("3sFK"),l=t("N4Rb"),p=t("biaL"),v=t("nZ6g"),f=t("ofXK"),g=t("O2It"),h=t("zkoq"),E=t("kmnG"),I=t("qFsG"),O=t("d3UM"),P=t("bTqV"),S=t("FKr1");function R(e,i){1&e&&(s.Rb(0,"h4",4),s.Ec(1,"You must be an administrator to change these settings"),s.Qb())}function A(e,i){if(1&e&&(s.Rb(0,"div",6),s.Ec(1),s.Qb()),2&e){const e=s.dc().user;s.Ab(1),s.Fc(e.email)}}function k(e,i){if(1&e&&(s.Ec(0),s.Cc(1,A,2,1,"div",5)),2&e){const e=i.user;s.Gc(" ",e.username||e.email," "),s.Ab(1),s.jc("ngIf",e.username)}}function w(e,i){if(1&e){const e=s.Sb();s.Rb(0,"tr"),s.Rb(1,"td",19),s.Ec(2),s.Qb(),s.Rb(3,"td",19),s.Ec(4),s.ec(5,"titlecase"),s.Qb(),s.Rb(6,"td",19),s.Rb(7,"button",20),s.Zb("click",(function(){s.rc(e);const t=i.$implicit;return s.dc(3).resendInvite(t.uid)})),s.Ec(8,"Resend Invite"),s.Qb(),s.Rb(9,"button",21),s.Zb("click",(function(){s.rc(e);const t=i.$implicit;return s.dc(3).cancelShare(t.uid)})),s.Ec(10,"Cancel Invite"),s.Qb(),s.Qb(),s.Qb()}if(2&e){const e=i.$implicit,t=s.dc(3);s.Ab(2),s.Fc(e.username||e.email||"Unknown user"),s.Ab(2),s.Fc(s.fc(5,2,t.convertPermissionToString(e.permission)))}}function y(e,i){if(1&e&&(s.Pb(0),s.Rb(1,"h4",16),s.Ec(2,"Pending Invites"),s.Qb(),s.Rb(3,"table",17),s.Rb(4,"thead"),s.Rb(5,"tr"),s.Mb(6,"td"),s.Rb(7,"td"),s.Ec(8,"Permission"),s.Qb(),s.Rb(9,"td"),s.Ec(10,"Actions"),s.Qb(),s.Qb(),s.Qb(),s.Cc(11,w,11,4,"tr",18),s.Qb(),s.Ob()),2&e){const e=s.dc(2);s.Ab(11),s.jc("ngForOf",e.invites)}}function C(e,i){if(1&e&&(s.Rb(0,"mat-option",22),s.Ec(1),s.ec(2,"titlecase"),s.Qb()),2&e){const e=i.$implicit;s.jc("value",e.value),s.Ab(1),s.Gc(" ",s.fc(2,2,e.key)," ")}}function j(e,i){if(1&e){const e=s.Sb();s.Pb(0),s.Cc(1,y,12,1,"ng-container",3),s.Rb(2,"form",7),s.Zb("submit",(function(){return s.rc(e),s.dc().share()})),s.Rb(3,"mat-grid-list",8),s.Rb(4,"mat-grid-tile",9),s.Rb(5,"mat-form-field"),s.Rb(6,"mat-label"),s.Ec(7,"Email"),s.Qb(),s.Mb(8,"input",10),s.Qb(),s.Qb(),s.Rb(9,"mat-grid-tile",11),s.Rb(10,"mat-form-field"),s.Rb(11,"mat-label"),s.Ec(12,"Permissions"),s.Qb(),s.Rb(13,"mat-select",12),s.Cc(14,C,3,4,"mat-option",13),s.ec(15,"keyvalue"),s.Qb(),s.Qb(),s.Qb(),s.Rb(16,"mat-grid-tile",14),s.Rb(17,"button",15),s.Ec(18,"Add"),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.Ob()}if(2&e){const e=s.dc();s.Ab(1),s.jc("ngIf",e.invites.length>0),s.Ab(1),s.jc("formGroup",e.addUserForm),s.Ab(12),s.jc("ngForOf",s.gc(15,3,e.envPermissions,e.originalOrder))}}let _=(()=>{class e{constructor(e,i,t,n,c,a,m,d){this.fb=e,this.dialog=i,this.stackService=t,this.appEnvironmentService=n,this.workspaceService=c,this.userService=a,this.dialogService=m,this.dialogRef=d,this.addUserForm=new r.j({email:new r.g("",[r.F.required,r.F.email]),permission:new r.g("",[r.F.required])}),this.loading=!0,this.userIsAdmin=!1,this.userProfiles=new Map,this.members=[],this.mainTableSavingCompleted=new s.o,this.invites=[],this.envPermissions=new Map([["read",u.EnvironmentPermissions.read],["write",u.EnvironmentPermissions.write],["admin",u.EnvironmentPermissions.admin],["owner",u.EnvironmentPermissions.owner]]),this.subs=new o.a,this.originalOrder=(e,i)=>0,this.subs.add(this.userService.user$.subscribe(e=>{e&&(this.userId=e.uid)}))}ngOnInit(){this.setupShareSettings(),this.loading=!1}ngOnDestroy(){this.subs.unsubscribe()}close(){this.dialogRef.close()}loadInvites(){var e;this.invites=Object.keys((null===(e=this.environment.remote)||void 0===e?void 0:e.invites)||{}).map(e=>{var i;return Object.assign(Object.assign({},null===(i=this.environment.remote)||void 0===i?void 0:i.invites[e]),this.userProfiles.get(e))})}setupShareSettings(){var e;return Object(n.a)(this,void 0,void 0,(function*(){this.userIsAdmin=(null===(e=this.environment.remote)||void 0===e?void 0:e.permissions[this.userId].permission)>=this.envPermissions.get("admin"),yield this.getUserProfilesForEnvironment(),this.members=Object.keys(this.environment.remote.permissions).map(e=>Object.assign(Object.assign({},this.userProfiles.get(e)),{permission:this.environment.remote.permissions[e].permission})).sort((e,i)=>e.permission>=i.permission?-1:1),this.loadInvites()}))}getUserProfilesForEnvironment(){return Object(n.a)(this,void 0,void 0,(function*(){(yield this.workspaceService.getUserProfilesFor(this.environment.remote.id).pipe(Object(c.a)(1)).toPromise()).forEach(e=>this.userProfiles.set(e.uid,e))}))}share(){this.addUserForm.disable();const{email:e,permission:i}=this.addUserForm.getRawValue();this.workspaceService.share(this.environment.remote.id,e,i).pipe(Object(c.a)(1),Object(a.a)(()=>{this.addUserForm.enable()})).subscribe(e=>{const{userId:t}=e;this.environment.remote.invites[t]={permission:i},this.userProfiles.set(t,{username:"Loading...",email:"",uid:t}),this.getUserProfilesForEnvironment().then(()=>this.loadInvites()),this.addUserForm.reset()},e=>{this.dialogService.openAlertDialog({title:"Share Workspace",text:"Error while sharing"})})}cancelShare(e){this.workspaceService.cancelShare(this.environment.remote.id,e).pipe(Object(c.a)(1)).subscribe(()=>{delete this.environment.remote.invites[e],this.invites=this.invites.filter(i=>i.uid!==e).slice()},e=>{this.dialogService.openAlertDialog({title:"Share Workspace",text:""+(e.message||"Unknown error occurred!")})})}resendInvite(e){this.workspaceService.share(this.environment.remote.id,this.userProfiles.get(e).email,this.environment.remote.invites[e].permission).pipe(Object(c.a)(1)).subscribe(()=>{this.dialogService.openAlertDialog({title:"Send Invite",text:"Invite sent successfully."})},e=>{this.dialogService.openAlertDialog({title:"Send Invite",text:"Invite failed to be sent, please try again later."})})}save(e){this.workspaceService.updateUserPermission(this.environment.remote.id,e.uid,e.permission).pipe(Object(c.a)(1)).toPromise().then(()=>{this.members.splice(this.members.findIndex(i=>i.uid===e.uid),1,e),this.mainTableSavingCompleted.emit(e.uid)}).catch(i=>{this.dialogService.alertUnknownErrorTryAgain(),this.mainTableSavingCompleted.emit(e.uid)})}revoke(e){var i;let t=!1;for(const[n,s]of Object.entries(null===(i=this.environment.remote)||void 0===i?void 0:i.permissions))if(n===e.uid&&s.permission===u.EnvironmentPermissions.owner)t=!0;else if(s.permission===u.EnvironmentPermissions.owner){t=!1;break}t?this.dialogService.openAlertDialog({title:"Revoke Access",text:"You cannot revoke the permissions of the only owner!"}):this.dialogService.openConfirmationDialog({title:"Revoke Access",text:"This will revoke all permissions from the user "+(e.username||e.email),button:{yes:"Revoke",no:"Cancel"}}).afterClosed().subscribe(i=>{!0===i?this.workspaceService.revokeUserPermission(this.environment.remote.id,e.uid).pipe(Object(c.a)(1)).toPromise().then(i=>{e.uid===this.userId?this.close():this.members=this.members.splice(this.members.findIndex(i=>i.uid===e.uid),1).slice()}).catch(i=>{this.dialogService.alertUnknownErrorTryAgain(),this.mainTableSavingCompleted.emit(e.uid)}):this.mainTableSavingCompleted.emit(e.uid)})}convertPermissionToString(e){switch(e){case u.EnvironmentPermissions.read:return"Read";case u.EnvironmentPermissions.write:return"Write";case u.EnvironmentPermissions.admin:return"Admin";case u.EnvironmentPermissions.owner:return"Owner"}}}return e.\u0275fac=function(i){return new(i||e)(s.Lb(r.f),s.Lb(m.b),s.Lb(d.a),s.Lb(b.a),s.Lb(l.a),s.Lb(p.a),s.Lb(v.a),s.Lb(m.h))},e.\u0275cmp=s.Fb({type:e,selectors:[["share-environment-settings"]],inputs:{environment:"environment",userId:"userId",userIsAdmin:"userIsAdmin"},decls:5,vars:8,consts:[["class","text-grey",4,"ngIf"],[3,"users","userIsAdmin","userUID","userColumnTemplate","permissionMap","savingCompleted","updateUser","revokeUser"],["userColumn",""],[4,"ngIf"],[1,"text-grey"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[3,"formGroup","submit"],["cols","7"],["colspan","4"],["type","email","matInput","","formControlName","email"],["colspan","2"],["formControlName","permission"],[3,"value",4,"ngFor","ngForOf"],["colspan","1"],["mat-button","","mat-raised-button","","color","primary","type","submit"],[2,"margin-top","15px","margin-bottom","0"],[1,"table"],[4,"ngFor","ngForOf"],[1,"align-middle"],["mat-button","","mat-raised-button","","color","primary",1,"mr-2",3,"click"],["mat-button","","mat-raised-button","","color","warn",3,"click"],[3,"value"]],template:function(e,i){if(1&e&&(s.Cc(0,R,2,0,"h4",0),s.Rb(1,"permission-table",1),s.Zb("updateUser",(function(e){return i.save(e)}))("revokeUser",(function(e){return i.revoke(e)})),s.Qb(),s.Cc(2,k,2,2,"ng-template",null,2,s.Dc),s.Cc(4,j,19,6,"ng-container",3)),2&e){const e=s.oc(3);s.jc("ngIf",!i.userIsAdmin),s.Ab(1),s.jc("users",i.members)("userIsAdmin",i.userIsAdmin)("userUID",i.userId)("userColumnTemplate",e)("permissionMap",i.envPermissions)("savingCompleted",i.mainTableSavingCompleted),s.Ab(3),s.jc("ngIf",i.userIsAdmin)}},directives:[f.t,g.a,r.H,r.s,r.k,h.a,h.c,E.c,E.g,I.a,r.c,r.r,r.i,O.a,f.s,P.b,S.l],pipes:[f.l,f.F],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%;padding:0 5px}.permTable[_ngcontent-%COMP%]{width:100%}.tableActions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px}"]}),e})()},zXtJ:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.stringToDate=i.dateToString=void 0,i.dateToString=function(e){return e.toISOString()},i.stringToDate=function(e){return new Date(e)}}}]);