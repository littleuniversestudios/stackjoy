(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{uiGw:function(t,i,n){"use strict";n.r(i),n.d(i,"LoginModule",(function(){return P}));var e=n("ofXK"),o=n("tyNb"),r=n("quSY"),c=n("aSHc"),a=n("eIep"),s=n("fXoL"),b=n("IYfF"),d=n("xm+p"),l=n("5yAa"),u=n("3sFK"),m=n("Wp6s"),g=n("bTqV"),v=n("3Pt+"),p=n("kmnG"),h=n("qFsG"),f=n("bv9b");function S(t,i){if(1&t){const t=s.Sb();s.Rb(0,"mat-card"),s.Rb(1,"div",2),s.Ec(2,"You are logged in as: "),s.Rb(3,"b"),s.Ec(4),s.Qb(),s.Qb(),s.Rb(5,"div",3),s.Rb(6,"button",4),s.Zb("click",(function(){return s.rc(t),s.dc().logout()})),s.Ec(7,"Log Out"),s.Qb(),s.Qb(),s.Qb()}if(2&t){const t=s.dc();s.Ab(4),s.Fc(t.user.email)}}function w(t,i){if(1&t&&(s.Rb(0,"div",16),s.Ec(1),s.Qb()),2&t){const t=s.dc(2);s.Ab(1),s.Fc(t.loginForm.error)}}function Q(t,i){1&t&&(s.Rb(0,"button",17),s.Ec(1,"Sign In"),s.Qb())}function R(t,i){1&t&&(s.Rb(0,"div"),s.Rb(1,"div",2),s.Mb(2,"mat-progress-bar",18),s.Qb(),s.Qb())}function E(t,i){if(1&t&&(s.Rb(0,"div",5),s.Mb(1,"i",23),s.Ec(2," User "),s.Rb(3,"span",6),s.Ec(4),s.Qb(),s.Ec(5," not found"),s.Qb()),2&t){const t=s.dc(3);s.Ab(4),s.Fc(t.loginForm.email)}}function C(t,i){1&t&&(s.Rb(0,"div",5),s.Mb(1,"i",23),s.Ec(2," Too many login requests. Please wait before trying again."),s.Qb())}function F(t,i){if(1&t){const t=s.Sb();s.Rb(0,"div",5),s.Rb(1,"div",5),s.Mb(2,"i",23),s.Ec(3," Incorrect password."),s.Qb(),s.Rb(4,"div",24),s.Zb("click",(function(){return s.rc(t),s.dc(3).forgotPassword()})),s.Ec(5,"(Click here to reset password)"),s.Qb(),s.Qb()}}function I(t,i){if(1&t&&(s.Rb(0,"div",5),s.Rb(1,"div",5),s.Mb(2,"i",23),s.Rb(3,"span",25),s.Ec(4),s.Qb(),s.Ec(5," is not a valid email"),s.Qb(),s.Qb()),2&t){const t=s.dc(3);s.Ab(4),s.Fc(t.loginForm.email)}}function A(t,i){1&t&&(s.Rb(0,"div",5),s.Mb(1,"i",23),s.Ec(2," Error Occurred."),s.Qb())}function y(t,i){if(1&t&&(s.Rb(0,"div",19),s.Pb(1,20),s.Cc(2,E,6,1,"div",21),s.Cc(3,C,3,0,"div",21),s.Cc(4,F,6,0,"div",21),s.Cc(5,I,6,1,"div",21),s.Cc(6,A,3,0,"div",22),s.Ob(),s.Qb()),2&t){const t=s.dc(2);s.Ab(1),s.jc("ngSwitch",t.errorCode),s.Ab(1),s.jc("ngSwitchCase","auth/user-not-found"),s.Ab(1),s.jc("ngSwitchCase","auth/too-many-requests"),s.Ab(1),s.jc("ngSwitchCase","auth/wrong-password"),s.Ab(1),s.jc("ngSwitchCase","Invalid value")}}function k(t,i){if(1&t){const t=s.Sb();s.Rb(0,"mat-card"),s.Rb(1,"div",2),s.Rb(2,"div",5),s.Rb(3,"div",6),s.Ec(4,"Sign In:"),s.Qb(),s.Rb(5,"div",2),s.Rb(6,"form",7),s.Zb("ngSubmit",(function(){return s.rc(t),s.dc().login()})),s.Rb(7,"div",5),s.Rb(8,"mat-form-field"),s.Rb(9,"mat-label"),s.Ec(10,"Email"),s.Qb(),s.Rb(11,"input",8),s.Zb("ngModelChange",(function(i){return s.rc(t),s.dc().loginForm.email=i})),s.Qb(),s.Qb(),s.Qb(),s.Rb(12,"div",5),s.Rb(13,"mat-form-field"),s.Rb(14,"mat-label"),s.Ec(15,"Password"),s.Qb(),s.Rb(16,"input",9),s.Zb("ngModelChange",(function(i){return s.rc(t),s.dc().loginForm.password=i})),s.Qb(),s.Qb(),s.Qb(),s.Cc(17,w,2,1,"div",10),s.Cc(18,Q,2,0,"button",11),s.Cc(19,R,3,0,"div",1),s.Qb(),s.Cc(20,y,7,5,"div",12),s.Qb(),s.Qb(),s.Rb(21,"div",13),s.Rb(22,"div",14),s.Zb("click",(function(){return s.rc(t),s.dc().forgotPassword()})),s.Ec(23,"Forgot Password"),s.Qb(),s.Rb(24,"div",15),s.Zb("click",(function(){return s.rc(t),s.dc().createAccount()})),s.Ec(25,"Create Account"),s.Qb(),s.Qb(),s.Qb(),s.Qb()}if(2&t){const t=s.dc();s.Ab(11),s.jc("ngModel",t.loginForm.email)("disabled",t.loginForm.disabled),s.Ab(5),s.jc("ngModel",t.loginForm.password)("disabled",t.loginForm.disabled),s.Ab(1),s.jc("ngIf",""!==t.loginForm.error),s.Ab(1),s.jc("ngIf",t.currentState!==t.actionState.PENDING),s.Ab(1),s.jc("ngIf",t.currentState===t.actionState.PENDING),s.Ab(1),s.jc("ngIf",t.currentState===t.actionState.FAILED)}}const j=o.f.forChild([{path:"",component:(()=>{class t{constructor(t,i,n,e,o){this.authService=t,this.route=i,this.navigationService=n,this.appInitService=e,this.appEnvironmentService=o,this.loginForm={email:"",password:"",error:"",disabled:!1},this.subs=new r.a,this.currentState=c.a.IDLE,this.actionState=c.a}ngOnInit(){var t;this.loginForm.email=null!==(t=this.route.snapshot.queryParams.email)&&void 0!==t?t:"",this.subs.add(this.authService.user$.subscribe(t=>this.user=t)),this.subs.add(this.appEnvironmentService.currentEnvironment$.subscribe(t=>this.appEnvironment=t))}ngOnDestroy(){this.subs.unsubscribe()}createAccount(){const t={};this.loginForm.email&&(t.email=this.loginForm.email),this.navigationService.navigateTo(["create-account"],{queryParams:t})}forgotPassword(){const t={};this.loginForm.email&&(t.email=this.loginForm.email),this.navigationService.navigateTo(["forgot-password"],{queryParams:t})}login(){this.currentState=c.a.PENDING,this.authService.login(this.loginForm.email,this.loginForm.password).toPromise().then(()=>{this.currentState=c.a.SUCCESS,this.appEnvironment?this.navigationService.navigateTo(["my-items"]):this.appInitService.openNoEnvironmentDialog()}).catch(t=>{var i,n,e,o,r,a;this.currentState=c.a.FAILED,this.error=t.error,this.errorCode=null!==(a=null!==(e=null===(n=null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.data)||void 0===n?void 0:n.code)&&void 0!==e?e:null===(r=null===(o=null==t?void 0:t.error)||void 0===o?void 0:o.message[0])||void 0===r?void 0:r.msg)&&void 0!==a?a:"unknown_error",console.log("Login error Code: ",this.errorCode)})}logout(){this.authService.logout().pipe(Object(a.a)(t=>this.appEnvironmentService.switchToSystemWorkspace())).subscribe(t=>this.navigationService.navigateTo(["app-environment"]))}}return t.\u0275fac=function(i){return new(i||t)(s.Lb(b.a),s.Lb(o.a),s.Lb(d.a),s.Lb(l.a),s.Lb(u.a))},t.\u0275cmp=s.Fb({type:t,selectors:[["login"]],decls:3,vars:2,consts:[[1,"d-flex","justify-content-center","pt-4"],[4,"ngIf"],[1,"p-2"],[1,"p-2","text-center"],["mat-raised-button","",3,"click"],[1,""],[1,"text-bold"],[1,"form",3,"ngSubmit"],["matInput","","placeholder","Email","type","email","name","email","required","",3,"ngModel","disabled","ngModelChange"],["matInput","","placeholder","Password","type","password","name","password","required","",3,"ngModel","disabled","ngModelChange"],["class","error",4,"ngIf"],["mat-raised-button","","type","submit",4,"ngIf"],["class","pt-4 text-break","style","width: 250px;",4,"ngIf"],[1,"d-flex","p-2","pt-4"],[1,"cursor-pointer",3,"click"],[1,"cursor-pointer","ml-auto","pl-4",3,"click"],[1,"error"],["mat-raised-button","","type","submit"],["mode","indeterminate"],[1,"pt-4","text-break",2,"width","250px"],[3,"ngSwitch"],["class","",4,"ngSwitchCase"],["class","",4,"ngSwitchDefault"],[1,"fa","fa-exclamation-triangle","text-warning"],[1,"text-small","as-link","pt-1","cursor-pointer",3,"click"],[1,"text-bold","ml-1"]],template:function(t,i){1&t&&(s.Rb(0,"div",0),s.Cc(1,S,8,1,"mat-card",1),s.Cc(2,k,26,8,"mat-card",1),s.Qb()),2&t&&(s.Ab(1),s.jc("ngIf",i.user),s.Ab(1),s.jc("ngIf",!i.user))},directives:[e.t,m.a,g.b,v.G,v.r,v.s,p.c,p.g,h.a,v.c,v.B,v.q,v.t,f.a,e.x,e.y,e.z],styles:[""]}),t})(),children:[]}]);let P=(()=>{class t{}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(i){return new(i||t)},providers:[],imports:[[e.c,j,g.c,v.l,h.b,m.b,f.b]]}),t})()}}]);