(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{Chfi:function(t,e,i){"use strict";i.r(e),i.d(e,"MyStacksModule",(function(){return xt}));var c=i("ofXK"),n=i("tyNb"),s=i("mrSG"),o=i("HdQx"),a=i("quSY"),r=i("cp0P"),b=i("b5vT"),d=i("IzEk"),l=i("vkgz"),u=i("40nA"),p=i("Mzu6"),g=i("EVKI"),f=i("5Trv"),m=i("0IaG"),v=i("OAzE"),h=i("XNiG"),k=i("Kj3r"),S=i("/uUt"),I=i("fXoL"),R=i("oCqB"),Q=i("kmnG"),E=i("qFsG"),C=i("bTqV");function x(t,e){if(1&t){const t=I.Sb();I.Rb(0,"button",3),I.Zb("click",(function(){I.rc(t);const i=e.$implicit;return I.dc().addTag(i)})),I.Ec(1),I.ec(2,"titlecase"),I.Qb()}if(2&t){const t=e.$implicit,i=I.dc();I.jc("disabled",i.currentTags.has(t)||i.newTags.has(t)),I.Ab(1),I.Fc(I.fc(2,2,t))}}let w=(()=>{class t{constructor(e,i,c){this.data=e,this.ngZone=i,this.stackService=c,this.availableTags=Array.from(t.allTags),this.searchChanged=new h.a,this.newTags=new Set,this.currentTags=new Set(e.tags),this.stack=e.stack}static generateTagList(t){let e=new Set;for(const i in t)"string"==typeof t[i]?e.add(t[i]):"object"==typeof t[i]&&(e=new Set([...e,...this.generateTagList(t[i])]));return e}ngOnInit(){this.searchChanged.pipe(Object(k.a)(300),Object(S.a)()).subscribe(t=>{this.updateSearch(t)})}ngOnDestroy(){}updateSearch(e){this.availableTags=Array.from(t.allTags).filter(t=>t.includes(e))}addTag(t){var e;this.stackService.addTag(null===(e=this.stack.remote)||void 0===e?void 0:e.id,t).pipe(Object(d.a)(1)).subscribe(()=>{this.newTags.add(t)})}}return t.allTags=t.generateTagList(v.Tags),t.\u0275fac=function(e){return new(e||t)(I.Lb(m.a),I.Lb(I.A),I.Lb(R.a))},t.\u0275cmp=I.Fb({type:t,selectors:[["add-tag-dialog"]],decls:6,vars:1,consts:[["appearance","fill"],["matInput","","placeholder","Search",3,"input"],["mat-button","","mat-raised-button","","class","ml-2 mr-2 my-2",3,"disabled","click",4,"ngFor","ngForOf"],["mat-button","","mat-raised-button","",1,"ml-2","mr-2","my-2",3,"disabled","click"]],template:function(t,e){1&t&&(I.Rb(0,"mat-form-field",0),I.Rb(1,"mat-label"),I.Ec(2,"Search Tags"),I.Qb(),I.Rb(3,"input",1),I.Zb("input",(function(t){return e.searchChanged.next(t.target.value)})),I.Qb(),I.Qb(),I.Rb(4,"div"),I.Cc(5,x,3,4,"button",2),I.Qb()),2&t&&(I.Ab(5),I.jc("ngForOf",e.availableTags))},directives:[Q.c,Q.g,E.a,c.s,C.b],pipes:[c.F],styles:[""]}),t})();var A=i("3sFK"),y=i("biaL"),j=i("nZ6g"),T=i("a8/g"),O=i("xm+p"),$=i("k1Ex"),L=i("aSHc"),F=i("bv9b");function M(t,e){if(1&t){const t=I.Sb();I.Pb(0),I.Rb(1,"button",1),I.Zb("click",(function(){return I.rc(t),I.dc().downloadRemoteStack()})),I.Mb(2,"i",2),I.Ec(3," Download Remote Stack"),I.Qb(),I.Ob()}}function Z(t,e){1&t&&(I.Pb(0),I.Rb(1,"div",3),I.Mb(2,"mat-progress-bar",4),I.Rb(3,"div",5),I.Ec(4,"downloading stack"),I.Qb(),I.Qb(),I.Ob())}function D(t,e){if(1&t&&(I.Pb(0),I.Rb(1,"div",6),I.Mb(2,"i",7),I.Ec(3),I.Qb(),I.Ob()),2&t){const t=I.dc();I.Ab(3),I.Gc(" Error Downloading Stack ",t.stack.name,"")}}let P=(()=>{class t{constructor(t){this.stackService=t,this.onFinished=new I.o,this.actionState=L.a,this.currentState=L.a.IDLE,this.subs=new a.a}ngOnInit(){}ngOnDestroy(){this.subs.unsubscribe()}downloadRemoteStack(){this.currentState=this.actionState.ACQUIRING,this.subs.add(this.stackService.downloadStack(this.stack.remote.id,this.stack.name,this.stack.remote.version,o.a.Environment.Type.Stack).subscribe(t=>{this.currentState=this.actionState.SUCCESS,this.onFinished.emit(!0)}))}}return t.\u0275fac=function(e){return new(e||t)(I.Lb(R.a))},t.\u0275cmp=I.Fb({type:t,selectors:[["download-remote-stack"]],inputs:{stack:"stack"},outputs:{onFinished:"onFinished"},decls:3,vars:3,consts:[[4,"ngIf"],["mat-button","",3,"click"],[1,"fa","fa-download","text-muted"],[1,"text-center"],["mode","buffer"],[1,"text-small"],[1,"text-warning"],[1,"fa","fa-exclamation-triangle"]],template:function(t,e){1&t&&(I.Cc(0,M,4,0,"ng-container",0),I.Cc(1,Z,5,0,"ng-container",0),I.Cc(2,D,4,1,"ng-container",0)),2&t&&(I.jc("ngIf",e.currentState===e.actionState.IDLE),I.Ab(1),I.jc("ngIf",e.currentState===e.actionState.ACQUIRING),I.Ab(1),I.jc("ngIf",e.currentState===e.actionState.FAILED))},directives:[c.t,C.b,F.a],styles:[""]}),t})();var N=i("f0Cb"),G=i("Qu3c"),W=i("3Pt+");function H(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",12),I.Rb(1,"div",13),I.Rb(2,"div",14),I.Rb(3,"div",15),I.Rb(4,"div"),I.Ec(5),I.ec(6,"titlecase"),I.Qb(),I.Rb(7,"div",16),I.Ec(8),I.ec(9,"titlecase"),I.Qb(),I.Qb(),I.Rb(10,"div"),I.Rb(11,"button",17),I.Zb("click",(function(){I.rc(t);const i=e.$implicit;return I.dc(3).acceptInvite(i.eid)})),I.Ec(12,"Accept"),I.Qb(),I.Rb(13,"button",17),I.Zb("click",(function(){I.rc(t);const i=e.$implicit;return I.dc(3).declineInvite(i.eid)})),I.Ec(14,"Decline"),I.Qb(),I.Qb(),I.Qb(),I.Qb(),I.Qb()}if(2&t){const t=e.$implicit;I.Ab(5),I.Fc(I.fc(6,2,t.name)),I.Ab(3),I.Gc("Owner: ",I.fc(9,4,t.owner.displayName)||t.owner.email,"")}}function U(t,e){if(1&t&&(I.Pb(0),I.Rb(1,"div",10),I.Ec(2,"Stack Invites"),I.Qb(),I.Cc(3,H,15,6,"div",11),I.Ob()),2&t){const t=I.dc(2);I.Ab(3),I.jc("ngForOf",t.invites)}}function q(t,e){if(1&t){const t=I.Sb();I.Pb(0),I.Rb(1,"div",18),I.Rb(2,"div",19),I.Zb("click",(function(){return I.rc(t),I.dc(2).gotoLogin()})),I.Mb(3,"i",20),I.Ec(4," Please Log In to use this section. "),I.Mb(5,"i",21),I.Qb(),I.Rb(6,"div",22),I.Zb("click",(function(){return I.rc(t),I.dc(2).goToCreateAccount()})),I.Ec(7," You can also create an account and receive an additional workspace. "),I.Qb(),I.Qb(),I.Ob()}}function z(t,e){1&t&&(I.Rb(0,"div",24),I.Ec(1,"No stacks present"),I.Qb())}function K(t,e){1&t&&(I.Rb(0,"div",35),I.Rb(1,"button",36),I.Mb(2,"i",37),I.Qb(),I.Qb())}function J(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",4),I.Rb(1,"button",38),I.Zb("click",(function(){I.rc(t);const e=I.dc().$implicit;return I.dc(3).switchEnvironment(e)})),I.Mb(2,"i",39),I.Qb(),I.Qb()}if(2&t){const t=I.dc().$implicit,e=I.dc(3);I.Ab(1),I.jc("disabled",e.isCurrentEnv(t))}}function X(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",4),I.Rb(1,"button",41),I.Zb("click",(function(){I.rc(t);const e=I.dc(4).$implicit;return I.dc(3).pushStack(e)})),I.Mb(2,"i",42),I.Ec(3," Push your changes"),I.Qb(),I.Qb()}2&t&&(I.Ab(1),I.jc("title","Push Your Changes"))}function Y(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",4),I.Rb(1,"button",41),I.Zb("click",(function(){I.rc(t);const e=I.dc(4).$implicit;return I.dc(3).pullStack(e)})),I.Mb(2,"i",37),I.Ec(3," Pull new updates"),I.Qb(),I.Qb()}2&t&&(I.Ab(1),I.jc("title","Pull New Updates"))}function B(t,e){1&t&&(I.Rb(0,"div",43),I.Ec(1,"Requires merge!"),I.Qb())}function V(t,e){if(1&t&&(I.Rb(0,"div",4),I.Cc(1,X,4,1,"div",28),I.Cc(2,Y,4,1,"div",28),I.Cc(3,B,2,0,"div",40),I.Qb()),2&t){const t=I.dc(3).$implicit;I.Ab(1),I.jc("ngIf",!t.remote.isClean),I.Ab(1),I.jc("ngIf",t.localVersion!=(null==t.remote?null:t.remote.version)),I.Ab(1),I.jc("ngIf",null==t.remote?null:t.remote.requiresMerge)}}function _(t,e){if(1&t&&(I.Pb(0),I.Cc(1,V,4,3,"div",28),I.Ob()),2&t){const t=I.dc(2).$implicit;I.Ab(1),I.jc("ngIf",t.remote)}}function tt(t,e){if(1&t){const t=I.Sb();I.Pb(0),I.Rb(1,"download-remote-stack",44),I.Zb("onFinished",(function(){return I.rc(t),I.dc(5).stackService.refresh()})),I.Qb(),I.Ob()}if(2&t){const t=I.dc(2).$implicit;I.Ab(1),I.jc("stack",t)}}function et(t,e){if(1&t&&(I.Pb(0),I.Cc(1,_,2,1,"ng-container",0),I.Cc(2,tt,2,1,"ng-container",0),I.Ob()),2&t){const t=I.dc().$implicit;I.Ab(1),I.jc("ngIf",!t.remoteOnly),I.Ab(1),I.jc("ngIf",t.remoteOnly)}}function it(t,e){1&t&&(I.Rb(0,"div",58),I.Mb(1,"i",59),I.Ec(2," Shared"),I.Qb())}function ct(t,e){1&t&&(I.Rb(0,"div",60),I.Mb(1,"i",61),I.Ec(2," Local"),I.Qb())}function nt(t,e){if(1&t&&(I.Rb(0,"div",49),I.Mb(1,"i",62),I.Ec(2),I.Qb()),2&t){const t=I.dc(2).$implicit;I.Ab(2),I.Gc(" ",t.seed,"")}}function st(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",4),I.Ec(1),I.Rb(2,"i",65),I.Zb("click",(function(){I.rc(t);const e=I.dc(3).$implicit;return I.dc(3).toggleEdit("description",e.description)})),I.Qb(),I.Qb()}if(2&t){const t=I.dc(3).$implicit;I.Ab(1),I.Gc(" ",t.description||"No description"," ")}}function ot(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div"),I.Rb(1,"input",66),I.Zb("ngModelChange",(function(e){return I.rc(t),I.dc(6).editables.description.value=e})),I.Qb(),I.Rb(2,"button",67),I.Zb("click",(function(){I.rc(t);const e=I.dc(3).$implicit;return I.dc(3).updateDescription(e)})),I.Ec(3,"Save"),I.Qb(),I.Rb(4,"button",8),I.Zb("click",(function(){return I.rc(t),I.dc(6).toggleEdit("description")})),I.Ec(5,"Cancel"),I.Qb(),I.Qb()}if(2&t){const t=I.dc(3).$implicit,e=I.dc(3);I.Ab(1),I.jc("ngModel",e.editables.description.value),I.Ab(1),I.jc("disabled",e.editables.description.value==t.description)}}function at(t,e){1&t&&(I.Rb(0,"span",71),I.Ec(1,"None"),I.Qb())}function rt(t,e){if(1&t){const t=I.Sb();I.Rb(0,"span",72),I.Zb("mouseenter",(function(){I.rc(t);const i=e.$implicit;return I.dc(7).tagHover=i}))("mouseleave",(function(){return I.rc(t),I.dc(7).tagHover=null}))("click",(function(){I.rc(t);const i=e.$implicit,c=I.dc(4).$implicit;return I.dc(3).removeTag(c,i)})),I.Ec(1),I.ec(2,"titlecase"),I.Qb()}if(2&t){const t=e.$implicit,i=I.dc(7);I.jc("ngClass",i.tagHover==t?"badge-danger":"badge-primary"),I.Ab(1),I.Hc(" ",I.fc(2,3,t)," ",i.tagHover==t?"X":""," ")}}function bt(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",4),I.Cc(1,at,2,0,"span",68),I.Cc(2,rt,3,5,"span",69),I.Rb(3,"span",70),I.Zb("click",(function(){I.rc(t);const e=I.dc(3).$implicit;return I.dc(3).addTag(e)})),I.Mb(4,"i",9),I.Qb(),I.Qb()}if(2&t){const t=I.dc(3).$implicit,e=I.dc(3);I.Ab(1),I.jc("ngIf",0==e.tags[t.id].length),I.Ab(1),I.jc("ngForOf",e.tags[t.id])}}function dt(t,e){if(1&t&&(I.Pb(0),I.Rb(1,"div",46),I.Rb(2,"div",63),I.Ec(3,"Description"),I.Qb(),I.Cc(4,st,3,1,"div",28),I.Cc(5,ot,6,2,"div",0),I.Qb(),I.Rb(6,"div",46),I.Rb(7,"div",63),I.Mb(8,"i",64),I.Ec(9," Tags"),I.Qb(),I.Cc(10,bt,5,2,"div",28),I.Qb(),I.Ob()),2&t){const t=I.dc(2).$implicit,e=I.dc(3);I.Ab(4),I.jc("ngIf",!e.editables.description),I.Ab(1),I.jc("ngIf",e.editables.description),I.Ab(5),I.jc("ngIf",!!e.tags[t.id])}}function lt(t,e){if(1&t){const t=I.Sb();I.Rb(0,"button",54),I.Zb("click",(function(){I.rc(t);const e=I.dc(2).$implicit;return I.dc(3).switchEnvironment(e)})),I.Ec(1,"Switch To This Stack"),I.Qb()}if(2&t){const t=I.dc(2).$implicit,e=I.dc(3);I.jc("disabled",e.isCurrentEnv(t))}}function ut(t,e){if(1&t){const t=I.Sb();I.Rb(0,"button",56),I.Zb("click",(function(){I.rc(t);const e=I.dc(2).$implicit;return I.dc(3).deleteStack(e)})),I.Rb(1,"span"),I.Ec(2,"Delete Stack"),I.Qb(),I.Qb()}}function pt(t,e){if(1&t){const t=I.Sb();I.Rb(0,"button",56),I.Zb("click",(function(){I.rc(t);const e=I.dc(2).$implicit;return I.dc(3).revokeStack(e)})),I.Ec(1,"Purge Stack"),I.Qb()}}function gt(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",45),I.Rb(1,"div",12),I.Rb(2,"div",46),I.Cc(3,it,3,0,"div",47),I.Cc(4,ct,3,0,"div",48),I.Rb(5,"div",49),I.Mb(6,"i",50),I.Ec(7),I.Qb(),I.Cc(8,nt,3,1,"div",51),I.Qb(),I.Mb(9,"mat-divider"),I.Cc(10,dt,11,3,"ng-container",0),I.Qb(),I.Rb(11,"div",52),I.Cc(12,lt,2,1,"button",53),I.Rb(13,"button",54),I.Zb("click",(function(){I.rc(t);const e=I.dc().$implicit;return I.dc(3).installIntoCurrentEnvironment(e)})),I.Ec(14,"Install Into Current "),I.Rb(15,"span",55),I.Ec(16),I.Qb(),I.Qb(),I.Rb(17,"button",56),I.Zb("click",(function(){I.rc(t);const e=I.dc().$implicit;return I.dc(3).installIntoNewWorkspace(e)})),I.Ec(18,"Install Into New Workspace"),I.Qb(),I.Rb(19,"button",56),I.Zb("click",(function(){I.rc(t);const e=I.dc().$implicit;return I.dc(3).shareStack(e)})),I.Ec(20,"Share Stack"),I.Qb(),I.Rb(21,"button",56),I.Zb("click",(function(){I.rc(t);const e=I.dc().$implicit;return I.dc(3).renameStack(e)})),I.Ec(22,"Rename Stack"),I.Qb(),I.Cc(23,ut,3,0,"button",57),I.Cc(24,pt,2,0,"button",57),I.Qb(),I.Qb()}if(2&t){const t=I.dc().$implicit,e=I.dc(3);I.Ab(3),I.jc("ngIf",t.remote),I.Ab(1),I.jc("ngIf",!t.remote&&t.isLocal),I.Ab(3),I.Gc(" ",t.codebasePath,""),I.Ab(1),I.jc("ngIf",t.seed),I.Ab(2),I.jc("ngIf",!(null==t.remote||!t.remote.id)),I.Ab(2),I.jc("ngIf",!t.remoteOnly),I.Ab(1),I.jc("disabled",e.isCurrentEnv(t)),I.Ab(3),I.Fc(e.currentEnvironment.type),I.Ab(7),I.jc("ngIf",!t.remoteOnly),I.Ab(1),I.jc("ngIf",(null==t.remote?null:t.remote.owner)===(null==e.user?null:e.user.uid))}}function ft(t,e){if(1&t){const t=I.Sb();I.Rb(0,"div",12),I.Rb(1,"div",13),I.Rb(2,"div",25),I.Rb(3,"div",26),I.Cc(4,K,3,0,"div",27),I.Cc(5,J,3,1,"div",28),I.Qb(),I.Rb(6,"div",4),I.Mb(7,"i",29),I.Qb(),I.Rb(8,"div",30),I.Zb("click",(function(){I.rc(t);const i=e.$implicit;return I.dc(3).toggleItemList(i)})),I.Ec(9),I.Qb(),I.Rb(10,"div",7),I.Cc(11,et,3,2,"ng-container",0),I.Qb(),I.Rb(12,"div",31),I.Rb(13,"button",32),I.Zb("click",(function(){I.rc(t);const i=e.$implicit;return I.dc(3).toggleItemList(i)})),I.Mb(14,"i",33),I.Qb(),I.Qb(),I.Qb(),I.Cc(15,gt,25,10,"div",34),I.Qb(),I.Qb()}if(2&t){const t=e.$implicit,i=I.dc(3);I.Ab(4),I.jc("ngIf",t.remoteOnly),I.Ab(1),I.jc("ngIf",!t.remoteOnly),I.Ab(2),I.Db("text-primary",i.isCurrentEnv(t))("text-muted",!i.isCurrentEnv(t)),I.Ab(1),I.Db("text-primary",i.isCurrentEnv(t)),I.Ab(1),I.Fc(t.name),I.Ab(2),I.jc("ngIf",i.isLoggedIn),I.Ab(3),I.Db("fa-chevron-up",i.itemList[t.id])("fa-chevron-down",!i.itemList[t.id]),I.Ab(1),I.jc("ngIf",i.itemList[t.id])}}function mt(t,e){if(1&t&&(I.Pb(0),I.Cc(1,z,2,0,"div",23),I.Cc(2,ft,16,15,"div",11),I.Ob()),2&t){const t=I.dc(2);I.Ab(1),I.jc("ngIf",0===t.stacks.length),I.Ab(1),I.jc("ngForOf",t.stacks)}}function vt(t,e){if(1&t){const t=I.Sb();I.Pb(0),I.Rb(1,"div",1),I.Rb(2,"div",2),I.Rb(3,"div",3),I.Rb(4,"div",4),I.Cc(5,U,4,1,"ng-container",0),I.Rb(6,"div",5),I.Rb(7,"div",6),I.Ec(8,"My Stacks"),I.Qb(),I.Rb(9,"div",7),I.Rb(10,"button",8),I.Zb("click",(function(){return I.rc(t),I.dc().createNewStack()})),I.Mb(11,"i",9),I.Ec(12," New Stack"),I.Qb(),I.Qb(),I.Qb(),I.Cc(13,q,8,0,"ng-container",0),I.Cc(14,mt,3,2,"ng-container",0),I.Qb(),I.Qb(),I.Qb(),I.Qb(),I.Ob()}if(2&t){const t=I.dc();I.Ab(5),I.jc("ngIf",t.invites.length>0),I.Ab(8),I.jc("ngIf",!t.isLoggedIn),I.Ab(1),I.jc("ngIf",t.isLoggedIn)}}const ht=n.g.forChild([{path:"",component:(()=>{class t{constructor(t,e,i,c,n,s,o,r){this.appEnvironmentService=t,this.dialog=e,this.userService=i,this.stackService=c,this.dialogService=n,this.appConsoleService=s,this.navigationService=o,this.myItemsService=r,this.invites=[],this.isLoggedIn=!1,this.itemList={},this.editables={},this.tags={},this.tagHover=null,this.subs=new a.a}ngOnInit(){this.getEnvironments(),this.getPendingInvites(),this.subs.add(this.userService.user$.subscribe(t=>{this.user=t,this.isLoggedIn=t.isLoggedIn})),this.subs.add(this.appEnvironmentService.currentEnvironment$.subscribe(t=>{this.currentEnvironment=t}))}toggleItemList(t){this.itemList[t.id]||this.loadTags(t),this.itemList[t.id]=!this.itemList[t.id]}loadTags(t){t.remote&&t.remote.id&&this.stackService.getTags(t.remote.id).pipe(Object(d.a)(1)).subscribe(e=>{this.tags[t.id]=e})}getEnvironments(){this.subs.add(this.stackService.userStacks().subscribe(t=>{this.stacks=t}))}createNewStack(){this.isLoggedIn?this.dialog.open(b.a,{data:{type:o.a.Environment.Type.Stack},minWidth:"600px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(()=>this.stackService.refresh()):this.dialogService.openMustLoginDialog()}ngOnDestroy(){}isCurrentEnv(t){var e;return(null===(e=this.currentEnvironment)||void 0===e?void 0:e.id)===t.id}switchEnvironment(t){this.appEnvironmentService.switchToEnvironment(t.id).pipe(Object(l.a)(()=>this.navigationService.navigateToEnvironmentHome())).subscribe(()=>null)}pushStack(t){this.stackService.publishStack(t.id).subscribe(e=>{var i;this.dialogService.openAlertDialog({title:"Push Successful",text:`${t.name} v${null===(i=e.remote)||void 0===i?void 0:i.version} has been published`})})}pullStack(t){this.stackService.syncStack(t.id,t.remote.version).subscribe(()=>{this.stackService.refresh(),this.dialogService.openAlertDialog({title:"Sync Stack",text:"Stack has been synced"})},t=>{var e;this.dialogService.openAlertDialog({title:"Sync Stack",text:(null===(e=t.error)||void 0===e?void 0:e.message)||"Server error!"})})}deleteStack(t){const e=this.dialogService.openConfirmationDialog({title:`Delete stack ${t.name}?`,text:"Deleting this stack is a permanent action and cannot be undone.",button:{yes:"Delete",no:"Cancel"}});Object(r.a)([e.afterClosed(),this.appEnvironmentService.currentEnvironment$.pipe(Object(d.a)(1))]).subscribe(([e,i])=>{!0===e&&this.stackService.deleteStack(t.id).subscribe(()=>{t.id===i.id&&this.dialog.open(u.a,{data:{},disableClose:!0,position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(t=>console.log("dialog result: ",t)),this.stackService.refresh()})})}revokeStack(t){const e=this.dialog.open(p.a,{data:{title:`Revoke stack ${t.name}?`,text:"Revoking this stack will remove it from the stackjoy community. It will no longer be public and other users will no longer be able to install it. This is a permanent action and cannot be undone.",button:{yes:"Revoke",no:"Cancel"}},position:{top:"100px"},autoFocus:!0});Object(r.a)([e.afterClosed(),this.appEnvironmentService.currentEnvironment$.pipe(Object(d.a)(1))]).subscribe(([e,i])=>{!1!==e&&this.stackService.purge(t.remote.id).subscribe(()=>{this.dialogService.openAlertDialog({title:"Revoke Stack",text:`Stack ${t.name} revoked successfully. `}),this.stackService.refresh()},t=>{this.dialogService.openAlertDialog({title:"Revoke Stack",text:"Something went wrong: "+(t.message||"Unknown error occurred...")})})})}test(){this.stackService.installIntoCurrentEnvironment("UIkhUmgApyOKEKtEridz").subscribe(()=>{this.stackService.refresh()},()=>{})}installIntoCurrentEnvironment(t){this.appConsoleService.openBluConsole({command:"install "+t.name,extraInfo:{stack:t,source:"local"}})}renameStack(t){this.dialog.open(g.a,{data:{environment:t},width:"500px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(t=>{t.success&&this.stackService.refresh()})}shareStack(t){this.user?this.dialog.open(f.a,{data:{environment:t,type:"stack"},width:"50vw",maxWidth:"800px",minWidth:"500px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(()=>{this.stackService.refresh()}):this.dialogService.openMustLoginDialog()}getPendingInvites(){this.subs.add(this.stackService.pendingInvites$.subscribe(t=>{this.invites=t}))}installIntoNewWorkspace(t){this.myItemsService.createNewWorkspace(t)}gotoLogin(){this.navigationService.navigateToLogin()}goToCreateAccount(){this.navigationService.navigateToCreateAccount()}acceptInvite(t){return Object(s.a)(this,void 0,void 0,(function*(){this.stackService.acceptInvite(t).pipe(Object(d.a)(1)).subscribe(()=>{this.stackService.fetchPendingInvites()})}))}declineInvite(t){return Object(s.a)(this,void 0,void 0,(function*(){this.stackService.declineInvite(t).pipe(Object(d.a)(1)).subscribe(()=>{this.stackService.fetchPendingInvites()})}))}toggleEdit(t,e){this.editables[t]?delete this.editables[t]:this.editables[t]={dirty:!1,value:e}}updateDescription(t){this.stackService.updateDescription(t.remote.id,this.editables.description.value).pipe(Object(d.a)(1)).subscribe(()=>{t.description=this.editables.description.value,this.toggleEdit("description")})}addTag(t){this.dialog.open(w,{data:{stack:t,tags:this.tags[t.id]},width:"50vw",maxWidth:"800px",minWidth:"500px",position:{top:"100px"},autoFocus:!0}).afterClosed().subscribe(()=>{this.loadTags(t)})}removeTag(t,e){var i;this.stackService.removeTag(null===(i=t.remote)||void 0===i?void 0:i.id,e).pipe(Object(d.a)(1)).subscribe(()=>{this.tags[t.id]=this.tags[t.id].filter(t=>t!==e)})}}return t.\u0275fac=function(e){return new(e||t)(I.Lb(A.a),I.Lb(m.b),I.Lb(y.a),I.Lb(R.a),I.Lb(j.a),I.Lb(T.a),I.Lb(O.a),I.Lb($.a))},t.\u0275cmp=I.Fb({type:t,selectors:[["my-stacks"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"basic-page","flex-column"],[1,"pt-3",2,"max-width","800px"],[1,"pl-3"],[1,""],[1,"pl-2","d-flex","align-items-start"],[1,"text-bold","py-2"],[1,"ml-auto"],["mat-button","",3,"click"],[1,"fa","fa-plus"],[1,"text-bold","p-2"],["class","p-2",4,"ngFor","ngForOf"],[1,"p-2"],[1,"shadow","p-2","border","rounded"],[1,"d-flex","align-items-center","justify-content-between"],[1,"pl-3","cursor-pointer"],[1,"subheader"],["mat-raised-button","",3,"click"],[1,"p-2","text-center","cursor-pointer"],[1,"",3,"click"],[1,"fa","fa-exclamation-circle"],[1,"fa","fa-arrow-alt-circle-right"],[1,"text-small","text-muted","hover-as-link","pt-2",3,"click"],["class","text-center p-2",4,"ngIf"],[1,"text-center","p-2"],[1,"d-flex","align-items-center"],[1,"pr-3"],["class","","style","width:40px; height:40px;",4,"ngIf"],["class","",4,"ngIf"],[1,"fa","fa-layer-group"],[1,"pl-2","cursor-pointer",3,"click"],[1,"ml-1"],["mat-button","","mat-icon-button","",3,"click"],[1,"fa"],["class","border-top p-2 d-flex align-items-start",4,"ngIf"],[1,"",2,"width","40px","height","40px"],["mat-button","","mat-icon-button",""],[1,"fa","fa-download","text-muted"],["mat-button","","mat-icon-button","",3,"disabled","click"],[1,"fa","fa-exchange-alt"],["style","color: red",4,"ngIf"],["mat-button","",3,"title","click"],[1,"fa","fa-upload","text-muted"],[2,"color","red"],[3,"stack","onFinished"],[1,"border-top","p-2","d-flex","align-items-start"],[1,"my-2"],["class","text-muted text-small","matTooltip","This stack is shared with other users",4,"ngIf"],["class","text-muted text-small","matTooltip","This stack is present only on this machine",4,"ngIf"],[1,"text-small"],[1,"fa","fa-folder-open","mr-1"],["class","text-small",4,"ngIf"],[1,"ml-auto","p-2","border-left"],["mat-button","","class","d-block",3,"disabled","click",4,"ngIf"],["mat-button","",1,"d-block",3,"disabled","click"],[1,"text-capitalize"],["mat-button","",1,"d-block",3,"click"],["mat-button","","class","d-block",3,"click",4,"ngIf"],["matTooltip","This stack is shared with other users",1,"text-muted","text-small"],[1,"fa","fa-users","mr-1"],["matTooltip","This stack is present only on this machine",1,"text-muted","text-small"],[1,"fa","fa-desktop","mr-1"],[1,"fa","fa-seedling","mr-1"],[1,"text-tiny"],[1,"fa","fa-tags"],[1,"fa","fa-pencil-alt",3,"click"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["mat-button","","color","primary",3,"disabled","click"],["class","ml-2",4,"ngIf"],["class","ml-2 badge",3,"ngClass","mouseenter","mouseleave","click",4,"ngFor","ngForOf"],[1,"ml-2","badge","badge-secondary",3,"click"],[1,"ml-2"],[1,"ml-2","badge",3,"ngClass","mouseenter","mouseleave","click"]],template:function(t,e){1&t&&I.Cc(0,vt,15,3,"ng-container",0),2&t&&I.jc("ngIf",e.stacks)},directives:[c.t,C.b,c.s,P,N.a,G.a,W.c,W.r,W.u,c.q],pipes:[c.F],styles:[".codebase-path[_ngcontent-%COMP%]{font-size:9px;line-height:9px}[_nghost-%COMP%]{display:flex;flex:1}"]}),t})(),children:[]}]);var kt=i("STbY"),St=i("NFeN");let It=(()=>{class t{}return t.\u0275mod=I.Jb({type:t}),t.\u0275inj=I.Ib({factory:function(e){return new(e||t)},providers:[],imports:[[c.c,C.c,F.b]]}),t})();var Rt=i("7n/8"),Qt=i("QibW"),Et=i("d3UM");let Ct=(()=>{class t{}return t.\u0275mod=I.Jb({type:t}),t.\u0275inj=I.Ib({factory:function(e){return new(e||t)},providers:[],imports:[[c.c,m.g,E.b,W.m,C.c,Qt.c,W.B,Et.b,F.b]]}),t})(),xt=(()=>{class t{}return t.\u0275mod=I.Jb({type:t}),t.\u0275inj=I.Ib({factory:function(e){return new(e||t)},providers:[],imports:[[c.c,ht,C.c,kt.c,St.b,It,Rt.a,G.b,Ct,W.m,E.b,N.b]]}),t})()}}]);